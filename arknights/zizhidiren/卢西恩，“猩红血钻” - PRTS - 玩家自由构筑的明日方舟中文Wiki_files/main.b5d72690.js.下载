var Lt=Object.defineProperty,Vt=Object.defineProperties;var kt=Object.getOwnPropertyDescriptors;var Et=Object.getOwnPropertySymbols;var Dt=Object.prototype.hasOwnProperty,Bt=Object.prototype.propertyIsEnumerable;var Ct=(l,e,M)=>e in l?Lt(l,e,{enumerable:!0,configurable:!0,writable:!0,value:M}):l[e]=M,ht=(l,e)=>{for(var M in e||(e={}))Dt.call(e,M)&&Ct(l,M,e[M]);if(Et)for(var M of Et(e))Bt.call(e,M)&&Ct(l,M,e[M]);return l},ft=(l,e)=>Vt(l,kt(e));import{r as Z,h as Nt,R as j,c as Ut,m as Tt,l as Ot,S as _t,C as Rt,a as vt,F as Mt,I as mt,b as pt,M as At,G as St,d as xt,e as Xt,f as Yt,W as Wt,T as jt,B as Gt,g as qt,i as ct,j as Ht,k as dt,n as zt,o as Qt,p as Zt,q as Jt,s as Kt,t as gt,u as wt,L as $t,D as bt,v as te,w as ee,x as re,y as ne,z as ae,A as It,E as ut,H as ie,J as se,K as oe,N as he,O as ue,P as le}from"./vendor.935c5766.js";const fe="zhCN",ce="\u989C\u8272",de="\u900F\u660E",ve="invalide";var Me={language:fe,color:ce,"Wrong format":"\u9519\u8BEF\u683C\u5F0F","Not an hex value":"\u4E0D\u662F\u4E00\u4E2A\u5341\u516D\u8FDB\u5236\u6570",Set:"\u786E\u5B9A",transparent:de,none:ve};function Pt(){}Pt.prototype={data:null,scale:1,json:{},nextNum:0,chars:null,readByte:function(){return this.nextNum<this.data.length?this.data[this.nextNum++]:null},readBoolean:function(){return this.readByte()!=0},readShort:function(){return this.readByte()<<8|this.readByte()},readInt:function(l){if(typeof l=="undefined")return this.readByte()<<24|this.readByte()<<16|this.readByte()<<8|this.readByte();let e=this.readByte(),M=e&127;return(e&128)!=0&&(e=this.readByte(),M|=(e&127)<<7,(e&128)!=0&&(e=this.readByte(),M|=(e&127)<<14,(e&128)!=0&&(e=this.readByte(),M|=(e&127)<<21,(e&128)!=0&&(e=this.readByte(),M|=(e&127)<<28)))),l?M:M>>1^-(M&1)},bytes2Float32:function(l){let e=l&2147483648?-1:1,M=(l>>23&255)-127,i=l&~(-1<<23);if(M==128)return e*(i?Number.NaN:Number.POSITIVE_INFINITY);if(M==-127){if(i==0)return e*0;M=-126,i/=1<<22}else i=(i|1<<23)/(1<<23);return e*i*Math.pow(2,M)},readFloat:function(){return this.bytes2Float32((this.readByte()<<24)+(this.readByte()<<16)+(this.readByte()<<8)+(this.readByte()<<0))},readVertices:function(l){let e=l<<1;if(!this.readBoolean())return this.readFloatArray(e,this.scale);let M=new Array;for(let i=0;i<l;i++){let t=this.readInt(!![]);M.push(t);for(let n=0;n<t;n++)M.push(this.readInt(!![])),M.push(this.readFloat()*this.scale),M.push(this.readFloat()*this.scale),M.push(this.readFloat())}return M},readFloatArray:function(l,e){let M=new Array(l);if(e==1)for(let i=0;i<l;i++)M[i]=this.readFloat();else for(let i=0;i<l;i++)M[i]=this.readFloat()*e;return M},readShortArray:function(){let l=this.readInt(!![]),e=new Array(l);for(let M=0;M<l;M++)e[M]=this.readShort();return e},readIntArray:function(){let l=this.readInt(!![]),e=new Array(l);for(let M=0;M<l;M++)e[M]=this.readInt(!![]);return e},readHex:function(){let l=this.readByte().toString(16);return l.length==2?l:"0"+l},readColor:function(){return this.readHex()+this.readHex()+this.readHex()+this.readHex()},readString:function(){let l=this.readInt(this,!![]);switch(l){case 0:return null;case 1:return""}l--,this.chars="";let e=0;for(let M=0;M<l;)switch(e=this.readByte(),e>>4){case 12:case 13:this.chars+=String.fromCharCode((e&31)<<6|this.readByte()&63),M+=2;break;case 14:this.chars+=String.fromCharCode((e&15)<<12|(this.readByte()&63)<<6|this.readByte()&63),M+=3;break;default:this.chars+=String.fromCharCode(e),M++}return this.chars},initJson:function(){this.json.skeleton={};let l=this.json.skeleton;l.hash=this.readString(),l.hash.length==0&&(l.hash=null),l.spine=this.readString(),l.spine.length==0&&(l.spine=null),l.width=this.readFloat(),l.height=this.readFloat();let e=this.readBoolean();e&&(l.fps=this.readFloat(),l.images=this.readString(),l.images.length==0&&(l.images=null)),this.json.bones=new Array(this.readInt(!![]));let M=this.json.bones;for(let s=0;s<M.length;s++){let o={};if(o.name=this.readString(),o.parent=null,s!=0){const u=this.readInt(!![]);o.parent=M[u].name}o.rotation=this.readFloat(),o.x=this.readFloat()*this.scale,o.y=this.readFloat()*this.scale,o.scaleX=this.readFloat(),o.scaleY=this.readFloat(),o.shearX=this.readFloat(),o.shearY=this.readFloat(),o.length=this.readFloat()*this.scale,o.transform=Ae[this.readInt(!![])],e&&(o.color=this.readColor()),M[s]=o}this.json.slots=new Array(this.readInt(!![]));let i=this.json.slots;for(let s=0;s<i.length;s++){let o={};o.name=this.readString();const u=this.json.bones[this.readInt(!![])];o.bone=u.name,o.color=this.readColor(),o.attachment=this.readString(),o.blend=me[this.readInt(!![])],i[s]=o}this.json.ik=new Array(this.readInt(!![]));let t=this.json.ik;for(let s=0;s<t.length;s++){let o={};o.name=this.readString(),o.order=this.readInt(!![]),o.bones=new Array(this.readInt(!![]));for(let u=0;u<o.bones.length;u++)o.bones[u]=this.json.bones[this.readInt(!![])].name;o.target=this.json.bones[this.readInt(!![])].name,o.mix=this.readFloat(),o.bendPositive=this.readByte()!=255,t[s]=o}this.json.transform=new Array(this.readInt(!![]));let n=this.json.transform;for(let s=0;s<n.length;s++){let o={};o.name=this.readString(),o.order=this.readInt(!![]);const u=new Array(this.readInt(!![]));for(let p=0,v=u.length;p<v;p++)u[p]=this.json.bones[this.readInt(!![])].name;o.bones=u,o.target=this.json.bones[this.readInt(!![])].name,o.rotation=this.readFloat(),o.x=this.readFloat()*this.scale,o.y=this.readFloat()*this.scale,o.scaleX=this.readFloat(),o.scaleY=this.readFloat(),o.shearY=this.readFloat(),o.rotateMix=this.readFloat(),o.translateMix=this.readFloat(),o.scaleMix=this.readFloat(),o.shearMix=this.readFloat(),n[s]=o}this.json.path=new Array(this.readInt(!![]));let r=this.json.path;for(let s=0;s<r.length;s++){let o={};o.name=this.readString(),o.order=this.readInt(!![]),o.bones=new Array(this.readInt(!![]));for(let u=0,p=o.bones.length;u<p;u++)o.bones[u]=this.json.bones[this.readInt(!![])].name;o.target=this.json.slots[this.readInt(!![])].name,o.positionMode=xe[this.readInt(!![])],o.spacingMode=ye[this.readInt(!![])],o.rotateMode=Ee[this.readInt(!![])],o.rotation=this.readFloat(),o.position=this.readFloat(),o.positionMode=="fixed"&&(o.position*=this.scale),o.spacing=this.readFloat(),(o.spacingMode=="length"||o.spacingMode=="fixed")&&(o.spacing*=this.scale),o.rotateMix=this.readFloat(),o.translateMix=this.readFloat(),r[s]=o}this.json.skins={},this.json.skinsName=new Array;let a=this.json.skins,f=this.readSkin("default",e);f!=null&&(a.default=f,this.json.skinsName.push("default"));for(let s=0,o=this.readInt(!![]);s<o;s++){let u=this.readString(),p=this.readSkin(u,e);a[u]=p,this.json.skinsName.push(u)}this.json.events=[],this.json.eventsName=[];let c=this.json.events;for(let s=0,o=this.readInt(!![]);s<o;s++){let u=this.readString(),p={};p.int=this.readInt(![]),p.float=this.readFloat(),p.string=this.readString(),c[u]=p,this.json.eventsName[s]=u}this.json.animations={};let h=this.json.animations;for(let s=0,o=this.readInt(!![]);s<o;s++){let u=this.readString(),p=this.readAnimation(u);h[u]=p}},readSkin(l,e){let M=this.readInt(!![]);if(M==0)return null;let i={};for(let t=0;t<M;t++){const n=this.readInt(!![]),r={};for(let a=0,f=this.readInt(!![]);a<f;a++){let c=this.readString(),h=this.readAttachment(c,e);h!=null&&(r[c]=h)}i[this.json.slots[n].name]=r}return i},readAttachment(l,e){let M=this.scale,i=this.readString();i==null&&(i=l);let t,n,r={},a={},f={},c={},h,s={},o={};switch(pe[this.readByte()]){case"region":return t=this.readString(),t==null&&(t=i),r.type="region",r.name=i,r.path=t.trim(),r.rotation=this.readFloat(),r.x=this.readFloat()*M,r.y=this.readFloat()*M,r.scaleX=this.readFloat(),r.scaleY=this.readFloat(),r.width=this.readFloat()*M,r.height=this.readFloat()*M,r.color=this.readColor(),r;case"boundingbox":return a.type="boundingbox",a.name=i,n=this.readInt(!![]),a.vertexCount=n,a.vertices=this.readVertices(n),this.nonessential&&(a.color=this.readColor()),a;case"mesh":return t=this.readString(),t==null&&(t=i),f.type="mesh",f.name=i,f.path=t,f.color=this.readColor(),n=this.readInt(!![]),f.uvs=this.readFloatArray(n<<1,1),f.triangles=this.readShortArray(),f.vertices=this.readVertices(n),f.hull=this.readInt(!![])<<1,e&&(f.edges=this.readShortArray(),f.width=this.readFloat()*M,f.height=this.readFloat()*M),f;case"linkedmesh":return t=this.readString(),t==null&&(t=i),c.type="linkedmesh",c.name=i,c.path=t,c.color=this.readColor(),c.skin=this.readString(),c.parent=this.readString(),c.deform=this.readBoolean(),e&&(c.width=this.readFloat()*M,c.height=this.readFloat()*M),c;case"path":t={},t.type="path",t.name=i,t.closed=this.readBoolean(),t.constantSpeed=this.readBoolean(),n=this.readInt(!![]),t.vertexCount=n,t.vertices=this.readVertices(n),h=h=new Array(n/3);for(let u=0;u<h.length;u++)h[u]=this.readFloat()*M;return t.lengths=h,e&&(t.color=this.readColor()),t;case"point":return s.type="point",s.name=i,s.rotation=this.readFloat(),s.x=this.readFloat()*M,s.y=this.readFloat()*M,e&&(t.color=this.readColor()),s;case"clipping":return o.type="clipping",o.name=i,o.end=this.readInt(!![]),n=this.readInt(!![]),o.vertexCount=n,o.vertices=this.readVertices(n),e&&(o.color=this.readColor()),o}return null},readCurve(l,e){let M,i,t,n;switch(this.readByte()){case 0:e[l].curve="linear";break;case 1:e[l].curve="stepped";break;case 2:M=this.readFloat(),i=this.readFloat(),t=this.readFloat(),n=this.readFloat(),e[l].curve=[M,i,t,n]}},readAnimation(l){let e={},M=this.scale,i=0,t={};for(let o=0,u=this.readInt(!![]);o<u;o++){let p=this.readInt(!![]),v={},y=this.readInt(!![]);for(let E=0;E<y;E++){let S=this.readByte(),V=this.readInt(!![]),F;switch(S){case 0:F=new Array(V);for(let m=0;m<V;m++){let d=this.readFloat(),x=this.readString();F[m]={},F[m].time=d,F[m].name=x}v.attachment=F,i=Math.max(i,F[V-1].time);break;case 1:F=new Array(V);for(let m=0;m<V;m++){const d=this.readFloat(),x=this.readColor();F[m]={},F[m].time=d,F[m].color=x,m<V-1&&this.readCurve(m,F)}v.color=F,i=Math.max(i,F[V-1].time);break;case 2:F=new Array(V);for(let m=0;m<V;m++){const d=this.readFloat();let x=this.readColor(),I=this.readColor();F[m]={},F[m].time=d,F[m].light=x,F[m].dark=I,m<V-1&&this.readCurve(m,F)}v.twoColor=F,i=Math.max(i,F[V-1].time);break}}t[this.json.slots[p].name]=v}e.slots=t;let n={};for(let o=0,u=this.readInt(!![]);o<u;o++){let p=this.readInt(!![]),v={};for(let y=0,E=this.readInt(!![]);y<E;y++){const S=this.readByte(),V=this.readInt(!![]);let F,m=1;switch(S){case 0:F=new Array(V);for(let d=0;d<V;d++){const x=this.readFloat(),I=this.readFloat();F[d]={},F[d].time=x,F[d].angle=I,d<V-1&&this.readCurve(d,F)}v.rotate=F,i=Math.max(i,F[V-1].time);break;case 1:case 2:case 3:F=new Array(V),S==1&&(m=M);for(let d=0;d<V;d++){let x=this.readFloat(),I=this.readFloat(),g=this.readFloat();F[d]={},F[d].time=x,F[d].x=I*m,F[d].y=g*m,d<V-1&&this.readCurve(d,F)}S==1?v.translate=F:S==2?v.scale=F:v.shear=F,i=Math.max(i,F[V-1].time);break}}n[this.json.bones[p].name]=v}e.bones=n;let r={};for(let o=0,u=this.readInt(!![]);o<u;o++){const p=this.readInt(!![]),v=this.readInt(!![]),y=new Array(v);for(let E=0;E<v;E++){const S=this.readFloat(),V=this.readFloat(),F=this.readByte()!=255;y[E]={},y[E].time=S,y[E].mix=V,y[E].bendPositive=F,E<v-1&&this.readCurve(E,y)}r[this.json.ik[p].name]=y,i=Math.max(i,y[v-1].time)}e.ik=r;let a={};for(let o=0,u=this.readInt(!![]);o<u;o++){const p=this.readInt(!![]),v=this.readInt(!![]),y=new Array(v);for(let E=0;E<v;E++)y[E]={},y[E].time=this.readFloat(),y[E].rotateMix=this.readFloat(),y[E].translateMix=this.readFloat(),y[E].scaleMix=this.readFloat(),y[E].shearMix=this.readFloat(),E<v-1&&this.readCurve(E,y);a[this.json.transform[p].name]=y,i=Math.max(i,y[v-1].time)}e.transform=a;let f={};for(let o=0,u=this.readInt(!![]);o<u;o++){let p=this.readInt(!![]),v=this.json.path[p],y={};for(let E=0,S=this.readInt(!![]);E<S;E++){const V=this.readByte(),F=this.readInt(!![]);let m,d,x;switch(V){case 0:case 1:m=new Array(F),x=1,V==1?(v.spacingMode=="length"||v.spacingMode=="fixed")&&(x=this.scale):v.positionMode=="fixed"&&(x=this.scale);for(let I=0;I<F;I++){d=this.readFloat();let g=this.readFloat();m[I]={},m[I].time=d,V==0?m[I].position=g*x:m[I].spacing=g*x,I<F-1&&this.readCurve(I,m)}V==0?y.position=m:y.spacing=m,i=Math.max(i,m[F-1].time);break;case 2:m=new Array(F);for(let I=0;I<F;I++){d=this.readFloat();let g=this.readFloat(),D=this.readFloat();m[I]={},m[I].time=d,m[I].rotateMix=g,m[I].translateMix=D,I<F-1&&this.readCurve(I,m)}y.mix=m,i=Math.max(i,m[F-1].time);break}}f[this.json.path[p].name]=y}e.paths=f;let c={};for(let o=0,u=this.readInt(!![]);o<u;o++){let p=this.readInt(!![]),v=this.json.skinsName[p],y={};for(let E=0,S=this.readInt(!![]);E<S;E++){const V=this.readInt(!![]),F=this.json.slots[V],m={};for(let d=0,x=this.readInt(!![]);d<x;d++){const I=this.readString(),g=this.readInt(!![]),D=new Array(g);for(let T=0;T<g;T++){const R=this.readFloat(),k=this.readInt(!![]);if(D[T]={},D[T].time=R,k!=0){let C=new Array(k),A=this.readInt(!![]);if(this.scale==1)for(let L=0;L<k;L++)C[L]=this.readFloat();else for(let L=0;L<k;L++)C[L]=this.readFloat()*this.scale;D[T].offset=A,D[T].vertices=C}T<g-1&&this.readCurve(T,D)}m[I]=D,i=Math.max(i,D[g-1].time)}y[F.name]=m}c[v]=y}e.deform=c;let h=this.readInt(!![]);if(h>0){let o=new Array(h);for(let u=0;u<h;u++){const p={},v=this.readFloat(),y=this.readInt(!![]),E=new Array(y);for(let S=0;S<y;S++){const V={},F=this.readInt(!![]);V.slot=this.json.slots[F].name;let m=this.readInt(!![]);V.offset=m,E[S]=V}p.offsets=E,p.time=v,o[u]=p}i=Math.max(i,o[h-1].time),e.drawOrder=o}let s=this.readInt(!![]);if(s>0){let o=new Array(s);for(let u=0;u<s;u++){const p=this.readFloat(),v=this.json.eventsName[this.readInt(!![])],y=this.json.events[v],E={};E.name=v,E.int=this.readInt(![]),E.float=this.readFloat(),E.string=this.readBoolean()?this.readString():y.string,E.time=p,o[u]=E}i=Math.max(i,o[s-1].time),e.events=o}return e}};var me=["normal","additive","multiply","screen"],pe=["region","boundingbox","mesh","linkedmesh","path","point","clipping"],Ae=["normal","onlyTranslation","noRotationOrReflection","noScale","noScaleOrReflection"],xe=["fixed","percent"],ye=["length","fixed","percent"],Ee=["tangent","chain","chainScale"];const Ce=l=>{const e=new Pt;return e.data=l,e.initJson(),e.json};function Te(l){return new Promise((e,M)=>{const i=new XMLHttpRequest;i.open("GET",l,!0),i.responseType="arraybuffer",i.onloadend=()=>{i.status>=200&&i.status<300?e(Ce(new Uint8Array(i.response))):M(i.status)},i.send()})}function at(){return!!window.navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)}function Re(){return window.navigator.userAgent.indexOf("Firefox")!==-1}function Se(l,e){const M=URL.createObjectURL(l),i=window.document.createElement("a");i.href=M,i.download=e+".webm",i.click()}var $=globalThis&&globalThis.__extends||function(l,e){for(var M in e)e.hasOwnProperty(M)&&(l[M]=e[M]);function i(){this.constructor=l}l.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)},N;(function(l){var e=function(){function m(d,x,I){if(d==null)throw new Error("name cannot be null.");if(x==null)throw new Error("timelines cannot be null.");this.name=d,this.timelines=x,this.duration=I}return m.prototype.apply=function(d,x,I,g,D,T,R,k){if(d==null)throw new Error("skeleton cannot be null.");g&&this.duration!=0&&(I%=this.duration,x>0&&(x%=this.duration));for(var C=this.timelines,A=0,L=C.length;A<L;A++)C[A].apply(d,x,I,D,T,R,k)},m.binarySearch=function(d,x,I){I===void 0&&(I=1);var g=0,D=d.length/I-2;if(D==0)return I;for(var T=D>>>1;;){if(d[(T+1)*I]<=x?g=T+1:D=T,g==D)return(g+1)*I;T=g+D>>>1}},m.linearSearch=function(d,x,I){for(var g=0,D=d.length-I;g<=D;g+=I)if(d[g]>x)return g;return-1},m}();l.Animation=e,function(m){m[m.setup=0]="setup",m[m.current=1]="current",m[m.currentLayered=2]="currentLayered"}(l.MixPose||(l.MixPose={}));var M=l.MixPose;(function(m){m[m.in=0]="in",m[m.out=1]="out"})(l.MixDirection||(l.MixDirection={}));var i=l.MixDirection;(function(m){m[m.rotate=0]="rotate",m[m.translate=1]="translate",m[m.scale=2]="scale",m[m.shear=3]="shear",m[m.attachment=4]="attachment",m[m.color=5]="color",m[m.deform=6]="deform",m[m.event=7]="event",m[m.drawOrder=8]="drawOrder",m[m.ikConstraint=9]="ikConstraint",m[m.transformConstraint=10]="transformConstraint",m[m.pathConstraintPosition=11]="pathConstraintPosition",m[m.pathConstraintSpacing=12]="pathConstraintSpacing",m[m.pathConstraintMix=13]="pathConstraintMix",m[m.twoColor=14]="twoColor"})(l.TimelineType||(l.TimelineType={}));var t=l.TimelineType,n=function(){function m(d){if(d<=0)throw new Error("frameCount must be > 0: "+d);this.curves=l.Utils.newFloatArray((d-1)*m.BEZIER_SIZE)}return m.prototype.getFrameCount=function(){return this.curves.length/m.BEZIER_SIZE+1},m.prototype.setLinear=function(d){this.curves[d*m.BEZIER_SIZE]=m.LINEAR},m.prototype.setStepped=function(d){this.curves[d*m.BEZIER_SIZE]=m.STEPPED},m.prototype.getCurveType=function(d){var x=d*m.BEZIER_SIZE;if(x==this.curves.length)return m.LINEAR;var I=this.curves[x];return I==m.LINEAR?m.LINEAR:I==m.STEPPED?m.STEPPED:m.BEZIER},m.prototype.setCurve=function(d,x,I,g,D){var T=(-x*2+g)*.03,R=(-I*2+D)*.03,k=((x-g)*3+1)*.006,C=((I-D)*3+1)*.006,A=T*2+k,L=R*2+C,P=x*.3+T+k*.16666667,B=I*.3+R+C*.16666667,_=d*m.BEZIER_SIZE,W=this.curves;W[_++]=m.BEZIER;for(var U=P,Y=B,G=_+m.BEZIER_SIZE-1;_<G;_+=2)W[_]=U,W[_+1]=Y,P+=A,B+=L,A+=k,L+=C,U+=P,Y+=B},m.prototype.getCurvePercent=function(d,x){x=l.MathUtils.clamp(x,0,1);var I=this.curves,g=d*m.BEZIER_SIZE,D=I[g];if(D==m.LINEAR)return x;if(D==m.STEPPED)return 0;g++;for(var T=0,R=g,k=g+m.BEZIER_SIZE-1;g<k;g+=2)if(T=I[g],T>=x){var C=void 0,A=void 0;return g==R?(C=0,A=0):(C=I[g-2],A=I[g-1]),A+(I[g+1]-A)*(x-C)/(T-C)}var L=I[g-1];return L+(1-L)*(x-T)/(1-T)},m.LINEAR=0,m.STEPPED=1,m.BEZIER=2,m.BEZIER_SIZE=10*2-1,m}();l.CurveTimeline=n;var r=function(m){$(d,m);function d(x){m.call(this,x),this.frames=l.Utils.newFloatArray(x<<1)}return d.prototype.getPropertyId=function(){return(t.rotate<<24)+this.boneIndex},d.prototype.setFrame=function(x,I,g){x<<=1,this.frames[x]=I,this.frames[x+d.ROTATION]=g},d.prototype.apply=function(x,I,g,D,T,R,k){var C=this.frames,A=x.bones[this.boneIndex];if(g<C[0]){switch(R){case M.setup:A.rotation=A.data.rotation;return;case M.current:var L=A.data.rotation-A.rotation;L-=(16384-(16384.499999999996-L/360|0))*360,A.rotation+=L*T}return}if(g>=C[C.length-d.ENTRIES]){if(R==M.setup)A.rotation=A.data.rotation+C[C.length+d.PREV_ROTATION]*T;else{var P=A.data.rotation+C[C.length+d.PREV_ROTATION]-A.rotation;P-=(16384-(16384.499999999996-P/360|0))*360,A.rotation+=P*T}return}var B=e.binarySearch(C,g,d.ENTRIES),_=C[B+d.PREV_ROTATION],W=C[B],U=this.getCurvePercent((B>>1)-1,1-(g-W)/(C[B+d.PREV_TIME]-W)),Y=C[B+d.ROTATION]-_;Y-=(16384-(16384.499999999996-Y/360|0))*360,Y=_+Y*U,R==M.setup?(Y-=(16384-(16384.499999999996-Y/360|0))*360,A.rotation=A.data.rotation+Y*T):(Y=A.data.rotation+Y-A.rotation,Y-=(16384-(16384.499999999996-Y/360|0))*360,A.rotation+=Y*T)},d.ENTRIES=2,d.PREV_TIME=-2,d.PREV_ROTATION=-1,d.ROTATION=1,d}(n);l.RotateTimeline=r;var a=function(m){$(d,m);function d(x){m.call(this,x),this.frames=l.Utils.newFloatArray(x*d.ENTRIES)}return d.prototype.getPropertyId=function(){return(t.translate<<24)+this.boneIndex},d.prototype.setFrame=function(x,I,g,D){x*=d.ENTRIES,this.frames[x]=I,this.frames[x+d.X]=g,this.frames[x+d.Y]=D},d.prototype.apply=function(x,I,g,D,T,R,k){var C=this.frames,A=x.bones[this.boneIndex];if(g<C[0]){switch(R){case M.setup:A.x=A.data.x,A.y=A.data.y;return;case M.current:A.x+=(A.data.x-A.x)*T,A.y+=(A.data.y-A.y)*T}return}var L=0,P=0;if(g>=C[C.length-d.ENTRIES])L=C[C.length+d.PREV_X],P=C[C.length+d.PREV_Y];else{var B=e.binarySearch(C,g,d.ENTRIES);L=C[B+d.PREV_X],P=C[B+d.PREV_Y];var _=C[B],W=this.getCurvePercent(B/d.ENTRIES-1,1-(g-_)/(C[B+d.PREV_TIME]-_));L+=(C[B+d.X]-L)*W,P+=(C[B+d.Y]-P)*W}R==M.setup?(A.x=A.data.x+L*T,A.y=A.data.y+P*T):(A.x+=(A.data.x+L-A.x)*T,A.y+=(A.data.y+P-A.y)*T)},d.ENTRIES=3,d.PREV_TIME=-3,d.PREV_X=-2,d.PREV_Y=-1,d.X=1,d.Y=2,d}(n);l.TranslateTimeline=a;var f=function(m){$(d,m);function d(x){m.call(this,x)}return d.prototype.getPropertyId=function(){return(t.scale<<24)+this.boneIndex},d.prototype.apply=function(x,I,g,D,T,R,k){var C=this.frames,A=x.bones[this.boneIndex];if(g<C[0]){switch(R){case M.setup:A.scaleX=A.data.scaleX,A.scaleY=A.data.scaleY;return;case M.current:A.scaleX+=(A.data.scaleX-A.scaleX)*T,A.scaleY+=(A.data.scaleY-A.scaleY)*T}return}var L=0,P=0;if(g>=C[C.length-d.ENTRIES])L=C[C.length+d.PREV_X]*A.data.scaleX,P=C[C.length+d.PREV_Y]*A.data.scaleY;else{var B=e.binarySearch(C,g,d.ENTRIES);L=C[B+d.PREV_X],P=C[B+d.PREV_Y];var _=C[B],W=this.getCurvePercent(B/d.ENTRIES-1,1-(g-_)/(C[B+d.PREV_TIME]-_));L=(L+(C[B+d.X]-L)*W)*A.data.scaleX,P=(P+(C[B+d.Y]-P)*W)*A.data.scaleY}if(T==1)A.scaleX=L,A.scaleY=P;else{var U=0,Y=0;R==M.setup?(U=A.data.scaleX,Y=A.data.scaleY):(U=A.scaleX,Y=A.scaleY),k==i.out?(L=Math.abs(L)*l.MathUtils.signum(U),P=Math.abs(P)*l.MathUtils.signum(Y)):(U=Math.abs(U)*l.MathUtils.signum(L),Y=Math.abs(Y)*l.MathUtils.signum(P)),A.scaleX=U+(L-U)*T,A.scaleY=Y+(P-Y)*T}},d}(a);l.ScaleTimeline=f;var c=function(m){$(d,m);function d(x){m.call(this,x)}return d.prototype.getPropertyId=function(){return(t.shear<<24)+this.boneIndex},d.prototype.apply=function(x,I,g,D,T,R,k){var C=this.frames,A=x.bones[this.boneIndex];if(g<C[0]){switch(R){case M.setup:A.shearX=A.data.shearX,A.shearY=A.data.shearY;return;case M.current:A.shearX+=(A.data.shearX-A.shearX)*T,A.shearY+=(A.data.shearY-A.shearY)*T}return}var L=0,P=0;if(g>=C[C.length-d.ENTRIES])L=C[C.length+d.PREV_X],P=C[C.length+d.PREV_Y];else{var B=e.binarySearch(C,g,d.ENTRIES);L=C[B+d.PREV_X],P=C[B+d.PREV_Y];var _=C[B],W=this.getCurvePercent(B/d.ENTRIES-1,1-(g-_)/(C[B+d.PREV_TIME]-_));L=L+(C[B+d.X]-L)*W,P=P+(C[B+d.Y]-P)*W}R==M.setup?(A.shearX=A.data.shearX+L*T,A.shearY=A.data.shearY+P*T):(A.shearX+=(A.data.shearX+L-A.shearX)*T,A.shearY+=(A.data.shearY+P-A.shearY)*T)},d}(a);l.ShearTimeline=c;var h=function(m){$(d,m);function d(x){m.call(this,x),this.frames=l.Utils.newFloatArray(x*d.ENTRIES)}return d.prototype.getPropertyId=function(){return(t.color<<24)+this.slotIndex},d.prototype.setFrame=function(x,I,g,D,T,R){x*=d.ENTRIES,this.frames[x]=I,this.frames[x+d.R]=g,this.frames[x+d.G]=D,this.frames[x+d.B]=T,this.frames[x+d.A]=R},d.prototype.apply=function(x,I,g,D,T,R,k){var C=x.slots[this.slotIndex],A=this.frames;if(g<A[0]){switch(R){case M.setup:C.color.setFromColor(C.data.color);return;case M.current:var L=C.color,P=C.data.color;L.add((P.r-L.r)*T,(P.g-L.g)*T,(P.b-L.b)*T,(P.a-L.a)*T)}return}var B=0,_=0,W=0,U=0;if(g>=A[A.length-d.ENTRIES]){var Y=A.length;B=A[Y+d.PREV_R],_=A[Y+d.PREV_G],W=A[Y+d.PREV_B],U=A[Y+d.PREV_A]}else{var G=e.binarySearch(A,g,d.ENTRIES);B=A[G+d.PREV_R],_=A[G+d.PREV_G],W=A[G+d.PREV_B],U=A[G+d.PREV_A];var X=A[G],H=this.getCurvePercent(G/d.ENTRIES-1,1-(g-X)/(A[G+d.PREV_TIME]-X));B+=(A[G+d.R]-B)*H,_+=(A[G+d.G]-_)*H,W+=(A[G+d.B]-W)*H,U+=(A[G+d.A]-U)*H}if(T==1)C.color.set(B,_,W,U);else{var L=C.color;R==M.setup&&L.setFromColor(C.data.color),L.add((B-L.r)*T,(_-L.g)*T,(W-L.b)*T,(U-L.a)*T)}},d.ENTRIES=5,d.PREV_TIME=-5,d.PREV_R=-4,d.PREV_G=-3,d.PREV_B=-2,d.PREV_A=-1,d.R=1,d.G=2,d.B=3,d.A=4,d}(n);l.ColorTimeline=h;var s=function(m){$(d,m);function d(x){m.call(this,x),this.frames=l.Utils.newFloatArray(x*d.ENTRIES)}return d.prototype.getPropertyId=function(){return(t.twoColor<<24)+this.slotIndex},d.prototype.setFrame=function(x,I,g,D,T,R,k,C,A){x*=d.ENTRIES,this.frames[x]=I,this.frames[x+d.R]=g,this.frames[x+d.G]=D,this.frames[x+d.B]=T,this.frames[x+d.A]=R,this.frames[x+d.R2]=k,this.frames[x+d.G2]=C,this.frames[x+d.B2]=A},d.prototype.apply=function(x,I,g,D,T,R,k){var C=x.slots[this.slotIndex],A=this.frames;if(g<A[0]){switch(R){case M.setup:C.color.setFromColor(C.data.color),C.darkColor.setFromColor(C.data.darkColor);return;case M.current:var L=C.color,P=C.darkColor,B=C.data.color,_=C.data.darkColor;L.add((B.r-L.r)*T,(B.g-L.g)*T,(B.b-L.b)*T,(B.a-L.a)*T),P.add((_.r-P.r)*T,(_.g-P.g)*T,(_.b-P.b)*T,0)}return}var W=0,U=0,Y=0,G=0,X=0,H=0,O=0;if(g>=A[A.length-d.ENTRIES]){var q=A.length;W=A[q+d.PREV_R],U=A[q+d.PREV_G],Y=A[q+d.PREV_B],G=A[q+d.PREV_A],X=A[q+d.PREV_R2],H=A[q+d.PREV_G2],O=A[q+d.PREV_B2]}else{var z=e.binarySearch(A,g,d.ENTRIES);W=A[z+d.PREV_R],U=A[z+d.PREV_G],Y=A[z+d.PREV_B],G=A[z+d.PREV_A],X=A[z+d.PREV_R2],H=A[z+d.PREV_G2],O=A[z+d.PREV_B2];var J=A[z],Q=this.getCurvePercent(z/d.ENTRIES-1,1-(g-J)/(A[z+d.PREV_TIME]-J));W+=(A[z+d.R]-W)*Q,U+=(A[z+d.G]-U)*Q,Y+=(A[z+d.B]-Y)*Q,G+=(A[z+d.A]-G)*Q,X+=(A[z+d.R2]-X)*Q,H+=(A[z+d.G2]-H)*Q,O+=(A[z+d.B2]-O)*Q}if(T==1)C.color.set(W,U,Y,G),C.darkColor.set(X,H,O,1);else{var L=C.color,P=C.darkColor;R==M.setup&&(L.setFromColor(C.data.color),P.setFromColor(C.data.darkColor)),L.add((W-L.r)*T,(U-L.g)*T,(Y-L.b)*T,(G-L.a)*T),P.add((X-P.r)*T,(H-P.g)*T,(O-P.b)*T,0)}},d.ENTRIES=8,d.PREV_TIME=-8,d.PREV_R=-7,d.PREV_G=-6,d.PREV_B=-5,d.PREV_A=-4,d.PREV_R2=-3,d.PREV_G2=-2,d.PREV_B2=-1,d.R=1,d.G=2,d.B=3,d.A=4,d.R2=5,d.G2=6,d.B2=7,d}(n);l.TwoColorTimeline=s;var o=function(){function m(d){this.frames=l.Utils.newFloatArray(d),this.attachmentNames=new Array(d)}return m.prototype.getPropertyId=function(){return(t.attachment<<24)+this.slotIndex},m.prototype.getFrameCount=function(){return this.frames.length},m.prototype.setFrame=function(d,x,I){this.frames[d]=x,this.attachmentNames[d]=I},m.prototype.apply=function(d,x,I,g,D,T,R){var k=d.slots[this.slotIndex];if(R==i.out&&T==M.setup){var C=k.data.attachmentName;k.setAttachment(C==null?null:d.getAttachment(this.slotIndex,C));return}var A=this.frames;if(I<A[0]){if(T==M.setup){var L=k.data.attachmentName;k.setAttachment(L==null?null:d.getAttachment(this.slotIndex,L))}return}var P=0;I>=A[A.length-1]?P=A.length-1:P=e.binarySearch(A,I,1)-1;var B=this.attachmentNames[P];d.slots[this.slotIndex].setAttachment(B==null?null:d.getAttachment(this.slotIndex,B))},m}();l.AttachmentTimeline=o;var u=function(m){$(d,m);function d(x){m.call(this,x),this.frames=l.Utils.newFloatArray(x),this.frameVertices=new Array(x)}return d.prototype.getPropertyId=function(){return(t.deform<<27)+ +this.attachment.id+this.slotIndex},d.prototype.setFrame=function(x,I,g){this.frames[x]=I,this.frameVertices[x]=g},d.prototype.apply=function(x,I,g,D,T,R,k){var C=x.slots[this.slotIndex],A=C.getAttachment();if(!(!(A instanceof l.VertexAttachment)||!A.applyDeform(this.attachment))){var L=C.attachmentVertices,P=this.frameVertices,B=P[0].length;L.length!=B&&R!=M.setup&&(T=1);var _=l.Utils.setArraySize(L,B),W=this.frames;if(g<W[0]){switch(R){case M.setup:L.length=0;return;case M.current:T=1-T;for(var U=0;U<B;U++)_[U]*=T}return}if(g>=W[W.length-1]){var Y=P[W.length-1];if(T==1)l.Utils.arrayCopy(Y,0,_,0,B);else if(R==M.setup){var G=A;if(G.bones==null)for(var X=G.vertices,U=0;U<B;U++){var H=X[U];_[U]=H+(Y[U]-H)*T}else for(var U=0;U<B;U++)_[U]=Y[U]*T}else for(var U=0;U<B;U++)_[U]+=(Y[U]-_[U])*T;return}var O=e.binarySearch(W,g),q=P[O-1],z=P[O],J=W[O],Q=this.getCurvePercent(O-1,1-(g-J)/(W[O-1]-J));if(T==1)for(var U=0;U<B;U++){var K=q[U];_[U]=K+(z[U]-K)*Q}else if(R==M.setup){var G=A;if(G.bones==null)for(var X=G.vertices,U=0;U<B;U++){var K=q[U],H=X[U];_[U]=H+(K+(z[U]-K)*Q-H)*T}else for(var U=0;U<B;U++){var K=q[U];_[U]=(K+(z[U]-K)*Q)*T}}else for(var U=0;U<B;U++){var K=q[U];_[U]+=(K+(z[U]-K)*Q-_[U])*T}}},d}(n);l.DeformTimeline=u;var p=function(){function m(d){this.frames=l.Utils.newFloatArray(d),this.events=new Array(d)}return m.prototype.getPropertyId=function(){return t.event<<24},m.prototype.getFrameCount=function(){return this.frames.length},m.prototype.setFrame=function(d,x){this.frames[d]=x.time,this.events[d]=x},m.prototype.apply=function(d,x,I,g,D,T,R){if(g!=null){var k=this.frames,C=this.frames.length;if(x>I)this.apply(d,x,Number.MAX_VALUE,g,D,T,R),x=-1;else if(x>=k[C-1])return;if(!(I<k[0])){var A=0;if(x<k[0])A=0;else{A=e.binarySearch(k,x);for(var L=k[A];A>0&&k[A-1]==L;)A--}for(;A<C&&I>=k[A];A++)g.push(this.events[A])}}},m}();l.EventTimeline=p;var v=function(){function m(d){this.frames=l.Utils.newFloatArray(d),this.drawOrders=new Array(d)}return m.prototype.getPropertyId=function(){return t.drawOrder<<24},m.prototype.getFrameCount=function(){return this.frames.length},m.prototype.setFrame=function(d,x,I){this.frames[d]=x,this.drawOrders[d]=I},m.prototype.apply=function(d,x,I,g,D,T,R){var k=d.drawOrder,C=d.slots;if(R==i.out&&T==M.setup){l.Utils.arrayCopy(d.slots,0,d.drawOrder,0,d.slots.length);return}var A=this.frames;if(I<A[0]){T==M.setup&&l.Utils.arrayCopy(d.slots,0,d.drawOrder,0,d.slots.length);return}var L=0;I>=A[A.length-1]?L=A.length-1:L=e.binarySearch(A,I)-1;var P=this.drawOrders[L];if(P==null)l.Utils.arrayCopy(C,0,k,0,C.length);else for(var B=0,_=P.length;B<_;B++)k[B]=C[P[B]]},m}();l.DrawOrderTimeline=v;var y=function(m){$(d,m);function d(x){m.call(this,x),this.frames=l.Utils.newFloatArray(x*d.ENTRIES)}return d.prototype.getPropertyId=function(){return(t.ikConstraint<<24)+this.ikConstraintIndex},d.prototype.setFrame=function(x,I,g,D){x*=d.ENTRIES,this.frames[x]=I,this.frames[x+d.MIX]=g,this.frames[x+d.BEND_DIRECTION]=D},d.prototype.apply=function(x,I,g,D,T,R,k){var C=this.frames,A=x.ikConstraints[this.ikConstraintIndex];if(g<C[0]){switch(R){case M.setup:A.mix=A.data.mix,A.bendDirection=A.data.bendDirection;return;case M.current:A.mix+=(A.data.mix-A.mix)*T,A.bendDirection=A.data.bendDirection}return}if(g>=C[C.length-d.ENTRIES]){R==M.setup?(A.mix=A.data.mix+(C[C.length+d.PREV_MIX]-A.data.mix)*T,A.bendDirection=k==i.out?A.data.bendDirection:C[C.length+d.PREV_BEND_DIRECTION]):(A.mix+=(C[C.length+d.PREV_MIX]-A.mix)*T,k==i.in&&(A.bendDirection=C[C.length+d.PREV_BEND_DIRECTION]));return}var L=e.binarySearch(C,g,d.ENTRIES),P=C[L+d.PREV_MIX],B=C[L],_=this.getCurvePercent(L/d.ENTRIES-1,1-(g-B)/(C[L+d.PREV_TIME]-B));R==M.setup?(A.mix=A.data.mix+(P+(C[L+d.MIX]-P)*_-A.data.mix)*T,A.bendDirection=k==i.out?A.data.bendDirection:C[L+d.PREV_BEND_DIRECTION]):(A.mix+=(P+(C[L+d.MIX]-P)*_-A.mix)*T,k==i.in&&(A.bendDirection=C[L+d.PREV_BEND_DIRECTION]))},d.ENTRIES=3,d.PREV_TIME=-3,d.PREV_MIX=-2,d.PREV_BEND_DIRECTION=-1,d.MIX=1,d.BEND_DIRECTION=2,d}(n);l.IkConstraintTimeline=y;var E=function(m){$(d,m);function d(x){m.call(this,x),this.frames=l.Utils.newFloatArray(x*d.ENTRIES)}return d.prototype.getPropertyId=function(){return(t.transformConstraint<<24)+this.transformConstraintIndex},d.prototype.setFrame=function(x,I,g,D,T,R){x*=d.ENTRIES,this.frames[x]=I,this.frames[x+d.ROTATE]=g,this.frames[x+d.TRANSLATE]=D,this.frames[x+d.SCALE]=T,this.frames[x+d.SHEAR]=R},d.prototype.apply=function(x,I,g,D,T,R,k){var C=this.frames,A=x.transformConstraints[this.transformConstraintIndex];if(g<C[0]){var L=A.data;switch(R){case M.setup:A.rotateMix=L.rotateMix,A.translateMix=L.translateMix,A.scaleMix=L.scaleMix,A.shearMix=L.shearMix;return;case M.current:A.rotateMix+=(L.rotateMix-A.rotateMix)*T,A.translateMix+=(L.translateMix-A.translateMix)*T,A.scaleMix+=(L.scaleMix-A.scaleMix)*T,A.shearMix+=(L.shearMix-A.shearMix)*T}return}var P=0,B=0,_=0,W=0;if(g>=C[C.length-d.ENTRIES]){var U=C.length;P=C[U+d.PREV_ROTATE],B=C[U+d.PREV_TRANSLATE],_=C[U+d.PREV_SCALE],W=C[U+d.PREV_SHEAR]}else{var Y=e.binarySearch(C,g,d.ENTRIES);P=C[Y+d.PREV_ROTATE],B=C[Y+d.PREV_TRANSLATE],_=C[Y+d.PREV_SCALE],W=C[Y+d.PREV_SHEAR];var G=C[Y],X=this.getCurvePercent(Y/d.ENTRIES-1,1-(g-G)/(C[Y+d.PREV_TIME]-G));P+=(C[Y+d.ROTATE]-P)*X,B+=(C[Y+d.TRANSLATE]-B)*X,_+=(C[Y+d.SCALE]-_)*X,W+=(C[Y+d.SHEAR]-W)*X}if(R==M.setup){var L=A.data;A.rotateMix=L.rotateMix+(P-L.rotateMix)*T,A.translateMix=L.translateMix+(B-L.translateMix)*T,A.scaleMix=L.scaleMix+(_-L.scaleMix)*T,A.shearMix=L.shearMix+(W-L.shearMix)*T}else A.rotateMix+=(P-A.rotateMix)*T,A.translateMix+=(B-A.translateMix)*T,A.scaleMix+=(_-A.scaleMix)*T,A.shearMix+=(W-A.shearMix)*T},d.ENTRIES=5,d.PREV_TIME=-5,d.PREV_ROTATE=-4,d.PREV_TRANSLATE=-3,d.PREV_SCALE=-2,d.PREV_SHEAR=-1,d.ROTATE=1,d.TRANSLATE=2,d.SCALE=3,d.SHEAR=4,d}(n);l.TransformConstraintTimeline=E;var S=function(m){$(d,m);function d(x){m.call(this,x),this.frames=l.Utils.newFloatArray(x*d.ENTRIES)}return d.prototype.getPropertyId=function(){return(t.pathConstraintPosition<<24)+this.pathConstraintIndex},d.prototype.setFrame=function(x,I,g){x*=d.ENTRIES,this.frames[x]=I,this.frames[x+d.VALUE]=g},d.prototype.apply=function(x,I,g,D,T,R,k){var C=this.frames,A=x.pathConstraints[this.pathConstraintIndex];if(g<C[0]){switch(R){case M.setup:A.position=A.data.position;return;case M.current:A.position+=(A.data.position-A.position)*T}return}var L=0;if(g>=C[C.length-d.ENTRIES])L=C[C.length+d.PREV_VALUE];else{var P=e.binarySearch(C,g,d.ENTRIES);L=C[P+d.PREV_VALUE];var B=C[P],_=this.getCurvePercent(P/d.ENTRIES-1,1-(g-B)/(C[P+d.PREV_TIME]-B));L+=(C[P+d.VALUE]-L)*_}R==M.setup?A.position=A.data.position+(L-A.data.position)*T:A.position+=(L-A.position)*T},d.ENTRIES=2,d.PREV_TIME=-2,d.PREV_VALUE=-1,d.VALUE=1,d}(n);l.PathConstraintPositionTimeline=S;var V=function(m){$(d,m);function d(x){m.call(this,x)}return d.prototype.getPropertyId=function(){return(t.pathConstraintSpacing<<24)+this.pathConstraintIndex},d.prototype.apply=function(x,I,g,D,T,R,k){var C=this.frames,A=x.pathConstraints[this.pathConstraintIndex];if(g<C[0]){switch(R){case M.setup:A.spacing=A.data.spacing;return;case M.current:A.spacing+=(A.data.spacing-A.spacing)*T}return}var L=0;if(g>=C[C.length-d.ENTRIES])L=C[C.length+d.PREV_VALUE];else{var P=e.binarySearch(C,g,d.ENTRIES);L=C[P+d.PREV_VALUE];var B=C[P],_=this.getCurvePercent(P/d.ENTRIES-1,1-(g-B)/(C[P+d.PREV_TIME]-B));L+=(C[P+d.VALUE]-L)*_}R==M.setup?A.spacing=A.data.spacing+(L-A.data.spacing)*T:A.spacing+=(L-A.spacing)*T},d}(S);l.PathConstraintSpacingTimeline=V;var F=function(m){$(d,m);function d(x){m.call(this,x),this.frames=l.Utils.newFloatArray(x*d.ENTRIES)}return d.prototype.getPropertyId=function(){return(t.pathConstraintMix<<24)+this.pathConstraintIndex},d.prototype.setFrame=function(x,I,g,D){x*=d.ENTRIES,this.frames[x]=I,this.frames[x+d.ROTATE]=g,this.frames[x+d.TRANSLATE]=D},d.prototype.apply=function(x,I,g,D,T,R,k){var C=this.frames,A=x.pathConstraints[this.pathConstraintIndex];if(g<C[0]){switch(R){case M.setup:A.rotateMix=A.data.rotateMix,A.translateMix=A.data.translateMix;return;case M.current:A.rotateMix+=(A.data.rotateMix-A.rotateMix)*T,A.translateMix+=(A.data.translateMix-A.translateMix)*T}return}var L=0,P=0;if(g>=C[C.length-d.ENTRIES])L=C[C.length+d.PREV_ROTATE],P=C[C.length+d.PREV_TRANSLATE];else{var B=e.binarySearch(C,g,d.ENTRIES);L=C[B+d.PREV_ROTATE],P=C[B+d.PREV_TRANSLATE];var _=C[B],W=this.getCurvePercent(B/d.ENTRIES-1,1-(g-_)/(C[B+d.PREV_TIME]-_));L+=(C[B+d.ROTATE]-L)*W,P+=(C[B+d.TRANSLATE]-P)*W}R==M.setup?(A.rotateMix=A.data.rotateMix+(L-A.data.rotateMix)*T,A.translateMix=A.data.translateMix+(P-A.data.translateMix)*T):(A.rotateMix+=(L-A.rotateMix)*T,A.translateMix+=(P-A.translateMix)*T)},d.ENTRIES=3,d.PREV_TIME=-3,d.PREV_ROTATE=-2,d.PREV_TRANSLATE=-1,d.ROTATE=1,d.TRANSLATE=2,d}(n);l.PathConstraintMixTimeline=F})(N||(N={}));var N;(function(l){var e=function(){function r(a){this.tracks=new Array,this.events=new Array,this.listeners=new Array,this.queue=new i(this),this.propertyIDs=new l.IntSet,this.mixingTo=new Array,this.animationsChanged=!1,this.timeScale=1,this.trackEntryPool=new l.Pool(function(){return new M}),this.data=a}return r.prototype.update=function(a){a*=this.timeScale;for(var f=this.tracks,c=0,h=f.length;c<h;c++){var s=f[c];if(s!=null){s.animationLast=s.nextAnimationLast,s.trackLast=s.nextTrackLast;var o=a*s.timeScale;if(s.delay>0){if(s.delay-=o,s.delay>0)continue;o=-s.delay,s.delay=0}var u=s.next;if(u!=null){var p=s.trackLast-u.delay;if(p>=0){for(u.delay=0,u.trackTime=p+a*u.timeScale,s.trackTime+=o,this.setCurrent(c,u,!0);u.mixingFrom!=null;)u.mixTime+=o,u=u.mixingFrom;continue}}else if(s.trackLast>=s.trackEnd&&s.mixingFrom==null){f[c]=null,this.queue.end(s),this.disposeNext(s);continue}if(s.mixingFrom!=null&&this.updateMixingFrom(s,a)){var v=s.mixingFrom;for(s.mixingFrom=null;v!=null;)this.queue.end(v),v=v.mixingFrom}s.trackTime+=o}}this.queue.drain()},r.prototype.updateMixingFrom=function(a,f){var c=a.mixingFrom;if(c==null)return!0;var h=this.updateMixingFrom(c,f);return a.mixTime>0&&(a.mixTime>=a.mixDuration||a.timeScale==0)?(c.totalAlpha==0&&(a.mixingFrom=c.mixingFrom,a.interruptAlpha=c.interruptAlpha,this.queue.end(c)),h):(c.animationLast=c.nextAnimationLast,c.trackLast=c.nextTrackLast,c.trackTime+=f*c.timeScale,a.mixTime+=f*a.timeScale,!1)},r.prototype.apply=function(a){if(a==null)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var f=this.events,c=this.tracks,h=!1,s=0,o=c.length;s<o;s++){var u=c[s];if(!(u==null||u.delay>0)){h=!0;var p=s==0?l.MixPose.current:l.MixPose.currentLayered,v=u.alpha;u.mixingFrom!=null?v*=this.applyMixingFrom(u,a,p):u.trackTime>=u.trackEnd&&u.next==null&&(v=0);var y=u.animationLast,E=u.getAnimationTime(),S=u.animation.timelines.length,V=u.animation.timelines;if(v==1)for(var F=0;F<S;F++)V[F].apply(a,y,E,f,1,l.MixPose.setup,l.MixDirection.in);else{var m=u.timelineData,d=u.timelinesRotation.length==0;d&&l.Utils.setArraySize(u.timelinesRotation,S<<1,null);for(var x=u.timelinesRotation,F=0;F<S;F++){var I=V[F],g=m[F]>=r.FIRST?l.MixPose.setup:p;I instanceof l.RotateTimeline?this.applyRotateTimeline(I,a,E,v,g,x,F<<1,d):I.apply(a,y,E,f,v,g,l.MixDirection.in)}}this.queueEvents(u,E),f.length=0,u.nextAnimationLast=E,u.nextTrackLast=u.trackTime}}return this.queue.drain(),h},r.prototype.applyMixingFrom=function(a,f,c){var h=a.mixingFrom;h.mixingFrom!=null&&this.applyMixingFrom(h,f,c);var s=0;a.mixDuration==0?s=1:(s=a.mixTime/a.mixDuration,s>1&&(s=1));var o=s<h.eventThreshold?this.events:null,u=s<h.attachmentThreshold,p=s<h.drawOrderThreshold,v=h.animationLast,y=h.getAnimationTime(),E=h.animation.timelines.length,S=h.animation.timelines,V=h.timelineData,F=h.timelineDipMix,m=h.timelinesRotation.length==0;m&&l.Utils.setArraySize(h.timelinesRotation,E<<1,null);var d=h.timelinesRotation,x,I=h.alpha*a.interruptAlpha,g=I*(1-s),D=0;h.totalAlpha=0;for(var T=0;T<E;T++){var R=S[T];switch(V[T]){case r.SUBSEQUENT:if(!u&&R instanceof l.AttachmentTimeline||!p&&R instanceof l.DrawOrderTimeline)continue;x=c,D=g;break;case r.FIRST:x=l.MixPose.setup,D=g;break;case r.DIP:x=l.MixPose.setup,D=I;break;default:x=l.MixPose.setup,D=I;var k=F[T];D*=Math.max(0,1-k.mixTime/k.mixDuration);break}h.totalAlpha+=D,R instanceof l.RotateTimeline?this.applyRotateTimeline(R,f,y,D,x,d,T<<1,m):R.apply(f,v,y,o,D,x,l.MixDirection.out)}return a.mixDuration>0&&this.queueEvents(h,y),this.events.length=0,h.nextAnimationLast=y,h.nextTrackLast=h.trackTime,s},r.prototype.applyRotateTimeline=function(a,f,c,h,s,o,u,p){if(p&&(o[u]=0),h==1){a.apply(f,0,c,null,1,s,l.MixDirection.in);return}var v=a,y=v.frames,E=f.bones[v.boneIndex];if(c<y[0]){s==l.MixPose.setup&&(E.rotation=E.data.rotation);return}var S=0;if(c>=y[y.length-l.RotateTimeline.ENTRIES])S=E.data.rotation+y[y.length+l.RotateTimeline.PREV_ROTATION];else{var V=l.Animation.binarySearch(y,c,l.RotateTimeline.ENTRIES),F=y[V+l.RotateTimeline.PREV_ROTATION],m=y[V],d=v.getCurvePercent((V>>1)-1,1-(c-m)/(y[V+l.RotateTimeline.PREV_TIME]-m));S=y[V+l.RotateTimeline.ROTATION]-F,S-=(16384-(16384.499999999996-S/360|0))*360,S=F+S*d+E.data.rotation,S-=(16384-(16384.499999999996-S/360|0))*360}var x=s==l.MixPose.setup?E.data.rotation:E.rotation,I=0,g=S-x;if(g==0)I=o[u];else{g-=(16384-(16384.499999999996-g/360|0))*360;var D=0,T=0;p?(D=0,T=g):(D=o[u],T=o[u+1]);var R=g>0,k=D>=0;l.MathUtils.signum(T)!=l.MathUtils.signum(g)&&Math.abs(T)<=90&&(Math.abs(D)>180&&(D+=360*l.MathUtils.signum(D)),k=R),I=g+D-D%360,k!=R&&(I+=360*l.MathUtils.signum(D)),o[u]=I}o[u+1]=g,x+=I*h,E.rotation=x-(16384-(16384.499999999996-x/360|0))*360},r.prototype.queueEvents=function(a,f){for(var c=a.animationStart,h=a.animationEnd,s=h-c,o=a.trackLast%s,u=this.events,p=0,v=u.length;p<v;p++){var y=u[p];if(y.time<o)break;y.time>h||this.queue.event(a,y)}for((a.loop?o>a.trackTime%s:f>=h&&a.animationLast<h)&&this.queue.complete(a);p<v;p++){var E=u[p];E.time<c||this.queue.event(a,u[p])}},r.prototype.clearTracks=function(){var a=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var f=0,c=this.tracks.length;f<c;f++)this.clearTrack(f);this.tracks.length=0,this.queue.drainDisabled=a,this.queue.drain()},r.prototype.clearTrack=function(a){if(!(a>=this.tracks.length)){var f=this.tracks[a];if(f!=null){this.queue.end(f),this.disposeNext(f);for(var c=f;;){var h=c.mixingFrom;if(h==null)break;this.queue.end(h),c.mixingFrom=null,c=h}this.tracks[f.trackIndex]=null,this.queue.drain()}}},r.prototype.setCurrent=function(a,f,c){var h=this.expandToIndex(a);this.tracks[a]=f,h!=null&&(c&&this.queue.interrupt(h),f.mixingFrom=h,f.mixTime=0,h.mixingFrom!=null&&h.mixDuration>0&&(f.interruptAlpha*=Math.min(1,h.mixTime/h.mixDuration)),h.timelinesRotation.length=0),this.queue.start(f)},r.prototype.setAnimation=function(a,f,c){var h=this.data.skeletonData.findAnimation(f);if(h==null)throw new Error("Animation not found: "+f);return this.setAnimationWith(a,h,c)},r.prototype.setAnimationWith=function(a,f,c){if(f==null)throw new Error("animation cannot be null.");var h=!0,s=this.expandToIndex(a);s!=null&&(s.nextTrackLast==-1?(this.tracks[a]=s.mixingFrom,this.queue.interrupt(s),this.queue.end(s),this.disposeNext(s),s=s.mixingFrom,h=!1):this.disposeNext(s));var o=this.trackEntry(a,f,c,s);return this.setCurrent(a,o,h),this.queue.drain(),o},r.prototype.addAnimation=function(a,f,c,h){var s=this.data.skeletonData.findAnimation(f);if(s==null)throw new Error("Animation not found: "+f);return this.addAnimationWith(a,s,c,h)},r.prototype.addAnimationWith=function(a,f,c,h){if(f==null)throw new Error("animation cannot be null.");var s=this.expandToIndex(a);if(s!=null)for(;s.next!=null;)s=s.next;var o=this.trackEntry(a,f,c,s);if(s==null)this.setCurrent(a,o,!0),this.queue.drain();else if(s.next=o,h<=0){var u=s.animationEnd-s.animationStart;u!=0?h+=u*(1+(s.trackTime/u|0))-this.data.getMix(s.animation,f):h=0}return o.delay=h,o},r.prototype.setEmptyAnimation=function(a,f){var c=this.setAnimationWith(a,r.emptyAnimation,!1);return c.mixDuration=f,c.trackEnd=f,c},r.prototype.addEmptyAnimation=function(a,f,c){c<=0&&(c-=f);var h=this.addAnimationWith(a,r.emptyAnimation,!1,c);return h.mixDuration=f,h.trackEnd=f,h},r.prototype.setEmptyAnimations=function(a){var f=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var c=0,h=this.tracks.length;c<h;c++){var s=this.tracks[c];s!=null&&this.setEmptyAnimation(s.trackIndex,a)}this.queue.drainDisabled=f,this.queue.drain()},r.prototype.expandToIndex=function(a){return a<this.tracks.length?this.tracks[a]:(l.Utils.ensureArrayCapacity(this.tracks,a-this.tracks.length+1,null),this.tracks.length=a+1,null)},r.prototype.trackEntry=function(a,f,c,h){var s=this.trackEntryPool.obtain();return s.trackIndex=a,s.animation=f,s.loop=c,s.eventThreshold=0,s.attachmentThreshold=0,s.drawOrderThreshold=0,s.animationStart=0,s.animationEnd=f.duration,s.animationLast=-1,s.nextAnimationLast=-1,s.delay=0,s.trackTime=0,s.trackLast=-1,s.nextTrackLast=-1,s.trackEnd=Number.MAX_VALUE,s.timeScale=1,s.alpha=1,s.interruptAlpha=1,s.mixTime=0,s.mixDuration=h==null?0:this.data.getMix(h.animation,f),s},r.prototype.disposeNext=function(a){for(var f=a.next;f!=null;)this.queue.dispose(f),f=f.next;a.next=null},r.prototype._animationsChanged=function(){this.animationsChanged=!1;var a=this.propertyIDs;a.clear();for(var f=this.mixingTo,c=null,h=0,s=this.tracks.length;h<s;h++){var o=this.tracks[h];o!=null&&(o.setTimelineData(c,f,a),c=o)}},r.prototype.getCurrent=function(a){return a>=this.tracks.length?null:this.tracks[a]},r.prototype.addListener=function(a){if(a==null)throw new Error("listener cannot be null.");this.listeners.push(a)},r.prototype.removeListener=function(a){var f=this.listeners.indexOf(a);f>=0&&this.listeners.splice(f,1)},r.prototype.clearListeners=function(){this.listeners.length=0},r.prototype.clearListenerNotifications=function(){this.queue.clear()},r.emptyAnimation=new l.Animation("<empty>",[],0),r.SUBSEQUENT=0,r.FIRST=1,r.DIP=2,r.DIP_MIX=3,r}();l.AnimationState=e;var M=function(){function r(){this.timelineData=new Array,this.timelineDipMix=new Array,this.timelinesRotation=new Array}return r.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.animation=null,this.listener=null,this.timelineData.length=0,this.timelineDipMix.length=0,this.timelinesRotation.length=0},r.prototype.setTimelineData=function(a,f,c){a!=null&&f.push(a);var h=this.mixingFrom!=null?this.mixingFrom.setTimelineData(this,f,c):this;a!=null&&f.pop();var s=f,o=f.length-1,u=this.animation.timelines,p=this.animation.timelines.length,v=l.Utils.setArraySize(this.timelineData,p);this.timelineDipMix.length=0;var y=l.Utils.setArraySize(this.timelineDipMix,p);t:for(var E=0;E<p;E++){var S=u[E].getPropertyId();if(!c.add(S))v[E]=e.SUBSEQUENT;else if(a==null||!a.hasTimeline(S))v[E]=e.FIRST;else{for(var V=o;V>=0;V--){var F=s[V];if(!F.hasTimeline(S)&&F.mixDuration>0){v[E]=e.DIP_MIX,y[E]=F;continue t}}v[E]=e.DIP}}return h},r.prototype.hasTimeline=function(a){for(var f=this.animation.timelines,c=0,h=f.length;c<h;c++)if(f[c].getPropertyId()==a)return!0;return!1},r.prototype.getAnimationTime=function(){if(this.loop){var a=this.animationEnd-this.animationStart;return a==0?this.animationStart:this.trackTime%a+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},r.prototype.setAnimationLast=function(a){this.animationLast=a,this.nextAnimationLast=a},r.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},r.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},r}();l.TrackEntry=M;var i=function(){function r(a){this.objects=[],this.drainDisabled=!1,this.animState=a}return r.prototype.start=function(a){this.objects.push(t.start),this.objects.push(a),this.animState.animationsChanged=!0},r.prototype.interrupt=function(a){this.objects.push(t.interrupt),this.objects.push(a)},r.prototype.end=function(a){this.objects.push(t.end),this.objects.push(a),this.animState.animationsChanged=!0},r.prototype.dispose=function(a){this.objects.push(t.dispose),this.objects.push(a)},r.prototype.complete=function(a){this.objects.push(t.complete),this.objects.push(a)},r.prototype.event=function(a,f){this.objects.push(t.event),this.objects.push(a),this.objects.push(f)},r.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var a=this.objects,f=this.animState.listeners,c=0;c<a.length;c+=2){var h=a[c],s=a[c+1];switch(h){case t.start:s.listener!=null&&s.listener.start&&s.listener.start(s);for(var o=0;o<f.length;o++)f[o].start&&f[o].start(s);break;case t.interrupt:s.listener!=null&&s.listener.interrupt&&s.listener.interrupt(s);for(var o=0;o<f.length;o++)f[o].interrupt&&f[o].interrupt(s);break;case t.end:s.listener!=null&&s.listener.end&&s.listener.end(s);for(var o=0;o<f.length;o++)f[o].end&&f[o].end(s);case t.dispose:s.listener!=null&&s.listener.dispose&&s.listener.dispose(s);for(var o=0;o<f.length;o++)f[o].dispose&&f[o].dispose(s);this.animState.trackEntryPool.free(s);break;case t.complete:s.listener!=null&&s.listener.complete&&s.listener.complete(s);for(var o=0;o<f.length;o++)f[o].complete&&f[o].complete(s);break;case t.event:var u=a[c+++2];s.listener!=null&&s.listener.event&&s.listener.event(s,u);for(var o=0;o<f.length;o++)f[o].event&&f[o].event(s,u);break}}this.clear(),this.drainDisabled=!1}},r.prototype.clear=function(){this.objects.length=0},r}();l.EventQueue=i,function(r){r[r.start=0]="start",r[r.interrupt=1]="interrupt",r[r.end=2]="end",r[r.dispose=3]="dispose",r[r.complete=4]="complete",r[r.event=5]="event"}(l.EventType||(l.EventType={}));var t=l.EventType,n=function(){function r(){}return r.prototype.start=function(a){},r.prototype.interrupt=function(a){},r.prototype.end=function(a){},r.prototype.dispose=function(a){},r.prototype.complete=function(a){},r.prototype.event=function(a,f){},r}();l.AnimationStateAdapter2=n})(N||(N={}));var N;(function(l){var e=function(){function M(i){if(this.animationToMixTime={},this.defaultMix=0,i==null)throw new Error("skeletonData cannot be null.");this.skeletonData=i}return M.prototype.setMix=function(i,t,n){var r=this.skeletonData.findAnimation(i);if(r==null)throw new Error("Animation not found: "+i);var a=this.skeletonData.findAnimation(t);if(a==null)throw new Error("Animation not found: "+t);this.setMixWith(r,a,n)},M.prototype.setMixWith=function(i,t,n){if(i==null)throw new Error("from cannot be null.");if(t==null)throw new Error("to cannot be null.");var r=i.name+t.name;this.animationToMixTime[r]=n},M.prototype.getMix=function(i,t){var n=i.name+t.name,r=this.animationToMixTime[n];return r===void 0?this.defaultMix:r},M}();l.AnimationStateData=e})(N||(N={}));var N;(function(l){var e=function(){function M(i,t){t===void 0&&(t=""),this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.textureLoader=i,this.pathPrefix=t}return M.prototype.loadText=function(i,t,n){var r=this;t===void 0&&(t=null),n===void 0&&(n=null),i=this.pathPrefix+i,this.toLoad++;var a=new XMLHttpRequest;a.onreadystatechange=function(){a.readyState==XMLHttpRequest.DONE&&(a.status>=200&&a.status<300?(r.assets[i]=a.responseText,t&&t(i,a.responseText)):(r.errors[i]="Couldn't load text "+i+": status "+a.status+", "+a.responseText,n&&n(i,"Couldn't load text "+i+": status "+a.status+", "+a.responseText)),r.toLoad--,r.loaded++)},a.open("GET",i,!0),a.send()},M.prototype.loadTexture=function(i,t,n){var r=this;t===void 0&&(t=null),n===void 0&&(n=null),i=this.pathPrefix+i,this.toLoad++;var a=new Image;a.crossOrigin="anonymous",a.onload=function(f){var c=r.textureLoader(a);r.assets[i]=c,r.toLoad--,r.loaded++,t&&t(i,a)},a.onerror=function(f){r.errors[i]="Couldn't load image "+i,r.toLoad--,r.loaded++,n&&n(i,"Couldn't load image "+i)},a.src=i},M.prototype.loadTextureData=function(i,t,n,r){var a=this;n===void 0&&(n=null),r===void 0&&(r=null),i=this.pathPrefix+i,this.toLoad++;var f=new Image;f.onload=function(c){var h=a.textureLoader(f);a.assets[i]=h,a.toLoad--,a.loaded++,n&&n(i,f)},f.onerror=function(c){a.errors[i]="Couldn't load image "+i,a.toLoad--,a.loaded++,r&&r(i,"Couldn't load image "+i)},f.src=t},M.prototype.get=function(i){return i=this.pathPrefix+i,this.assets[i]},M.prototype.remove=function(i){i=this.pathPrefix+i;var t=this.assets[i];t.dispose&&t.dispose(),this.assets[i]=null},M.prototype.removeAll=function(){for(var i in this.assets){var t=this.assets[i];t.dispose&&t.dispose()}this.assets={}},M.prototype.isLoadingComplete=function(){return this.toLoad==0},M.prototype.getToLoad=function(){return this.toLoad},M.prototype.getLoaded=function(){return this.loaded},M.prototype.dispose=function(){this.removeAll()},M.prototype.hasErrors=function(){return Object.keys(this.errors).length>0},M.prototype.getErrors=function(){return this.errors},M}();l.AssetManager=e})(N||(N={}));var N;(function(l){var e=function(){function M(i){this.atlas=i}return M.prototype.newRegionAttachment=function(i,t,n){var r=this.atlas.findRegion(n);if(r==null)throw new Error("Region not found in atlas: "+n+" (region attachment: "+t+")");r.renderObject=r;var a=new l.RegionAttachment(t);return a.setRegion(r),a},M.prototype.newMeshAttachment=function(i,t,n){var r=this.atlas.findRegion(n);if(r==null)throw new Error("Region not found in atlas: "+n+" (mesh attachment: "+t+")");r.renderObject=r;var a=new l.MeshAttachment(t);return a.region=r,a},M.prototype.newBoundingBoxAttachment=function(i,t){return new l.BoundingBoxAttachment(t)},M.prototype.newPathAttachment=function(i,t){return new l.PathAttachment(t)},M.prototype.newPointAttachment=function(i,t){return new l.PointAttachment(t)},M.prototype.newClippingAttachment=function(i,t){return new l.ClippingAttachment(t)},M}();l.AtlasAttachmentLoader=e})(N||(N={}));var N;(function(l){var e=function(){function i(t){if(t==null)throw new Error("name cannot be null.");this.name=t}return i}();l.Attachment=e;var M=function(i){$(t,i);function t(n){i.call(this,n),this.id=(t.nextID++&65535)<<11,this.worldVerticesLength=0}return t.prototype.computeWorldVertices=function(n,r,a,f,c,h){a=c+(a>>1)*h;var s=n.bone.skeleton,o=n.attachmentVertices,u=this.vertices,p=this.bones;if(p==null){o.length>0&&(u=o);for(var v=n.bone,y=v.worldX,E=v.worldY,S=v.a,V=v.b,F=v.c,m=v.d,d=r,x=c;x<a;d+=2,x+=h){var I=u[d],g=u[d+1];f[x]=I*S+g*V+y,f[x+1]=I*F+g*m+E}return}for(var D=0,T=0,R=0;R<r;R+=2){var k=p[D];D+=k+1,T+=k}var C=s.bones;if(o.length==0)for(var x=c,V=T*3;x<a;x+=h){var A=0,L=0,k=p[D++];for(k+=D;D<k;D++,V+=3){var v=C[p[D]],I=u[V],g=u[V+1],P=u[V+2];A+=(I*v.a+g*v.b+v.worldX)*P,L+=(I*v.c+g*v.d+v.worldY)*P}f[x]=A,f[x+1]=L}else for(var B=o,x=c,V=T*3,_=T<<1;x<a;x+=h){var A=0,L=0,k=p[D++];for(k+=D;D<k;D++,V+=3,_+=2){var v=C[p[D]],I=u[V]+B[_],g=u[V+1]+B[_+1],P=u[V+2];A+=(I*v.a+g*v.b+v.worldX)*P,L+=(I*v.c+g*v.d+v.worldY)*P}f[x]=A,f[x+1]=L}},t.prototype.applyDeform=function(n){return this==n},t.nextID=0,t}(e);l.VertexAttachment=M})(N||(N={}));var N;(function(l){(function(e){e[e.Region=0]="Region",e[e.BoundingBox=1]="BoundingBox",e[e.Mesh=2]="Mesh",e[e.LinkedMesh=3]="LinkedMesh",e[e.Path=4]="Path",e[e.Point=5]="Point"})(l.AttachmentType||(l.AttachmentType={})),l.AttachmentType})(N||(N={}));var N;(function(l){var e=function(M){$(i,M);function i(t){M.call(this,t),this.color=new l.Color(1,1,1,1)}return i}(l.VertexAttachment);l.BoundingBoxAttachment=e})(N||(N={}));var N;(function(l){var e=function(M){$(i,M);function i(t){M.call(this,t),this.color=new l.Color(.2275,.2275,.8078,1)}return i}(l.VertexAttachment);l.ClippingAttachment=e})(N||(N={}));var N;(function(l){var e=function(M){$(i,M);function i(t){M.call(this,t),this.color=new l.Color(1,1,1,1),this.inheritDeform=!1,this.tempColor=new l.Color(0,0,0,0)}return i.prototype.updateUVs=function(){var t=0,n=0,r=0,a=0;this.region==null?(t=n=0,r=a=1):(t=this.region.u,n=this.region.v,r=this.region.u2-t,a=this.region.v2-n);var f=this.regionUVs;(this.uvs==null||this.uvs.length!=f.length)&&(this.uvs=l.Utils.newFloatArray(f.length));var c=this.uvs;if(this.region.rotate)for(var h=0,s=c.length;h<s;h+=2)c[h]=t+f[h+1]*r,c[h+1]=n+a-f[h]*a;else for(var h=0,s=c.length;h<s;h+=2)c[h]=t+f[h]*r,c[h+1]=n+f[h+1]*a},i.prototype.applyDeform=function(t){return this==t||this.inheritDeform&&this.parentMesh==t},i.prototype.getParentMesh=function(){return this.parentMesh},i.prototype.setParentMesh=function(t){this.parentMesh=t,t!=null&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)},i}(l.VertexAttachment);l.MeshAttachment=e})(N||(N={}));var N;(function(l){var e=function(M){$(i,M);function i(t){M.call(this,t),this.closed=!1,this.constantSpeed=!1,this.color=new l.Color(1,1,1,1)}return i}(l.VertexAttachment);l.PathAttachment=e})(N||(N={}));var N;(function(l){var e=function(M){$(i,M);function i(t){M.call(this,t),this.color=new l.Color(.38,.94,0,1)}return i.prototype.computeWorldPosition=function(t,n){return n.x=this.x*t.a+this.y*t.b+t.worldX,n.y=this.x*t.c+this.y*t.d+t.worldY,n},i.prototype.computeWorldRotation=function(t){var n=l.MathUtils.cosDeg(this.rotation),r=l.MathUtils.sinDeg(this.rotation),a=n*t.a+r*t.b,f=n*t.c+r*t.d;return Math.atan2(f,a)*l.MathUtils.radDeg},i}(l.VertexAttachment);l.PointAttachment=e})(N||(N={}));var N;(function(l){var e=function(M){$(i,M);function i(t){M.call(this,t),this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new l.Color(1,1,1,1),this.offset=l.Utils.newFloatArray(8),this.uvs=l.Utils.newFloatArray(8),this.tempColor=new l.Color(1,1,1,1)}return i.prototype.updateOffset=function(){var t=this.width/this.region.originalWidth*this.scaleX,n=this.height/this.region.originalHeight*this.scaleY,r=-this.width/2*this.scaleX+this.region.offsetX*t,a=-this.height/2*this.scaleY+this.region.offsetY*n,f=r+this.region.width*t,c=a+this.region.height*n,h=this.rotation*Math.PI/180,s=Math.cos(h),o=Math.sin(h),u=r*s+this.x,p=r*o,v=a*s+this.y,y=a*o,E=f*s+this.x,S=f*o,V=c*s+this.y,F=c*o,m=this.offset;m[i.OX1]=u-y,m[i.OY1]=v+p,m[i.OX2]=u-F,m[i.OY2]=V+p,m[i.OX3]=E-F,m[i.OY3]=V+S,m[i.OX4]=E-y,m[i.OY4]=v+S},i.prototype.setRegion=function(t){this.region=t;var n=this.uvs;t.rotate?(n[2]=t.u,n[3]=t.v2,n[4]=t.u,n[5]=t.v,n[6]=t.u2,n[7]=t.v,n[0]=t.u2,n[1]=t.v2):(n[0]=t.u,n[1]=t.v2,n[2]=t.u,n[3]=t.v,n[4]=t.u2,n[5]=t.v,n[6]=t.u2,n[7]=t.v2)},i.prototype.computeWorldVertices=function(t,n,r,a){var f=this.offset,c=t.worldX,h=t.worldY,s=t.a,o=t.b,u=t.c,p=t.d,v=0,y=0;v=f[i.OX1],y=f[i.OY1],n[r]=v*s+y*o+c,n[r+1]=v*u+y*p+h,r+=a,v=f[i.OX2],y=f[i.OY2],n[r]=v*s+y*o+c,n[r+1]=v*u+y*p+h,r+=a,v=f[i.OX3],y=f[i.OY3],n[r]=v*s+y*o+c,n[r+1]=v*u+y*p+h,r+=a,v=f[i.OX4],y=f[i.OY4],n[r]=v*s+y*o+c,n[r+1]=v*u+y*p+h},i.OX1=0,i.OY1=1,i.OX2=2,i.OY2=3,i.OX3=4,i.OY3=5,i.OX4=6,i.OY4=7,i.X1=0,i.Y1=1,i.C1R=2,i.C1G=3,i.C1B=4,i.C1A=5,i.U1=6,i.V1=7,i.X2=8,i.Y2=9,i.C2R=10,i.C2G=11,i.C2B=12,i.C2A=13,i.U2=14,i.V2=15,i.X3=16,i.Y3=17,i.C3R=18,i.C3G=19,i.C3B=20,i.C3A=21,i.U3=22,i.V3=23,i.X4=24,i.Y4=25,i.C4R=26,i.C4G=27,i.C4B=28,i.C4A=29,i.U4=30,i.V4=31,i}(l.Attachment);l.RegionAttachment=e})(N||(N={}));var N;(function(l){(function(e){e[e.Normal=0]="Normal",e[e.Additive=1]="Additive",e[e.Multiply=2]="Multiply",e[e.Screen=3]="Screen"})(l.BlendMode||(l.BlendMode={})),l.BlendMode})(N||(N={}));var N;(function(l){var e=function(){function M(i,t,n){if(this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.a=0,this.b=0,this.worldX=0,this.c=0,this.d=0,this.worldY=0,this.sorted=!1,i==null)throw new Error("data cannot be null.");if(t==null)throw new Error("skeleton cannot be null.");this.data=i,this.skeleton=t,this.parent=n,this.setToSetupPose()}return M.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},M.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},M.prototype.updateWorldTransformWith=function(i,t,n,r,a,f,c){this.ax=i,this.ay=t,this.arotation=n,this.ascaleX=r,this.ascaleY=a,this.ashearX=f,this.ashearY=c,this.appliedValid=!0;var h=this.parent;if(h==null){var s=n+90+c,o=l.MathUtils.cosDeg(n+f)*r,u=l.MathUtils.cosDeg(s)*a,p=l.MathUtils.sinDeg(n+f)*r,v=l.MathUtils.sinDeg(s)*a,y=this.skeleton;y.flipX&&(i=-i,o=-o,u=-u),y.flipY&&(t=-t,p=-p,v=-v),this.a=o,this.b=u,this.c=p,this.d=v,this.worldX=i+y.x,this.worldY=t+y.y;return}var E=h.a,S=h.b,V=h.c,F=h.d;switch(this.worldX=E*i+S*t+h.worldX,this.worldY=V*i+F*t+h.worldY,this.data.transformMode){case l.TransformMode.Normal:{var s=n+90+c,o=l.MathUtils.cosDeg(n+f)*r,u=l.MathUtils.cosDeg(s)*a,p=l.MathUtils.sinDeg(n+f)*r,v=l.MathUtils.sinDeg(s)*a;this.a=E*o+S*p,this.b=E*u+S*v,this.c=V*o+F*p,this.d=V*u+F*v;return}case l.TransformMode.OnlyTranslation:{var s=n+90+c;this.a=l.MathUtils.cosDeg(n+f)*r,this.b=l.MathUtils.cosDeg(s)*a,this.c=l.MathUtils.sinDeg(n+f)*r,this.d=l.MathUtils.sinDeg(s)*a;break}case l.TransformMode.NoRotationOrReflection:{var m=E*E+V*V,d=0;m>1e-4?(m=Math.abs(E*F-S*V)/m,S=V*m,F=E*m,d=Math.atan2(V,E)*l.MathUtils.radDeg):(E=0,V=0,d=90-Math.atan2(F,S)*l.MathUtils.radDeg);var x=n+f-d,I=n+c-d+90,o=l.MathUtils.cosDeg(x)*r,u=l.MathUtils.cosDeg(I)*a,p=l.MathUtils.sinDeg(x)*r,v=l.MathUtils.sinDeg(I)*a;this.a=E*o-S*p,this.b=E*u-S*v,this.c=V*o+F*p,this.d=V*u+F*v;break}case l.TransformMode.NoScale:case l.TransformMode.NoScaleOrReflection:{var g=l.MathUtils.cosDeg(n),D=l.MathUtils.sinDeg(n),T=E*g+S*D,R=V*g+F*D,m=Math.sqrt(T*T+R*R);m>1e-5&&(m=1/m),T*=m,R*=m,m=Math.sqrt(T*T+R*R);var k=Math.PI/2+Math.atan2(R,T),C=Math.cos(k)*m,A=Math.sin(k)*m,o=l.MathUtils.cosDeg(f)*r,u=l.MathUtils.cosDeg(90+c)*a,p=l.MathUtils.sinDeg(f)*r,v=l.MathUtils.sinDeg(90+c)*a;this.a=T*o+C*p,this.b=T*u+C*v,this.c=R*o+A*p,this.d=R*u+A*v,(this.data.transformMode!=l.TransformMode.NoScaleOrReflection?E*F-S*V<0:this.skeleton.flipX!=this.skeleton.flipY)&&(this.b=-this.b,this.d=-this.d);return}}this.skeleton.flipX&&(this.a=-this.a,this.b=-this.b),this.skeleton.flipY&&(this.c=-this.c,this.d=-this.d)},M.prototype.setToSetupPose=function(){var i=this.data;this.x=i.x,this.y=i.y,this.rotation=i.rotation,this.scaleX=i.scaleX,this.scaleY=i.scaleY,this.shearX=i.shearX,this.shearY=i.shearY},M.prototype.getWorldRotationX=function(){return Math.atan2(this.c,this.a)*l.MathUtils.radDeg},M.prototype.getWorldRotationY=function(){return Math.atan2(this.d,this.b)*l.MathUtils.radDeg},M.prototype.getWorldScaleX=function(){return Math.sqrt(this.a*this.a+this.c*this.c)},M.prototype.getWorldScaleY=function(){return Math.sqrt(this.b*this.b+this.d*this.d)},M.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var i=this.parent;if(i==null){this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*l.MathUtils.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*l.MathUtils.radDeg;return}var t=i.a,n=i.b,r=i.c,a=i.d,f=1/(t*a-n*r),c=this.worldX-i.worldX,h=this.worldY-i.worldY;this.ax=c*a*f-h*n*f,this.ay=h*t*f-c*r*f;var s=f*a,o=f*t,u=f*n,p=f*r,v=s*this.a-u*this.c,y=s*this.b-u*this.d,E=o*this.c-p*this.a,S=o*this.d-p*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(v*v+E*E),this.ascaleX>1e-4){var V=v*S-y*E;this.ascaleY=V/this.ascaleX,this.ashearY=Math.atan2(v*y+E*S,V)*l.MathUtils.radDeg,this.arotation=Math.atan2(E,v)*l.MathUtils.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(y*y+S*S),this.ashearY=0,this.arotation=90-Math.atan2(S,y)*l.MathUtils.radDeg},M.prototype.worldToLocal=function(i){var t=this.a,n=this.b,r=this.c,a=this.d,f=1/(t*a-n*r),c=i.x-this.worldX,h=i.y-this.worldY;return i.x=c*a*f-h*n*f,i.y=h*t*f-c*r*f,i},M.prototype.localToWorld=function(i){var t=i.x,n=i.y;return i.x=t*this.a+n*this.b+this.worldX,i.y=t*this.c+n*this.d+this.worldY,i},M.prototype.worldToLocalRotation=function(i){var t=l.MathUtils.sinDeg(i),n=l.MathUtils.cosDeg(i);return Math.atan2(this.a*t-this.c*n,this.d*n-this.b*t)*l.MathUtils.radDeg},M.prototype.localToWorldRotation=function(i){var t=l.MathUtils.sinDeg(i),n=l.MathUtils.cosDeg(i);return Math.atan2(n*this.c+t*this.d,n*this.a+t*this.b)*l.MathUtils.radDeg},M.prototype.rotateWorld=function(i){var t=this.a,n=this.b,r=this.c,a=this.d,f=l.MathUtils.cosDeg(i),c=l.MathUtils.sinDeg(i);this.a=f*t-c*r,this.b=f*n-c*a,this.c=c*t+f*r,this.d=c*n+f*a,this.appliedValid=!1},M}();l.Bone=e})(N||(N={}));var N;(function(l){var e=function(){function i(t,n,r){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=M.Normal,t<0)throw new Error("index must be >= 0.");if(n==null)throw new Error("name cannot be null.");this.index=t,this.name=n,this.parent=r}return i}();l.BoneData=e,function(i){i[i.Normal=0]="Normal",i[i.OnlyTranslation=1]="OnlyTranslation",i[i.NoRotationOrReflection=2]="NoRotationOrReflection",i[i.NoScale=3]="NoScale",i[i.NoScaleOrReflection=4]="NoScaleOrReflection"}(l.TransformMode||(l.TransformMode={}));var M=l.TransformMode})(N||(N={}));var N;(function(l){var e=function(){function M(i,t){if(t==null)throw new Error("data cannot be null.");this.time=i,this.data=t}return M}();l.Event=e})(N||(N={}));var N;(function(l){var e=function(){function M(i){this.name=i}return M}();l.EventData=e})(N||(N={}));var N;(function(l){var e=function(){function M(i,t){if(this.mix=1,this.bendDirection=0,i==null)throw new Error("data cannot be null.");if(t==null)throw new Error("skeleton cannot be null.");this.data=i,this.mix=i.mix,this.bendDirection=i.bendDirection,this.bones=new Array;for(var n=0;n<i.bones.length;n++)this.bones.push(t.findBone(i.bones[n].name));this.target=t.findBone(i.target.name)}return M.prototype.getOrder=function(){return this.data.order},M.prototype.apply=function(){this.update()},M.prototype.update=function(){var i=this.target,t=this.bones;switch(t.length){case 1:this.apply1(t[0],i.worldX,i.worldY,this.mix);break;case 2:this.apply2(t[0],t[1],i.worldX,i.worldY,this.bendDirection,this.mix);break}},M.prototype.apply1=function(i,t,n,r){i.appliedValid||i.updateAppliedTransform();var a=i.parent,f=1/(a.a*a.d-a.b*a.c),c=t-a.worldX,h=n-a.worldY,s=(c*a.d-h*a.b)*f-i.ax,o=(h*a.a-c*a.c)*f-i.ay,u=Math.atan2(o,s)*l.MathUtils.radDeg-i.ashearX-i.arotation;i.ascaleX<0&&(u+=180),u>180?u-=360:u<-180&&(u+=360),i.updateWorldTransformWith(i.ax,i.ay,i.arotation+u*r,i.ascaleX,i.ascaleY,i.ashearX,i.ashearY)},M.prototype.apply2=function(i,t,n,r,a,f){if(f==0){t.updateWorldTransform();return}i.appliedValid||i.updateAppliedTransform(),t.appliedValid||t.updateAppliedTransform();var c=i.ax,h=i.ay,s=i.ascaleX,o=i.ascaleY,u=t.ascaleX,p=0,v=0,y=0;s<0?(s=-s,p=180,y=-1):(p=0,y=1),o<0&&(o=-o,y=-y),u<0?(u=-u,v=180):v=0;var E=t.ax,S=0,V=0,F=0,m=i.a,d=i.b,x=i.c,I=i.d,g=Math.abs(s-o)<=1e-4;g?(S=t.ay,V=m*E+d*S+i.worldX,F=x*E+I*S+i.worldY):(S=0,V=m*E+i.worldX,F=x*E+i.worldY);var D=i.parent;m=D.a,d=D.b,x=D.c,I=D.d;var T=1/(m*I-d*x),R=n-D.worldX,k=r-D.worldY,C=(R*I-k*d)*T-c,A=(k*m-R*x)*T-h;R=V-D.worldX,k=F-D.worldY;var L=(R*I-k*d)*T-c,P=(k*m-R*x)*T-h,B=Math.sqrt(L*L+P*P),_=t.data.length*u,W=0,U=0;t:if(g){_*=s;var Y=(C*C+A*A-B*B-_*_)/(2*B*_);Y<-1?Y=-1:Y>1&&(Y=1),U=Math.acos(Y)*a,m=B+_*Y,d=_*Math.sin(U),W=Math.atan2(A*m-C*d,C*m+A*d)}else{m=s*_,d=o*_;var G=m*m,X=d*d,H=C*C+A*A,O=Math.atan2(A,C);x=X*B*B+G*H-G*X;var q=-2*X*B,z=X-G;if(I=q*q-4*z*x,I>=0){var J=Math.sqrt(I);q<0&&(J=-J),J=-(q+J)/2;var Q=J/z,K=x/J,w=Math.abs(Q)<Math.abs(K)?Q:K;if(w*w<=H){k=Math.sqrt(H-w*w)*a,W=O-Math.atan2(k,w),U=Math.atan2(k/o,(w-B)/s);break t}}var b=l.MathUtils.PI,et=B-m,tt=et*et,st=0,ot=0,rt=B+m,nt=rt*rt,it=0;x=-m*B/(G-X),x>=-1&&x<=1&&(x=Math.acos(x),R=m*Math.cos(x)+B,k=d*Math.sin(x),I=R*R+k*k,I<tt&&(b=x,tt=I,et=R,st=k),I>nt&&(ot=x,nt=I,rt=R,it=k)),H<=(tt+nt)/2?(W=O-Math.atan2(st*a,et),U=b*a):(W=O-Math.atan2(it*a,rt),U=ot*a)}var yt=Math.atan2(S,E)*y,lt=i.arotation;W=(W-yt)*l.MathUtils.radDeg+p-lt,W>180?W-=360:W<-180&&(W+=360),i.updateWorldTransformWith(c,h,lt+W*f,i.ascaleX,i.ascaleY,0,0),lt=t.arotation,U=((U+yt)*l.MathUtils.radDeg-t.ashearX)*y+v-lt,U>180?U-=360:U<-180&&(U+=360),t.updateWorldTransformWith(E,S,lt+U*f,t.ascaleX,t.ascaleY,t.ashearX,t.ashearY)},M}();l.IkConstraint=e})(N||(N={}));var N;(function(l){var e=function(){function M(i){this.order=0,this.bones=new Array,this.bendDirection=1,this.mix=1,this.name=i}return M}();l.IkConstraintData=e})(N||(N={}));var N;(function(l){var e=function(){function M(i,t){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,i==null)throw new Error("data cannot be null.");if(t==null)throw new Error("skeleton cannot be null.");this.data=i,this.bones=new Array;for(var n=0,r=i.bones.length;n<r;n++)this.bones.push(t.findBone(i.bones[n].name));this.target=t.findSlot(i.target.name),this.position=i.position,this.spacing=i.spacing,this.rotateMix=i.rotateMix,this.translateMix=i.translateMix}return M.prototype.apply=function(){this.update()},M.prototype.update=function(){var i=this.target.getAttachment();if(i instanceof l.PathAttachment){var t=this.rotateMix,n=this.translateMix,r=n>0,a=t>0;if(!(!r&&!a)){var f=this.data,c=f.spacingMode,h=c==l.SpacingMode.Length,s=f.rotateMode,o=s==l.RotateMode.Tangent,u=s==l.RotateMode.ChainScale,p=this.bones.length,v=o?p:p+1,y=this.bones,E=l.Utils.setArraySize(this.spaces,v),S=null,V=this.spacing;if(u||h){u&&(S=l.Utils.setArraySize(this.lengths,p));for(var F=0,m=v-1;F<m;){var d=y[F],x=d.data.length,I=x*d.a,g=x*d.c,D=Math.sqrt(I*I+g*g);u&&(S[F]=D),E[++F]=(h?x+V:V)*D/x}}else for(var F=1;F<v;F++)E[F]=V;var T=this.computeWorldPositions(i,v,o,f.positionMode==l.PositionMode.Percent,c==l.SpacingMode.Percent),R=T[0],k=T[1],C=f.offsetRotation,A=!1;if(C==0)A=s==l.RotateMode.Chain;else{A=!1;var L=this.target.bone;C*=L.a*L.d-L.b*L.c>0?l.MathUtils.degRad:-l.MathUtils.degRad}for(var F=0,L=3;F<p;F++,L+=3){var d=y[F];d.worldX+=(R-d.worldX)*n,d.worldY+=(k-d.worldY)*n;var I=T[L],g=T[L+1],P=I-R,B=g-k;if(u){var _=S[F];if(_!=0){var W=(Math.sqrt(P*P+B*B)/_-1)*t+1;d.a*=W,d.c*=W}}if(R=I,k=g,a){var U=d.a,Y=d.b,G=d.c,X=d.d,H=0,O=0,q=0;if(o?H=T[L-1]:E[F+1]==0?H=T[L+2]:H=Math.atan2(B,P),H-=Math.atan2(G,U),A){O=Math.cos(H),q=Math.sin(H);var z=d.data.length;R+=(z*(O*U-q*G)-P)*t,k+=(z*(q*U+O*G)-B)*t}else H+=C;H>l.MathUtils.PI?H-=l.MathUtils.PI2:H<-l.MathUtils.PI&&(H+=l.MathUtils.PI2),H*=t,O=Math.cos(H),q=Math.sin(H),d.a=O*U-q*G,d.b=O*Y-q*X,d.c=q*U+O*G,d.d=q*Y+O*X}d.appliedValid=!1}}}},M.prototype.computeWorldPositions=function(i,t,n,r,a){var f=this.target,c=this.position,h=this.spaces,s=l.Utils.setArraySize(this.positions,t*3+2),o=null,u=i.closed,p=i.worldVerticesLength,v=p/6,y=M.NONE;if(!i.constantSpeed){var E=i.lengths;v-=u?1:2;var S=E[v];if(r&&(c*=S),a)for(var V=0;V<t;V++)h[V]*=S;o=l.Utils.setArraySize(this.world,8);for(var V=0,F=0,m=0;V<t;V++,F+=3){var d=h[V];c+=d;var x=c;if(u)x%=S,x<0&&(x+=S),m=0;else if(x<0){y!=M.BEFORE&&(y=M.BEFORE,i.computeWorldVertices(f,2,4,o,0,2)),this.addBeforePosition(x,o,0,s,F);continue}else if(x>S){y!=M.AFTER&&(y=M.AFTER,i.computeWorldVertices(f,p-6,4,o,0,2)),this.addAfterPosition(x-S,o,0,s,F);continue}for(;;m++){var I=E[m];if(!(x>I)){if(m==0)x/=I;else{var g=E[m-1];x=(x-g)/(I-g)}break}}m!=y&&(y=m,u&&m==v?(i.computeWorldVertices(f,p-4,4,o,0,2),i.computeWorldVertices(f,0,4,o,4,2)):i.computeWorldVertices(f,m*6+2,8,o,0,2)),this.addCurvePosition(x,o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],s,F,n||V>0&&d==0)}return s}u?(p+=2,o=l.Utils.setArraySize(this.world,p),i.computeWorldVertices(f,2,p-4,o,0,2),i.computeWorldVertices(f,0,2,o,p-4,2),o[p-2]=o[0],o[p-1]=o[1]):(v--,p-=4,o=l.Utils.setArraySize(this.world,p),i.computeWorldVertices(f,2,p,o,0,2));for(var D=l.Utils.setArraySize(this.curves,v),T=0,R=o[0],k=o[1],C=0,A=0,L=0,P=0,B=0,_=0,W=0,U=0,Y=0,G=0,X=0,H=0,O=0,q=0,V=0,z=2;V<v;V++,z+=6)C=o[z],A=o[z+1],L=o[z+2],P=o[z+3],B=o[z+4],_=o[z+5],W=(R-C*2+L)*.1875,U=(k-A*2+P)*.1875,Y=((C-L)*3-R+B)*.09375,G=((A-P)*3-k+_)*.09375,X=W*2+Y,H=U*2+G,O=(C-R)*.75+W+Y*.16666667,q=(A-k)*.75+U+G*.16666667,T+=Math.sqrt(O*O+q*q),O+=X,q+=H,X+=Y,H+=G,T+=Math.sqrt(O*O+q*q),O+=X,q+=H,T+=Math.sqrt(O*O+q*q),O+=X+Y,q+=H+G,T+=Math.sqrt(O*O+q*q),D[V]=T,R=B,k=_;if(r&&(c*=T),a)for(var V=0;V<t;V++)h[V]*=T;for(var J=this.segments,Q=0,V=0,F=0,m=0,K=0;V<t;V++,F+=3){var d=h[V];c+=d;var x=c;if(u)x%=T,x<0&&(x+=T),m=0;else if(x<0){this.addBeforePosition(x,o,0,s,F);continue}else if(x>T){this.addAfterPosition(x-T,o,p-4,s,F);continue}for(;;m++){var w=D[m];if(!(x>w)){if(m==0)x/=w;else{var g=D[m-1];x=(x-g)/(w-g)}break}}if(m!=y){y=m;var b=m*6;for(R=o[b],k=o[b+1],C=o[b+2],A=o[b+3],L=o[b+4],P=o[b+5],B=o[b+6],_=o[b+7],W=(R-C*2+L)*.03,U=(k-A*2+P)*.03,Y=((C-L)*3-R+B)*.006,G=((A-P)*3-k+_)*.006,X=W*2+Y,H=U*2+G,O=(C-R)*.3+W+Y*.16666667,q=(A-k)*.3+U+G*.16666667,Q=Math.sqrt(O*O+q*q),J[0]=Q,b=1;b<8;b++)O+=X,q+=H,X+=Y,H+=G,Q+=Math.sqrt(O*O+q*q),J[b]=Q;O+=X,q+=H,Q+=Math.sqrt(O*O+q*q),J[8]=Q,O+=X+Y,q+=H+G,Q+=Math.sqrt(O*O+q*q),J[9]=Q,K=0}for(x*=Q;;K++){var et=J[K];if(!(x>et)){if(K==0)x/=et;else{var g=J[K-1];x=K+(x-g)/(et-g)}break}}this.addCurvePosition(x*.1,R,k,C,A,L,P,B,_,s,F,n||V>0&&d==0)}return s},M.prototype.addBeforePosition=function(i,t,n,r,a){var f=t[n],c=t[n+1],h=t[n+2]-f,s=t[n+3]-c,o=Math.atan2(s,h);r[a]=f+i*Math.cos(o),r[a+1]=c+i*Math.sin(o),r[a+2]=o},M.prototype.addAfterPosition=function(i,t,n,r,a){var f=t[n+2],c=t[n+3],h=f-t[n],s=c-t[n+1],o=Math.atan2(s,h);r[a]=f+i*Math.cos(o),r[a+1]=c+i*Math.sin(o),r[a+2]=o},M.prototype.addCurvePosition=function(i,t,n,r,a,f,c,h,s,o,u,p){(i==0||isNaN(i))&&(i=1e-4);var v=i*i,y=v*i,E=1-i,S=E*E,V=S*E,F=E*i,m=F*3,d=E*m,x=m*i,I=t*V+r*d+f*x+h*y,g=n*V+a*d+c*x+s*y;o[u]=I,o[u+1]=g,p&&(o[u+2]=Math.atan2(g-(n*S+a*F*2+c*v),I-(t*S+r*F*2+f*v)))},M.prototype.getOrder=function(){return this.data.order},M.NONE=-1,M.BEFORE=-2,M.AFTER=-3,M}();l.PathConstraint=e})(N||(N={}));var N;(function(l){var e=function(){function M(i){this.order=0,this.bones=new Array,this.name=i}return M}();l.PathConstraintData=e,function(M){M[M.Fixed=0]="Fixed",M[M.Percent=1]="Percent"}(l.PositionMode||(l.PositionMode={})),l.PositionMode,function(M){M[M.Length=0]="Length",M[M.Fixed=1]="Fixed",M[M.Percent=2]="Percent"}(l.SpacingMode||(l.SpacingMode={})),l.SpacingMode,function(M){M[M.Tangent=0]="Tangent",M[M.Chain=1]="Chain",M[M.ChainScale=2]="ChainScale"}(l.RotateMode||(l.RotateMode={})),l.RotateMode})(N||(N={}));var N;(function(l){var e=function(){function i(t){this.toLoad=new Array,this.assets={},this.clientId=t}return i.prototype.loaded=function(){var t=0;for(var n in this.assets)t++;return t},i}(),M=function(){function i(t){t===void 0&&(t=""),this.clientAssets={},this.queuedAssets={},this.rawAssets={},this.errors={},this.pathPrefix=t}return i.prototype.queueAsset=function(t,n,r){var a=this.clientAssets[t];return a==null&&(a=new e(t),this.clientAssets[t]=a),n!==null&&(a.textureLoader=n),a.toLoad.push(r),this.queuedAssets[r]===r?!1:(this.queuedAssets[r]=r,!0)},i.prototype.loadText=function(t,n){var r=this;if(n=this.pathPrefix+n,!!this.queueAsset(t,null,n)){var a=new XMLHttpRequest;a.onreadystatechange=function(){a.readyState==XMLHttpRequest.DONE&&(a.status>=200&&a.status<300?r.rawAssets[n]=a.responseText:r.errors[n]="Couldn't load text "+n+": status "+a.status+", "+a.responseText)},a.open("GET",n,!0),a.send()}},i.prototype.loadJson=function(t,n){var r=this;if(n=this.pathPrefix+n,!!this.queueAsset(t,null,n)){var a=new XMLHttpRequest;a.onreadystatechange=function(){a.readyState==XMLHttpRequest.DONE&&(a.status>=200&&a.status<300?r.rawAssets[n]=JSON.parse(a.responseText):r.errors[n]="Couldn't load text "+n+": status "+a.status+", "+a.responseText)},a.open("GET",n,!0),a.send()}},i.prototype.loadTexture=function(t,n,r){var a=this;if(r=this.pathPrefix+r,!!this.queueAsset(t,n,r)){var f=new Image;f.src=r,f.crossOrigin="anonymous",f.onload=function(c){a.rawAssets[r]=f},f.onerror=function(c){a.errors[r]="Couldn't load image "+r}}},i.prototype.get=function(t,n){n=this.pathPrefix+n;var r=this.clientAssets[t];return r==null?!0:r.assets[n]},i.prototype.updateClientAssets=function(t){for(var n=0;n<t.toLoad.length;n++){var r=t.toLoad[n],a=t.assets[r];if(a==null){var f=this.rawAssets[r];if(f==null)continue;f instanceof HTMLImageElement?t.assets[r]=t.textureLoader(f):t.assets[r]=f}}},i.prototype.isLoadingComplete=function(t){var n=this.clientAssets[t];return n==null?!0:(this.updateClientAssets(n),n.toLoad.length==n.loaded())},i.prototype.dispose=function(){},i.prototype.hasErrors=function(){return Object.keys(this.errors).length>0},i.prototype.getErrors=function(){return this.errors},i}();l.SharedAssetManager=M})(N||(N={}));var N;(function(l){var e=function(){function M(i){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.flipX=!1,this.flipY=!1,this.x=0,this.y=0,i==null)throw new Error("data cannot be null.");this.data=i,this.bones=new Array;for(var t=0;t<i.bones.length;t++){var n=i.bones[t],r=void 0;if(n.parent==null)r=new l.Bone(n,this,null);else{var a=this.bones[n.parent.index];r=new l.Bone(n,this,a),a.children.push(r)}this.bones.push(r)}this.slots=new Array,this.drawOrder=new Array;for(var t=0;t<i.slots.length;t++){var f=i.slots[t],r=this.bones[f.boneData.index],c=new l.Slot(f,r);this.slots.push(c),this.drawOrder.push(c)}this.ikConstraints=new Array;for(var t=0;t<i.ikConstraints.length;t++){var h=i.ikConstraints[t];this.ikConstraints.push(new l.IkConstraint(h,this))}this.transformConstraints=new Array;for(var t=0;t<i.transformConstraints.length;t++){var s=i.transformConstraints[t];this.transformConstraints.push(new l.TransformConstraint(s,this))}this.pathConstraints=new Array;for(var t=0;t<i.pathConstraints.length;t++){var o=i.pathConstraints[t];this.pathConstraints.push(new l.PathConstraint(o,this))}this.color=new l.Color(1,1,1,1),this.updateCache()}return M.prototype.updateCache=function(){var i=this._updateCache;i.length=0,this.updateCacheReset.length=0;for(var t=this.bones,n=0,r=t.length;n<r;n++)t[n].sorted=!1;var a=this.ikConstraints,f=this.transformConstraints,c=this.pathConstraints,h=a.length,s=f.length,o=c.length,u=h+s+o;t:for(var n=0;n<u;n++){for(var p=0;p<h;p++){var v=a[p];if(v.data.order==n){this.sortIkConstraint(v);continue t}}for(var p=0;p<s;p++){var v=f[p];if(v.data.order==n){this.sortTransformConstraint(v);continue t}}for(var p=0;p<o;p++){var v=c[p];if(v.data.order==n){this.sortPathConstraint(v);continue t}}}for(var n=0,r=t.length;n<r;n++)this.sortBone(t[n])},M.prototype.sortIkConstraint=function(i){var t=i.target;this.sortBone(t);var n=i.bones,r=n[0];if(this.sortBone(r),n.length>1){var a=n[n.length-1];this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}this._updateCache.push(i),this.sortReset(r.children),n[n.length-1].sorted=!0},M.prototype.sortPathConstraint=function(i){var t=i.target,n=t.data.index,r=t.bone;this.skin!=null&&this.sortPathConstraintAttachment(this.skin,n,r),this.data.defaultSkin!=null&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,r);for(var a=0,f=this.data.skins.length;a<f;a++)this.sortPathConstraintAttachment(this.data.skins[a],n,r);var c=t.getAttachment();c instanceof l.PathAttachment&&this.sortPathConstraintAttachmentWith(c,r);for(var h=i.bones,s=h.length,a=0;a<s;a++)this.sortBone(h[a]);this._updateCache.push(i);for(var a=0;a<s;a++)this.sortReset(h[a].children);for(var a=0;a<s;a++)h[a].sorted=!0},M.prototype.sortTransformConstraint=function(i){this.sortBone(i.target);var t=i.bones,n=t.length;if(i.data.local)for(var r=0;r<n;r++){var a=t[r];this.sortBone(a.parent),this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}else for(var r=0;r<n;r++)this.sortBone(t[r]);this._updateCache.push(i);for(var f=0;f<n;f++)this.sortReset(t[f].children);for(var f=0;f<n;f++)t[f].sorted=!0},M.prototype.sortPathConstraintAttachment=function(i,t,n){var r=i.attachments[t];if(!!r)for(var a in r)this.sortPathConstraintAttachmentWith(r[a],n)},M.prototype.sortPathConstraintAttachmentWith=function(i,t){if(i instanceof l.PathAttachment){var n=i.bones;if(n==null)this.sortBone(t);else for(var r=this.bones,a=0;a<n.length;)for(var f=n[a++],c=a+f;a<c;a++){var h=n[a];this.sortBone(r[h])}}},M.prototype.sortBone=function(i){if(!i.sorted){var t=i.parent;t!=null&&this.sortBone(t),i.sorted=!0,this._updateCache.push(i)}},M.prototype.sortReset=function(i){for(var t=0,n=i.length;t<n;t++){var r=i[t];r.sorted&&this.sortReset(r.children),r.sorted=!1}},M.prototype.updateWorldTransform=function(){for(var i=this.updateCacheReset,t=0,n=i.length;t<n;t++){var r=i[t];r.ax=r.x,r.ay=r.y,r.arotation=r.rotation,r.ascaleX=r.scaleX,r.ascaleY=r.scaleY,r.ashearX=r.shearX,r.ashearY=r.shearY,r.appliedValid=!0}for(var a=this._updateCache,t=0,n=a.length;t<n;t++)a[t].update()},M.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},M.prototype.setBonesToSetupPose=function(){for(var i=this.bones,t=0,n=i.length;t<n;t++)i[t].setToSetupPose();for(var r=this.ikConstraints,t=0,n=r.length;t<n;t++){var a=r[t];a.bendDirection=a.data.bendDirection,a.mix=a.data.mix}for(var f=this.transformConstraints,t=0,n=f.length;t<n;t++){var a=f[t],c=a.data;a.rotateMix=c.rotateMix,a.translateMix=c.translateMix,a.scaleMix=c.scaleMix,a.shearMix=c.shearMix}for(var h=this.pathConstraints,t=0,n=h.length;t<n;t++){var a=h[t],c=a.data;a.position=c.position,a.spacing=c.spacing,a.rotateMix=c.rotateMix,a.translateMix=c.translateMix}},M.prototype.setSlotsToSetupPose=function(){var i=this.slots;l.Utils.arrayCopy(i,0,this.drawOrder,0,i.length);for(var t=0,n=i.length;t<n;t++)i[t].setToSetupPose()},M.prototype.getRootBone=function(){return this.bones.length==0?null:this.bones[0]},M.prototype.findBone=function(i){if(i==null)throw new Error("boneName cannot be null.");for(var t=this.bones,n=0,r=t.length;n<r;n++){var a=t[n];if(a.data.name==i)return a}return null},M.prototype.findBoneIndex=function(i){if(i==null)throw new Error("boneName cannot be null.");for(var t=this.bones,n=0,r=t.length;n<r;n++)if(t[n].data.name==i)return n;return-1},M.prototype.findSlot=function(i){if(i==null)throw new Error("slotName cannot be null.");for(var t=this.slots,n=0,r=t.length;n<r;n++){var a=t[n];if(a.data.name==i)return a}return null},M.prototype.findSlotIndex=function(i){if(i==null)throw new Error("slotName cannot be null.");for(var t=this.slots,n=0,r=t.length;n<r;n++)if(t[n].data.name==i)return n;return-1},M.prototype.setSkinByName=function(i){var t=this.data.findSkin(i);if(t==null)throw new Error("Skin not found: "+i);this.setSkin(t)},M.prototype.setSkin=function(i){if(i!=null)if(this.skin!=null)i.attachAll(this,this.skin);else for(var t=this.slots,n=0,r=t.length;n<r;n++){var a=t[n],f=a.data.attachmentName;if(f!=null){var c=i.getAttachment(n,f);c!=null&&a.setAttachment(c)}}this.skin=i},M.prototype.getAttachmentByName=function(i,t){return this.getAttachment(this.data.findSlotIndex(i),t)},M.prototype.getAttachment=function(i,t){if(t==null)throw new Error("attachmentName cannot be null.");if(this.skin!=null){var n=this.skin.getAttachment(i,t);if(n!=null)return n}return this.data.defaultSkin!=null?this.data.defaultSkin.getAttachment(i,t):null},M.prototype.setAttachment=function(i,t){if(i==null)throw new Error("slotName cannot be null.");for(var n=this.slots,r=0,a=n.length;r<a;r++){var f=n[r];if(f.data.name==i){var c=null;if(t!=null&&(c=this.getAttachment(r,t),c==null))throw new Error("Attachment not found: "+t+", for slot: "+i);f.setAttachment(c);return}}throw new Error("Slot not found: "+i)},M.prototype.findIkConstraint=function(i){if(i==null)throw new Error("constraintName cannot be null.");for(var t=this.ikConstraints,n=0,r=t.length;n<r;n++){var a=t[n];if(a.data.name==i)return a}return null},M.prototype.findTransformConstraint=function(i){if(i==null)throw new Error("constraintName cannot be null.");for(var t=this.transformConstraints,n=0,r=t.length;n<r;n++){var a=t[n];if(a.data.name==i)return a}return null},M.prototype.findPathConstraint=function(i){if(i==null)throw new Error("constraintName cannot be null.");for(var t=this.pathConstraints,n=0,r=t.length;n<r;n++){var a=t[n];if(a.data.name==i)return a}return null},M.prototype.getBounds=function(i,t,n){if(i==null)throw new Error("offset cannot be null.");if(t==null)throw new Error("size cannot be null.");for(var r=this.drawOrder,a=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,s=0,o=r.length;s<o;s++){var u=r[s],p=0,v=null,y=u.getAttachment();if(y instanceof l.RegionAttachment)p=8,v=l.Utils.setArraySize(n,p,0),y.computeWorldVertices(u.bone,v,0,2);else if(y instanceof l.MeshAttachment){var E=y;p=E.worldVerticesLength,v=l.Utils.setArraySize(n,p,0),E.computeWorldVertices(u,0,p,v,0,2)}if(v!=null)for(var S=0,V=v.length;S<V;S+=2){var F=v[S],m=v[S+1];a=Math.min(a,F),f=Math.min(f,m),c=Math.max(c,F),h=Math.max(h,m)}}i.set(a,f),t.set(c-a,h-f)},M.prototype.update=function(i){this.time+=i},M}();l.Skeleton=e})(N||(N={}));var N;(function(l){var e=function(){function M(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new l.Pool(function(){return l.Utils.newFloatArray(16)})}return M.prototype.update=function(i,t){if(i==null)throw new Error("skeleton cannot be null.");var n=this.boundingBoxes,r=this.polygons,a=this.polygonPool,f=i.slots,c=f.length;n.length=0,a.freeAll(r),r.length=0;for(var h=0;h<c;h++){var s=f[h],o=s.getAttachment();if(o instanceof l.BoundingBoxAttachment){var u=o;n.push(u);var p=a.obtain();p.length!=u.worldVerticesLength&&(p=l.Utils.newFloatArray(u.worldVerticesLength)),r.push(p),u.computeWorldVertices(s,0,u.worldVerticesLength,p,0,2)}}t?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},M.prototype.aabbCompute=function(){for(var i=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY,a=this.polygons,f=0,c=a.length;f<c;f++)for(var h=a[f],s=h,o=0,u=h.length;o<u;o+=2){var p=s[o],v=s[o+1];i=Math.min(i,p),t=Math.min(t,v),n=Math.max(n,p),r=Math.max(r,v)}this.minX=i,this.minY=t,this.maxX=n,this.maxY=r},M.prototype.aabbContainsPoint=function(i,t){return i>=this.minX&&i<=this.maxX&&t>=this.minY&&t<=this.maxY},M.prototype.aabbIntersectsSegment=function(i,t,n,r){var a=this.minX,f=this.minY,c=this.maxX,h=this.maxY;if(i<=a&&n<=a||t<=f&&r<=f||i>=c&&n>=c||t>=h&&r>=h)return!1;var s=(r-t)/(n-i),o=s*(a-i)+t;if(o>f&&o<h||(o=s*(c-i)+t,o>f&&o<h))return!0;var u=(f-t)/s+i;return!!(u>a&&u<c||(u=(h-t)/s+i,u>a&&u<c))},M.prototype.aabbIntersectsSkeleton=function(i){return this.minX<i.maxX&&this.maxX>i.minX&&this.minY<i.maxY&&this.maxY>i.minY},M.prototype.containsPoint=function(i,t){for(var n=this.polygons,r=0,a=n.length;r<a;r++)if(this.containsPointPolygon(n[r],i,t))return this.boundingBoxes[r];return null},M.prototype.containsPointPolygon=function(i,t,n){for(var r=i,a=i.length,f=a-2,c=!1,h=0;h<a;h+=2){var s=r[h+1],o=r[f+1];if(s<n&&o>=n||o<n&&s>=n){var u=r[h];u+(n-s)/(o-s)*(r[f]-u)<t&&(c=!c)}f=h}return c},M.prototype.intersectsSegment=function(i,t,n,r){for(var a=this.polygons,f=0,c=a.length;f<c;f++)if(this.intersectsSegmentPolygon(a[f],i,t,n,r))return this.boundingBoxes[f];return null},M.prototype.intersectsSegmentPolygon=function(i,t,n,r,a){for(var f=i,c=i.length,h=t-r,s=n-a,o=t*a-n*r,u=f[c-2],p=f[c-1],v=0;v<c;v+=2){var y=f[v],E=f[v+1],S=u*E-p*y,V=u-y,F=p-E,m=h*F-s*V,d=(o*V-h*S)/m;if((d>=u&&d<=y||d>=y&&d<=u)&&(d>=t&&d<=r||d>=r&&d<=t)){var x=(o*F-s*S)/m;if((x>=p&&x<=E||x>=E&&x<=p)&&(x>=n&&x<=a||x>=a&&x<=n))return!0}u=y,p=E}return!1},M.prototype.getPolygon=function(i){if(i==null)throw new Error("boundingBox cannot be null.");var t=this.boundingBoxes.indexOf(i);return t==-1?null:this.polygons[t]},M.prototype.getWidth=function(){return this.maxX-this.minX},M.prototype.getHeight=function(){return this.maxY-this.minY},M}();l.SkeletonBounds=e})(N||(N={}));var N;(function(l){var e=function(){function M(){this.triangulator=new l.Triangulator,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}return M.prototype.clipStart=function(i,t){if(this.clipAttachment!=null)return 0;this.clipAttachment=t;var n=t.worldVerticesLength,r=l.Utils.setArraySize(this.clippingPolygon,n);t.computeWorldVertices(i,0,n,r,0,2);var a=this.clippingPolygon;M.makeClockwise(a);for(var f=this.clippingPolygons=this.triangulator.decompose(a,this.triangulator.triangulate(a)),c=0,h=f.length;c<h;c++){var s=f[c];M.makeClockwise(s),s.push(s[0]),s.push(s[1])}return f.length},M.prototype.clipEndWithSlot=function(i){this.clipAttachment!=null&&this.clipAttachment.endSlot==i.data&&this.clipEnd()},M.prototype.clipEnd=function(){this.clipAttachment!=null&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},M.prototype.isClipping=function(){return this.clipAttachment!=null},M.prototype.clipTriangles=function(i,t,n,r,a,f,c,h){var s=this.clipOutput,o=this.clippedVertices,u=this.clippedTriangles,p=this.clippingPolygons,v=this.clippingPolygons.length,y=h?12:8,E=0;o.length=0,u.length=0;t:for(var S=0;S<r;S+=3){var V=n[S]<<1,F=i[V],m=i[V+1],d=a[V],x=a[V+1];V=n[S+1]<<1;var I=i[V],g=i[V+1],D=a[V],T=a[V+1];V=n[S+2]<<1;for(var R=i[V],k=i[V+1],C=a[V],A=a[V+1],L=0;L<v;L++){var P=o.length;if(this.clip(F,m,I,g,R,k,p[L],s)){var B=s.length;if(B==0)continue;for(var _=g-k,W=R-I,U=F-R,Y=k-m,G=1/(_*U+W*(m-k)),X=B>>1,H=this.clipOutput,O=l.Utils.setArraySize(o,P+X*y),q=0;q<B;q+=2){var z=H[q],J=H[q+1];O[P]=z,O[P+1]=J,O[P+2]=f.r,O[P+3]=f.g,O[P+4]=f.b,O[P+5]=f.a;var Q=z-R,K=J-k,w=(_*Q+W*K)*G,b=(Y*Q+U*K)*G,et=1-w-b;O[P+6]=d*w+D*b+C*et,O[P+7]=x*w+T*b+A*et,h&&(O[P+8]=c.r,O[P+8]=c.g,O[P+10]=c.b,O[P+11]=c.a),P+=y}P=u.length;var tt=l.Utils.setArraySize(u,P+3*(X-2));X--;for(var q=1;q<X;q++)tt[P]=E,tt[P+1]=E+q,tt[P+2]=E+q+1,P+=3;E+=X+1}else{var O=l.Utils.setArraySize(o,P+3*y);O[P]=F,O[P+1]=m,O[P+2]=f.r,O[P+3]=f.g,O[P+4]=f.b,O[P+5]=f.a,h?(O[P+6]=d,O[P+7]=x,O[P+8]=c.r,O[P+9]=c.g,O[P+10]=c.b,O[P+11]=c.a,O[P+12]=I,O[P+13]=g,O[P+14]=f.r,O[P+15]=f.g,O[P+16]=f.b,O[P+17]=f.a,O[P+18]=D,O[P+19]=T,O[P+20]=c.r,O[P+21]=c.g,O[P+22]=c.b,O[P+23]=c.a,O[P+24]=R,O[P+25]=k,O[P+26]=f.r,O[P+27]=f.g,O[P+28]=f.b,O[P+29]=f.a,O[P+30]=C,O[P+31]=A,O[P+32]=c.r,O[P+33]=c.g,O[P+34]=c.b,O[P+35]=c.a):(O[P+6]=d,O[P+7]=x,O[P+8]=I,O[P+9]=g,O[P+10]=f.r,O[P+11]=f.g,O[P+12]=f.b,O[P+13]=f.a,O[P+14]=D,O[P+15]=T,O[P+16]=R,O[P+17]=k,O[P+18]=f.r,O[P+19]=f.g,O[P+20]=f.b,O[P+21]=f.a,O[P+22]=C,O[P+23]=A),P=u.length;var tt=l.Utils.setArraySize(u,P+3);tt[P]=E,tt[P+1]=E+1,tt[P+2]=E+2,E+=3;continue t}}}},M.prototype.clip=function(i,t,n,r,a,f,c,h){var s=h,o=!1,u=null;c.length%4>=2?(u=h,h=this.scratch):u=this.scratch,u.length=0,u.push(i),u.push(t),u.push(n),u.push(r),u.push(a),u.push(f),u.push(i),u.push(t),h.length=0;for(var p=c,v=c.length-4,y=0;;y+=2){for(var E=p[y],S=p[y+1],V=p[y+2],F=p[y+3],m=E-V,d=S-F,x=u,I=u.length-2,g=h.length,D=0;D<I;D+=2){var T=x[D],R=x[D+1],k=x[D+2],C=x[D+3],A=m*(C-F)-d*(k-V)>0;if(m*(R-F)-d*(T-V)>0){if(A){h.push(k),h.push(C);continue}var L=C-R,P=k-T,B=(P*(S-R)-L*(E-T))/(L*(V-E)-P*(F-S));h.push(E+(V-E)*B),h.push(S+(F-S)*B)}else if(A){var L=C-R,P=k-T,B=(P*(S-R)-L*(E-T))/(L*(V-E)-P*(F-S));h.push(E+(V-E)*B),h.push(S+(F-S)*B),h.push(k),h.push(C)}o=!0}if(g==h.length)return s.length=0,!0;if(h.push(h[0]),h.push(h[1]),y==v)break;var _=h;h=u,h.length=0,u=_}if(s!=h){s.length=0;for(var y=0,W=h.length-2;y<W;y++)s[y]=h[y]}else s.length=s.length-2;return o},M.makeClockwise=function(i){for(var t=i,n=i.length,r=t[n-2]*t[1]-t[0]*t[n-1],a=0,f=0,c=0,h=0,s=0,o=n-3;s<o;s+=2)a=t[s],f=t[s+1],c=t[s+2],h=t[s+3],r+=a*h-c*f;if(!(r<0))for(var s=0,u=n-2,o=n>>1;s<o;s+=2){var p=t[s],v=t[s+1],y=u-s;t[s]=t[y],t[s+1]=t[y+1],t[y]=p,t[y+1]=v}},M}();l.SkeletonClipping=e})(N||(N={}));var N;(function(l){var e=function(){function M(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}return M.prototype.findBone=function(i){if(i==null)throw new Error("boneName cannot be null.");for(var t=this.bones,n=0,r=t.length;n<r;n++){var a=t[n];if(a.name==i)return a}return null},M.prototype.findBoneIndex=function(i){if(i==null)throw new Error("boneName cannot be null.");for(var t=this.bones,n=0,r=t.length;n<r;n++)if(t[n].name==i)return n;return-1},M.prototype.findSlot=function(i){if(i==null)throw new Error("slotName cannot be null.");for(var t=this.slots,n=0,r=t.length;n<r;n++){var a=t[n];if(a.name==i)return a}return null},M.prototype.findSlotIndex=function(i){if(i==null)throw new Error("slotName cannot be null.");for(var t=this.slots,n=0,r=t.length;n<r;n++)if(t[n].name==i)return n;return-1},M.prototype.findSkin=function(i){if(i==null)throw new Error("skinName cannot be null.");for(var t=this.skins,n=0,r=t.length;n<r;n++){var a=t[n];if(a.name==i)return a}return null},M.prototype.findEvent=function(i){if(i==null)throw new Error("eventDataName cannot be null.");for(var t=this.events,n=0,r=t.length;n<r;n++){var a=t[n];if(a.name==i)return a}return null},M.prototype.findAnimation=function(i){if(i==null)throw new Error("animationName cannot be null.");for(var t=this.animations,n=0,r=t.length;n<r;n++){var a=t[n];if(a.name==i)return a}return null},M.prototype.findIkConstraint=function(i){if(i==null)throw new Error("constraintName cannot be null.");for(var t=this.ikConstraints,n=0,r=t.length;n<r;n++){var a=t[n];if(a.name==i)return a}return null},M.prototype.findTransformConstraint=function(i){if(i==null)throw new Error("constraintName cannot be null.");for(var t=this.transformConstraints,n=0,r=t.length;n<r;n++){var a=t[n];if(a.name==i)return a}return null},M.prototype.findPathConstraint=function(i){if(i==null)throw new Error("constraintName cannot be null.");for(var t=this.pathConstraints,n=0,r=t.length;n<r;n++){var a=t[n];if(a.name==i)return a}return null},M.prototype.findPathConstraintIndex=function(i){if(i==null)throw new Error("pathConstraintName cannot be null.");for(var t=this.pathConstraints,n=0,r=t.length;n<r;n++)if(t[n].name==i)return n;return-1},M}();l.SkeletonData=e})(N||(N={}));var N;(function(l){var e=function(){function i(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return i.prototype.readSkeletonData=function(t){var n=this.scale,r=new l.SkeletonData,a=typeof t=="string"?JSON.parse(t):t,f=a.skeleton;if(f!=null&&(r.hash=f.hash,r.version=f.spine,r.width=f.width,r.height=f.height,r.fps=f.fps,r.imagesPath=f.images),a.bones)for(var c=0;c<a.bones.length;c++){var h=a.bones[c],s=null,o=this.getValue(h,"parent",null);if(o!=null&&(s=r.findBone(o),s==null))throw new Error("Parent bone not found: "+o);var u=new l.BoneData(r.bones.length,h.name,s);u.length=this.getValue(h,"length",0)*n,u.x=this.getValue(h,"x",0)*n,u.y=this.getValue(h,"y",0)*n,u.rotation=this.getValue(h,"rotation",0),u.scaleX=this.getValue(h,"scaleX",1),u.scaleY=this.getValue(h,"scaleY",1),u.shearX=this.getValue(h,"shearX",0),u.shearY=this.getValue(h,"shearY",0),u.transformMode=i.transformModeFromString(this.getValue(h,"transform","normal")),r.bones.push(u)}if(a.slots)for(var c=0;c<a.slots.length;c++){var p=a.slots[c],v=p.name,y=p.bone,E=r.findBone(y);if(E==null)throw new Error("Slot bone not found: "+y);var u=new l.SlotData(r.slots.length,v,E),S=this.getValue(p,"color",null);S!=null&&u.color.setFromString(S);var V=this.getValue(p,"dark",null);V!=null&&(u.darkColor=new l.Color(1,1,1,1),u.darkColor.setFromString(V)),u.attachmentName=this.getValue(p,"attachment",null),u.blendMode=i.blendModeFromString(this.getValue(p,"blend","normal")),r.slots.push(u)}if(a.ik)for(var c=0;c<a.ik.length;c++){var F=a.ik[c],u=new l.IkConstraintData(F.name);u.order=this.getValue(F,"order",0);for(var m=0;m<F.bones.length;m++){var y=F.bones[m],d=r.findBone(y);if(d==null)throw new Error("IK bone not found: "+y);u.bones.push(d)}var x=F.target;if(u.target=r.findBone(x),u.target==null)throw new Error("IK target bone not found: "+x);u.bendDirection=this.getValue(F,"bendPositive",!0)?1:-1,u.mix=this.getValue(F,"mix",1),r.ikConstraints.push(u)}if(a.transform)for(var c=0;c<a.transform.length;c++){var F=a.transform[c],u=new l.TransformConstraintData(F.name);u.order=this.getValue(F,"order",0);for(var m=0;m<F.bones.length;m++){var y=F.bones[m],d=r.findBone(y);if(d==null)throw new Error("Transform constraint bone not found: "+y);u.bones.push(d)}var x=F.target;if(u.target=r.findBone(x),u.target==null)throw new Error("Transform constraint target bone not found: "+x);u.local=this.getValue(F,"local",!1),u.relative=this.getValue(F,"relative",!1),u.offsetRotation=this.getValue(F,"rotation",0),u.offsetX=this.getValue(F,"x",0)*n,u.offsetY=this.getValue(F,"y",0)*n,u.offsetScaleX=this.getValue(F,"scaleX",0),u.offsetScaleY=this.getValue(F,"scaleY",0),u.offsetShearY=this.getValue(F,"shearY",0),u.rotateMix=this.getValue(F,"rotateMix",1),u.translateMix=this.getValue(F,"translateMix",1),u.scaleMix=this.getValue(F,"scaleMix",1),u.shearMix=this.getValue(F,"shearMix",1),r.transformConstraints.push(u)}if(a.path)for(var c=0;c<a.path.length;c++){var F=a.path[c],u=new l.PathConstraintData(F.name);u.order=this.getValue(F,"order",0);for(var m=0;m<F.bones.length;m++){var y=F.bones[m],d=r.findBone(y);if(d==null)throw new Error("Transform constraint bone not found: "+y);u.bones.push(d)}var x=F.target;if(u.target=r.findSlot(x),u.target==null)throw new Error("Path target slot not found: "+x);u.positionMode=i.positionModeFromString(this.getValue(F,"positionMode","percent")),u.spacingMode=i.spacingModeFromString(this.getValue(F,"spacingMode","length")),u.rotateMode=i.rotateModeFromString(this.getValue(F,"rotateMode","tangent")),u.offsetRotation=this.getValue(F,"rotation",0),u.position=this.getValue(F,"position",0),u.positionMode==l.PositionMode.Fixed&&(u.position*=n),u.spacing=this.getValue(F,"spacing",0),(u.spacingMode==l.SpacingMode.Length||u.spacingMode==l.SpacingMode.Fixed)&&(u.spacing*=n),u.rotateMix=this.getValue(F,"rotateMix",1),u.translateMix=this.getValue(F,"translateMix",1),r.pathConstraints.push(u)}if(a.skins)for(var I in a.skins){var g=a.skins[I],D=new l.Skin(I);for(var v in g){var T=r.findSlotIndex(v);if(T==-1)throw new Error("Slot not found: "+v);var p=g[v];for(var R in p){var k=this.readAttachment(p[R],D,T,R,r);k!=null&&D.addAttachment(T,R,k)}}r.skins.push(D),D.name=="default"&&(r.defaultSkin=D)}for(var c=0,C=this.linkedMeshes.length;c<C;c++){var A=this.linkedMeshes[c],D=A.skin==null?r.defaultSkin:r.findSkin(A.skin);if(D==null)throw new Error("Skin not found: "+A.skin);var L=D.getAttachment(A.slotIndex,A.parent);if(L==null)throw new Error("Parent mesh not found: "+A.parent);A.mesh.setParentMesh(L),A.mesh.updateUVs()}if(this.linkedMeshes.length=0,a.events)for(var P in a.events){var B=a.events[P],u=new l.EventData(P);u.intValue=this.getValue(B,"int",0),u.floatValue=this.getValue(B,"float",0),u.stringValue=this.getValue(B,"string",""),r.events.push(u)}if(a.animations)for(var _ in a.animations){var W=a.animations[_];this.readAnimation(W,_,r)}return r},i.prototype.readAttachment=function(t,n,r,a,f){var c=this.scale;a=this.getValue(t,"name",a);var h=this.getValue(t,"type","region");switch(h){case"region":{var s=this.getValue(t,"path",a),o=this.attachmentLoader.newRegionAttachment(n,a,s);if(o==null)return null;o.path=s,o.x=this.getValue(t,"x",0)*c,o.y=this.getValue(t,"y",0)*c,o.scaleX=this.getValue(t,"scaleX",1),o.scaleY=this.getValue(t,"scaleY",1),o.rotation=this.getValue(t,"rotation",0),o.width=t.width*c,o.height=t.height*c;var u=this.getValue(t,"color",null);return u!=null&&o.color.setFromString(u),o.updateOffset(),o}case"boundingbox":{var p=this.attachmentLoader.newBoundingBoxAttachment(n,a);if(p==null)return null;this.readVertices(t,p,t.vertexCount<<1);var u=this.getValue(t,"color",null);return u!=null&&p.color.setFromString(u),p}case"mesh":case"linkedmesh":{var s=this.getValue(t,"path",a),v=this.attachmentLoader.newMeshAttachment(n,a,s);if(v==null)return null;v.path=s;var u=this.getValue(t,"color",null);u!=null&&v.color.setFromString(u);var y=this.getValue(t,"parent",null);if(y!=null)return v.inheritDeform=this.getValue(t,"deform",!0),this.linkedMeshes.push(new M(v,this.getValue(t,"skin",null),r,y)),v;var E=t.uvs;return this.readVertices(t,v,E.length),v.triangles=t.triangles,v.regionUVs=E,v.updateUVs(),v.hullLength=this.getValue(t,"hull",0)*2,v}case"path":{var s=this.attachmentLoader.newPathAttachment(n,a);if(s==null)return null;s.closed=this.getValue(t,"closed",!1),s.constantSpeed=this.getValue(t,"constantSpeed",!0);var S=t.vertexCount;this.readVertices(t,s,S<<1);for(var V=l.Utils.newArray(S/3,0),F=0;F<t.lengths.length;F++)V[F]=t.lengths[F]*c;s.lengths=V;var u=this.getValue(t,"color",null);return u!=null&&s.color.setFromString(u),s}case"point":{var m=this.attachmentLoader.newPointAttachment(n,a);if(m==null)return null;m.x=this.getValue(t,"x",0)*c,m.y=this.getValue(t,"y",0)*c,m.rotation=this.getValue(t,"rotation",0);var u=this.getValue(t,"color",null);return u!=null&&m.color.setFromString(u),m}case"clipping":{var d=this.attachmentLoader.newClippingAttachment(n,a);if(d==null)return null;var x=this.getValue(t,"end",null);if(x!=null){var I=f.findSlot(x);if(I==null)throw new Error("Clipping end slot not found: "+x);d.endSlot=I}var S=t.vertexCount;this.readVertices(t,d,S<<1);var u=this.getValue(t,"color",null);return u!=null&&d.color.setFromString(u),d}}return null},i.prototype.readVertices=function(t,n,r){var a=this.scale;n.worldVerticesLength=r;var f=t.vertices;if(r==f.length){var c=l.Utils.toFloatArray(f);if(a!=1)for(var h=0,s=f.length;h<s;h++)c[h]*=a;n.vertices=c;return}for(var o=new Array,u=new Array,h=0,s=f.length;h<s;){var p=f[h++];u.push(p);for(var v=h+p*4;h<v;h+=4)u.push(f[h]),o.push(f[h+1]*a),o.push(f[h+2]*a),o.push(f[h+3])}n.bones=u,n.vertices=l.Utils.toFloatArray(o)},i.prototype.readAnimation=function(t,n,r){var a=this.scale,f=new Array,c=0;if(t.slots)for(var h in t.slots){var s=t.slots[h],o=r.findSlotIndex(h);if(o==-1)throw new Error("Slot not found: "+h);for(var u in s){var p=s[u];if(u=="attachment"){var v=new l.AttachmentTimeline(p.length);v.slotIndex=o;for(var y=0,E=0;E<p.length;E++){var S=p[E];v.setFrame(y++,S.time,S.name)}f.push(v),c=Math.max(c,v.frames[v.getFrameCount()-1])}else if(u=="color"){var v=new l.ColorTimeline(p.length);v.slotIndex=o;for(var y=0,E=0;E<p.length;E++){var S=p[E],V=new l.Color;V.setFromString(S.color),v.setFrame(y,S.time,V.r,V.g,V.b,V.a),this.readCurve(S,v,y),y++}f.push(v),c=Math.max(c,v.frames[(v.getFrameCount()-1)*l.ColorTimeline.ENTRIES])}else if(u=="twoColor"){var v=new l.TwoColorTimeline(p.length);v.slotIndex=o;for(var y=0,E=0;E<p.length;E++){var S=p[E],F=new l.Color,m=new l.Color;F.setFromString(S.light),m.setFromString(S.dark),v.setFrame(y,S.time,F.r,F.g,F.b,F.a,m.r,m.g,m.b),this.readCurve(S,v,y),y++}f.push(v),c=Math.max(c,v.frames[(v.getFrameCount()-1)*l.TwoColorTimeline.ENTRIES])}else throw new Error("Invalid timeline type for a slot: "+u+" ("+h+")")}}if(t.bones)for(var d in t.bones){var x=t.bones[d],I=r.findBoneIndex(d);if(I==-1)throw new Error("Bone not found: "+d);for(var u in x){var p=x[u];if(u==="rotate"){var v=new l.RotateTimeline(p.length);v.boneIndex=I;for(var y=0,E=0;E<p.length;E++){var S=p[E];v.setFrame(y,S.time,S.angle),this.readCurve(S,v,y),y++}f.push(v),c=Math.max(c,v.frames[(v.getFrameCount()-1)*l.RotateTimeline.ENTRIES])}else if(u==="translate"||u==="scale"||u==="shear"){var v=null,g=1;u==="scale"?v=new l.ScaleTimeline(p.length):u==="shear"?v=new l.ShearTimeline(p.length):(v=new l.TranslateTimeline(p.length),g=a),v.boneIndex=I;for(var y=0,E=0;E<p.length;E++){var S=p[E],D=this.getValue(S,"x",0),T=this.getValue(S,"y",0);v.setFrame(y,S.time,D*g,T*g),this.readCurve(S,v,y),y++}f.push(v),c=Math.max(c,v.frames[(v.getFrameCount()-1)*l.TranslateTimeline.ENTRIES])}else throw new Error("Invalid timeline type for a bone: "+u+" ("+d+")")}}if(t.ik)for(var R in t.ik){var k=t.ik[R],C=r.findIkConstraint(R),v=new l.IkConstraintTimeline(k.length);v.ikConstraintIndex=r.ikConstraints.indexOf(C);for(var y=0,E=0;E<k.length;E++){var S=k[E];v.setFrame(y,S.time,this.getValue(S,"mix",1),this.getValue(S,"bendPositive",!0)?1:-1),this.readCurve(S,v,y),y++}f.push(v),c=Math.max(c,v.frames[(v.getFrameCount()-1)*l.IkConstraintTimeline.ENTRIES])}if(t.transform)for(var R in t.transform){var k=t.transform[R],C=r.findTransformConstraint(R),v=new l.TransformConstraintTimeline(k.length);v.transformConstraintIndex=r.transformConstraints.indexOf(C);for(var y=0,E=0;E<k.length;E++){var S=k[E];v.setFrame(y,S.time,this.getValue(S,"rotateMix",1),this.getValue(S,"translateMix",1),this.getValue(S,"scaleMix",1),this.getValue(S,"shearMix",1)),this.readCurve(S,v,y),y++}f.push(v),c=Math.max(c,v.frames[(v.getFrameCount()-1)*l.TransformConstraintTimeline.ENTRIES])}if(t.paths)for(var R in t.paths){var k=t.paths[R],A=r.findPathConstraintIndex(R);if(A==-1)throw new Error("Path constraint not found: "+R);var L=r.pathConstraints[A];for(var u in k){var p=k[u];if(u==="position"||u==="spacing"){var v=null,g=1;u==="spacing"?(v=new l.PathConstraintSpacingTimeline(p.length),(L.spacingMode==l.SpacingMode.Length||L.spacingMode==l.SpacingMode.Fixed)&&(g=a)):(v=new l.PathConstraintPositionTimeline(p.length),L.positionMode==l.PositionMode.Fixed&&(g=a)),v.pathConstraintIndex=A;for(var y=0,E=0;E<p.length;E++){var S=p[E];v.setFrame(y,S.time,this.getValue(S,u,0)*g),this.readCurve(S,v,y),y++}f.push(v),c=Math.max(c,v.frames[(v.getFrameCount()-1)*l.PathConstraintPositionTimeline.ENTRIES])}else if(u==="mix"){var v=new l.PathConstraintMixTimeline(p.length);v.pathConstraintIndex=A;for(var y=0,E=0;E<p.length;E++){var S=p[E];v.setFrame(y,S.time,this.getValue(S,"rotateMix",1),this.getValue(S,"translateMix",1)),this.readCurve(S,v,y),y++}f.push(v),c=Math.max(c,v.frames[(v.getFrameCount()-1)*l.PathConstraintMixTimeline.ENTRIES])}}}if(t.deform)for(var P in t.deform){var B=t.deform[P],_=r.findSkin(P);if(_==null)throw new Error("Skin not found: "+P);for(var h in B){var s=B[h],o=r.findSlotIndex(h);if(o==-1)throw new Error("Slot not found: "+s.name);for(var u in s){var p=s[u],W=_.getAttachment(o,u);if(W==null)throw new Error("Deform attachment not found: "+p.name);var U=W.bones!=null,Y=W.vertices,G=U?Y.length/3*2:Y.length,v=new l.DeformTimeline(p.length);v.slotIndex=o,v.attachment=W;for(var y=0,X=0;X<p.length;X++){var S=p[X],H=void 0,O=this.getValue(S,"vertices",null);if(O==null)H=U?l.Utils.newFloatArray(G):Y;else{H=l.Utils.newFloatArray(G);var q=this.getValue(S,"offset",0);if(l.Utils.arrayCopy(O,0,H,q,O.length),a!=1)for(var E=q,z=E+O.length;E<z;E++)H[E]*=a;if(!U)for(var E=0;E<G;E++)H[E]+=Y[E]}v.setFrame(y,S.time,H),this.readCurve(S,v,y),y++}f.push(v),c=Math.max(c,v.frames[v.getFrameCount()-1])}}}var J=t.drawOrder;if(J==null&&(J=t.draworder),J!=null){for(var v=new l.DrawOrderTimeline(J.length),Q=r.slots.length,y=0,X=0;X<J.length;X++){var K=J[X],w=null,b=this.getValue(K,"offsets",null);if(b!=null){w=l.Utils.newArray(Q,-1);for(var et=l.Utils.newArray(Q-b.length,0),tt=0,st=0,E=0;E<b.length;E++){var ot=b[E],o=r.findSlotIndex(ot.slot);if(o==-1)throw new Error("Slot not found: "+ot.slot);for(;tt!=o;)et[st++]=tt++;w[tt+ot.offset]=tt++}for(;tt<Q;)et[st++]=tt++;for(var E=Q-1;E>=0;E--)w[E]==-1&&(w[E]=et[--st])}v.setFrame(y++,K.time,w)}f.push(v),c=Math.max(c,v.frames[v.getFrameCount()-1])}if(t.events){for(var v=new l.EventTimeline(t.events.length),y=0,E=0;E<t.events.length;E++){var rt=t.events[E],nt=r.findEvent(rt.name);if(nt==null)throw new Error("Event not found: "+rt.name);var it=new l.Event(rt.time,nt);it.intValue=this.getValue(rt,"int",nt.intValue),it.floatValue=this.getValue(rt,"float",nt.floatValue),it.stringValue=this.getValue(rt,"string",nt.stringValue),v.setFrame(y++,it)}f.push(v),c=Math.max(c,v.frames[v.getFrameCount()-1])}if(isNaN(c))throw new Error("Error while parsing animation, duration is NaN");r.animations.push(new l.Animation(n,f,c))},i.prototype.readCurve=function(t,n,r){if(!!t.curve){if(t.curve==="stepped")n.setStepped(r);else if(Object.prototype.toString.call(t.curve)==="[object Array]"){var a=t.curve;n.setCurve(r,a[0],a[1],a[2],a[3])}}},i.prototype.getValue=function(t,n,r){return t[n]!==void 0?t[n]:r},i.blendModeFromString=function(t){if(t=t.toLowerCase(),t=="normal")return l.BlendMode.Normal;if(t=="additive")return l.BlendMode.Additive;if(t=="multiply")return l.BlendMode.Multiply;if(t=="screen")return l.BlendMode.Screen;throw new Error("Unknown blend mode: "+t)},i.positionModeFromString=function(t){if(t=t.toLowerCase(),t=="fixed")return l.PositionMode.Fixed;if(t=="percent")return l.PositionMode.Percent;throw new Error("Unknown position mode: "+t)},i.spacingModeFromString=function(t){if(t=t.toLowerCase(),t=="length")return l.SpacingMode.Length;if(t=="fixed")return l.SpacingMode.Fixed;if(t=="percent")return l.SpacingMode.Percent;throw new Error("Unknown position mode: "+t)},i.rotateModeFromString=function(t){if(t=t.toLowerCase(),t=="tangent")return l.RotateMode.Tangent;if(t=="chain")return l.RotateMode.Chain;if(t=="chainscale")return l.RotateMode.ChainScale;throw new Error("Unknown rotate mode: "+t)},i.transformModeFromString=function(t){if(t=t.toLowerCase(),t=="normal")return l.TransformMode.Normal;if(t=="onlytranslation")return l.TransformMode.OnlyTranslation;if(t=="norotationorreflection")return l.TransformMode.NoRotationOrReflection;if(t=="noscale")return l.TransformMode.NoScale;if(t=="noscaleorreflection")return l.TransformMode.NoScaleOrReflection;throw new Error("Unknown transform mode: "+t)},i}();l.SkeletonJson=e;var M=function(){function i(t,n,r,a){this.mesh=t,this.skin=n,this.slotIndex=r,this.parent=a}return i}()})(N||(N={}));var N;(function(l){var e=function(){function M(i){if(this.attachments=new Array,i==null)throw new Error("name cannot be null.");this.name=i}return M.prototype.addAttachment=function(i,t,n){if(n==null)throw new Error("attachment cannot be null.");var r=this.attachments;i>=r.length&&(r.length=i+1),r[i]||(r[i]={}),r[i][t]=n},M.prototype.getAttachment=function(i,t){var n=this.attachments[i];return n?n[t]:null},M.prototype.attachAll=function(i,t){for(var n=0,r=0;r<i.slots.length;r++){var a=i.slots[r],f=a.getAttachment();if(f&&n<t.attachments.length){var c=t.attachments[n];for(var h in c){var s=c[h];if(f==s){var o=this.getAttachment(n,h);o!=null&&a.setAttachment(o);break}}}n++}},M}();l.Skin=e})(N||(N={}));var N;(function(l){var e=function(){function M(i,t){if(this.attachmentVertices=new Array,i==null)throw new Error("data cannot be null.");if(t==null)throw new Error("bone cannot be null.");this.data=i,this.bone=t,this.color=new l.Color,this.darkColor=i.darkColor==null?null:new l.Color,this.setToSetupPose()}return M.prototype.getAttachment=function(){return this.attachment},M.prototype.setAttachment=function(i){this.attachment!=i&&(this.attachment=i,this.attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0)},M.prototype.setAttachmentTime=function(i){this.attachmentTime=this.bone.skeleton.time-i},M.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},M.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),this.darkColor!=null&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName==null?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},M}();l.Slot=e})(N||(N={}));var N;(function(l){var e=function(){function M(i,t,n){if(this.color=new l.Color(1,1,1,1),i<0)throw new Error("index must be >= 0.");if(t==null)throw new Error("name cannot be null.");if(n==null)throw new Error("boneData cannot be null.");this.index=i,this.name=t,this.boneData=n}return M}();l.SlotData=e})(N||(N={}));var N;(function(l){var e=function(){function n(r){this._image=r}return n.prototype.getImage=function(){return this._image},n.filterFromString=function(r){switch(r.toLowerCase()){case"nearest":return M.Nearest;case"linear":return M.Linear;case"mipmap":return M.MipMap;case"mipmapnearestnearest":return M.MipMapNearestNearest;case"mipmaplinearnearest":return M.MipMapLinearNearest;case"mipmapnearestlinear":return M.MipMapNearestLinear;case"mipmaplinearlinear":return M.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+r)}},n.wrapFromString=function(r){switch(r.toLowerCase()){case"mirroredtepeat":return i.MirroredRepeat;case"clamptoedge":return i.ClampToEdge;case"repeat":return i.Repeat;default:throw new Error("Unknown texture wrap "+r)}},n}();l.Texture=e,function(n){n[n.Nearest=9728]="Nearest",n[n.Linear=9729]="Linear",n[n.MipMap=9987]="MipMap",n[n.MipMapNearestNearest=9984]="MipMapNearestNearest",n[n.MipMapLinearNearest=9985]="MipMapLinearNearest",n[n.MipMapNearestLinear=9986]="MipMapNearestLinear",n[n.MipMapLinearLinear=9987]="MipMapLinearLinear"}(l.TextureFilter||(l.TextureFilter={}));var M=l.TextureFilter;(function(n){n[n.MirroredRepeat=33648]="MirroredRepeat",n[n.ClampToEdge=33071]="ClampToEdge",n[n.Repeat=10497]="Repeat"})(l.TextureWrap||(l.TextureWrap={}));var i=l.TextureWrap,t=function(){function n(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.rotate=!1,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0}return n}();l.TextureRegion=t})(N||(N={}));var N;(function(l){var e=function(){function n(r,a){this.pages=new Array,this.regions=new Array,this.load(r,a)}return n.prototype.load=function(r,a){if(a==null)throw new Error("textureLoader cannot be null.");for(var f=new M(r),c=new Array(4),h=null;;){var s=f.readLine();if(s==null)break;if(s=s.trim(),s.length==0)h=null;else if(h){var u=new t;u.name=s,u.page=h,u.rotate=f.readValue()=="true",f.readTuple(c);var p=parseInt(c[0]),v=parseInt(c[1]);f.readTuple(c);var y=parseInt(c[0]),E=parseInt(c[1]);u.u=p/h.width,u.v=v/h.height,u.rotate?(u.u2=(p+E)/h.width,u.v2=(v+y)/h.height):(u.u2=(p+y)/h.width,u.v2=(v+E)/h.height),u.x=p,u.y=v,u.width=Math.abs(y),u.height=Math.abs(E),f.readTuple(c)==4&&f.readTuple(c)==4&&f.readTuple(c),u.originalWidth=parseInt(c[0]),u.originalHeight=parseInt(c[1]),f.readTuple(c),u.offsetX=parseInt(c[0]),u.offsetY=parseInt(c[1]),u.index=parseInt(f.readValue()),u.texture=h.texture,this.regions.push(u)}else{h=new i,h.name=s,f.readTuple(c)==2&&(h.width=parseInt(c[0]),h.height=parseInt(c[1]),f.readTuple(c)),f.readTuple(c),h.minFilter=l.Texture.filterFromString(c[0]),h.magFilter=l.Texture.filterFromString(c[1]);var o=f.readValue();h.uWrap=l.TextureWrap.ClampToEdge,h.vWrap=l.TextureWrap.ClampToEdge,o=="x"?h.uWrap=l.TextureWrap.Repeat:o=="y"?h.vWrap=l.TextureWrap.Repeat:o=="xy"&&(h.uWrap=h.vWrap=l.TextureWrap.Repeat),h.texture=a(s),h.texture.setFilters(h.minFilter,h.magFilter),h.texture.setWraps(h.uWrap,h.vWrap),h.width=h.texture.getImage().width,h.height=h.texture.getImage().height,this.pages.push(h)}}},n.prototype.findRegion=function(r){for(var a=0;a<this.regions.length;a++)if(this.regions[a].name==r)return this.regions[a];return null},n.prototype.dispose=function(){for(var r=0;r<this.pages.length;r++)this.pages[r].texture.dispose()},n}();l.TextureAtlas=e;var M=function(){function n(r){this.index=0,this.lines=r.split(/\r\n|\r|\n/)}return n.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},n.prototype.readValue=function(){var r=this.readLine(),a=r.indexOf(":");if(a==-1)throw new Error("Invalid line: "+r);return r.substring(a+1).trim()},n.prototype.readTuple=function(r){var a=this.readLine(),f=a.indexOf(":");if(f==-1)throw new Error("Invalid line: "+a);for(var c=0,h=f+1;c<3;c++){var s=a.indexOf(",",h);if(s==-1)break;r[c]=a.substr(h,s-h).trim(),h=s+1}return r[c]=a.substring(h).trim(),c+1},n}(),i=function(){function n(){}return n}();l.TextureAtlasPage=i;var t=function(n){$(r,n);function r(){n.apply(this,arguments)}return r}(l.TextureRegion);l.TextureAtlasRegion=t})(N||(N={}));var N;(function(l){var e=function(){function M(i,t){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new l.Vector2,i==null)throw new Error("data cannot be null.");if(t==null)throw new Error("skeleton cannot be null.");this.data=i,this.rotateMix=i.rotateMix,this.translateMix=i.translateMix,this.scaleMix=i.scaleMix,this.shearMix=i.shearMix,this.bones=new Array;for(var n=0;n<i.bones.length;n++)this.bones.push(t.findBone(i.bones[n].name));this.target=t.findBone(i.target.name)}return M.prototype.apply=function(){this.update()},M.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},M.prototype.applyAbsoluteWorld=function(){for(var i=this.rotateMix,t=this.translateMix,n=this.scaleMix,r=this.shearMix,a=this.target,f=a.a,c=a.b,h=a.c,s=a.d,o=f*s-c*h>0?l.MathUtils.degRad:-l.MathUtils.degRad,u=this.data.offsetRotation*o,p=this.data.offsetShearY*o,v=this.bones,y=0,E=v.length;y<E;y++){var S=v[y],V=!1;if(i!=0){var F=S.a,m=S.b,d=S.c,x=S.d,I=Math.atan2(h,f)-Math.atan2(d,F)+u;I>l.MathUtils.PI?I-=l.MathUtils.PI2:I<-l.MathUtils.PI&&(I+=l.MathUtils.PI2),I*=i;var g=Math.cos(I),D=Math.sin(I);S.a=g*F-D*d,S.b=g*m-D*x,S.c=D*F+g*d,S.d=D*m+g*x,V=!0}if(t!=0){var T=this.temp;a.localToWorld(T.set(this.data.offsetX,this.data.offsetY)),S.worldX+=(T.x-S.worldX)*t,S.worldY+=(T.y-S.worldY)*t,V=!0}if(n>0){var R=Math.sqrt(S.a*S.a+S.c*S.c),k=Math.sqrt(f*f+h*h);R>1e-5&&(R=(R+(k-R+this.data.offsetScaleX)*n)/R),S.a*=R,S.c*=R,R=Math.sqrt(S.b*S.b+S.d*S.d),k=Math.sqrt(c*c+s*s),R>1e-5&&(R=(R+(k-R+this.data.offsetScaleY)*n)/R),S.b*=R,S.d*=R,V=!0}if(r>0){var m=S.b,x=S.d,C=Math.atan2(x,m),I=Math.atan2(s,c)-Math.atan2(h,f)-(C-Math.atan2(S.c,S.a));I>l.MathUtils.PI?I-=l.MathUtils.PI2:I<-l.MathUtils.PI&&(I+=l.MathUtils.PI2),I=C+(I+p)*r;var R=Math.sqrt(m*m+x*x);S.b=Math.cos(I)*R,S.d=Math.sin(I)*R,V=!0}V&&(S.appliedValid=!1)}},M.prototype.applyRelativeWorld=function(){for(var i=this.rotateMix,t=this.translateMix,n=this.scaleMix,r=this.shearMix,a=this.target,f=a.a,c=a.b,h=a.c,s=a.d,o=f*s-c*h>0?l.MathUtils.degRad:-l.MathUtils.degRad,u=this.data.offsetRotation*o,p=this.data.offsetShearY*o,v=this.bones,y=0,E=v.length;y<E;y++){var S=v[y],V=!1;if(i!=0){var F=S.a,m=S.b,d=S.c,x=S.d,I=Math.atan2(h,f)+u;I>l.MathUtils.PI?I-=l.MathUtils.PI2:I<-l.MathUtils.PI&&(I+=l.MathUtils.PI2),I*=i;var g=Math.cos(I),D=Math.sin(I);S.a=g*F-D*d,S.b=g*m-D*x,S.c=D*F+g*d,S.d=D*m+g*x,V=!0}if(t!=0){var T=this.temp;a.localToWorld(T.set(this.data.offsetX,this.data.offsetY)),S.worldX+=T.x*t,S.worldY+=T.y*t,V=!0}if(n>0){var R=(Math.sqrt(f*f+h*h)-1+this.data.offsetScaleX)*n+1;S.a*=R,S.c*=R,R=(Math.sqrt(c*c+s*s)-1+this.data.offsetScaleY)*n+1,S.b*=R,S.d*=R,V=!0}if(r>0){var I=Math.atan2(s,c)-Math.atan2(h,f);I>l.MathUtils.PI?I-=l.MathUtils.PI2:I<-l.MathUtils.PI&&(I+=l.MathUtils.PI2);var m=S.b,x=S.d;I=Math.atan2(x,m)+(I-l.MathUtils.PI/2+p)*r;var R=Math.sqrt(m*m+x*x);S.b=Math.cos(I)*R,S.d=Math.sin(I)*R,V=!0}V&&(S.appliedValid=!1)}},M.prototype.applyAbsoluteLocal=function(){var i=this.rotateMix,t=this.translateMix,n=this.scaleMix,r=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var f=this.bones,c=0,h=f.length;c<h;c++){var s=f[c];s.appliedValid||s.updateAppliedTransform();var o=s.arotation;if(i!=0){var u=a.arotation-o+this.data.offsetRotation;u-=(16384-(16384.499999999996-u/360|0))*360,o+=u*i}var p=s.ax,v=s.ay;t!=0&&(p+=(a.ax-p+this.data.offsetX)*t,v+=(a.ay-v+this.data.offsetY)*t);var y=s.ascaleX,E=s.ascaleY;n>0&&(y>1e-5&&(y=(y+(a.ascaleX-y+this.data.offsetScaleX)*n)/y),E>1e-5&&(E=(E+(a.ascaleY-E+this.data.offsetScaleY)*n)/E));var S=s.ashearY;if(r>0){var u=a.ashearY-S+this.data.offsetShearY;u-=(16384-(16384.499999999996-u/360|0))*360,s.shearY+=u*r}s.updateWorldTransformWith(p,v,o,y,E,s.ashearX,S)}},M.prototype.applyRelativeLocal=function(){var i=this.rotateMix,t=this.translateMix,n=this.scaleMix,r=this.shearMix,a=this.target;a.appliedValid||a.updateAppliedTransform();for(var f=this.bones,c=0,h=f.length;c<h;c++){var s=f[c];s.appliedValid||s.updateAppliedTransform();var o=s.arotation;i!=0&&(o+=(a.arotation+this.data.offsetRotation)*i);var u=s.ax,p=s.ay;t!=0&&(u+=(a.ax+this.data.offsetX)*t,p+=(a.ay+this.data.offsetY)*t);var v=s.ascaleX,y=s.ascaleY;n>0&&(v>1e-5&&(v*=(a.ascaleX-1+this.data.offsetScaleX)*n+1),y>1e-5&&(y*=(a.ascaleY-1+this.data.offsetScaleY)*n+1));var E=s.ashearY;r>0&&(E+=(a.ashearY+this.data.offsetShearY)*r),s.updateWorldTransformWith(u,p,o,v,y,s.ashearX,E)}},M.prototype.getOrder=function(){return this.data.order},M}();l.TransformConstraint=e})(N||(N={}));var N;(function(l){var e=function(){function M(i){if(this.order=0,this.bones=new Array,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1,i==null)throw new Error("name cannot be null.");this.name=i}return M}();l.TransformConstraintData=e})(N||(N={}));var N;(function(l){var e=function(){function M(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new l.Pool(function(){return new Array}),this.polygonIndicesPool=new l.Pool(function(){return new Array})}return M.prototype.triangulate=function(i){var t=i,n=i.length>>1,r=this.indicesArray;r.length=0;for(var a=0;a<n;a++)r[a]=a;var f=this.isConcaveArray;f.length=0;for(var a=0,c=n;a<c;++a)f[a]=M.isConcave(a,n,t,r);var h=this.triangles;for(h.length=0;n>3;){for(var s=n-1,a=0,o=1;;){t:if(!f[a]){for(var u=r[s]<<1,p=r[a]<<1,v=r[o]<<1,y=t[u],E=t[u+1],S=t[p],V=t[p+1],F=t[v],m=t[v+1],d=(o+1)%n;d!=s;d=(d+1)%n)if(!!f[d]){var x=r[d]<<1,I=t[x],g=t[x+1];if(M.positiveArea(F,m,y,E,I,g)&&M.positiveArea(y,E,S,V,I,g)&&M.positiveArea(S,V,F,m,I,g))break t}break}if(o==0){do{if(!f[a])break;a--}while(a>0);break}s=a,a=o,o=(o+1)%n}h.push(r[(n+a-1)%n]),h.push(r[a]),h.push(r[(a+1)%n]),r.splice(a,1),f.splice(a,1),n--;var D=(n+a-1)%n,T=a==n?0:a;f[D]=M.isConcave(D,n,t,r),f[T]=M.isConcave(T,n,t,r)}return n==3&&(h.push(r[2]),h.push(r[0]),h.push(r[1])),h},M.prototype.decompose=function(i,t){var n=i,r=this.convexPolygons;this.polygonPool.freeAll(r),r.length=0;var a=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(a),a.length=0;var f=this.polygonIndicesPool.obtain();f.length=0;var c=this.polygonPool.obtain();c.length=0;for(var h=-1,s=0,o=0,u=t.length;o<u;o+=3){var p=t[o]<<1,v=t[o+1]<<1,y=t[o+2]<<1,E=n[p],S=n[p+1],V=n[v],F=n[v+1],m=n[y],d=n[y+1],x=!1;if(h==p){var I=c.length-4,g=M.winding(c[I],c[I+1],c[I+2],c[I+3],m,d),D=M.winding(m,d,c[0],c[1],c[2],c[3]);g==s&&D==s&&(c.push(m),c.push(d),f.push(y),x=!0)}x||(c.length>0?(r.push(c),a.push(f)):(this.polygonPool.free(c),this.polygonIndicesPool.free(f)),c=this.polygonPool.obtain(),c.length=0,c.push(E),c.push(S),c.push(V),c.push(F),c.push(m),c.push(d),f=this.polygonIndicesPool.obtain(),f.length=0,f.push(p),f.push(v),f.push(y),s=M.winding(E,S,V,F,m,d),h=p)}c.length>0&&(r.push(c),a.push(f));for(var o=0,u=r.length;o<u;o++)if(f=a[o],f.length!=0){var T=f[0],R=f[f.length-1];c=r[o];for(var I=c.length-4,k=c[I],C=c[I+1],A=c[I+2],L=c[I+3],P=c[0],B=c[1],_=c[2],W=c[3],U=M.winding(k,C,A,L,P,B),Y=0;Y<u;Y++)if(Y!=o){var G=a[Y];if(G.length==3){var X=G[0],H=G[1],O=G[2],q=r[Y],m=q[q.length-2],d=q[q.length-1];if(!(X!=T||H!=R)){var g=M.winding(k,C,A,L,m,d),D=M.winding(m,d,P,B,_,W);g==U&&D==U&&(q.length=0,G.length=0,c.push(m),c.push(d),f.push(O),k=A,C=L,A=m,L=d,Y=0)}}}}for(var o=r.length-1;o>=0;o--)c=r[o],c.length==0&&(r.splice(o,1),this.polygonPool.free(c),f=a[o],a.splice(o,1),this.polygonIndicesPool.free(f));return r},M.isConcave=function(i,t,n,r){var a=r[(t+i-1)%t]<<1,f=r[i]<<1,c=r[(i+1)%t]<<1;return!this.positiveArea(n[a],n[a+1],n[f],n[f+1],n[c],n[c+1])},M.positiveArea=function(i,t,n,r,a,f){return i*(f-r)+n*(t-f)+a*(r-t)>=0},M.winding=function(i,t,n,r,a,f){var c=n-i,h=r-t;return a*h-f*c+c*t-i*h>=0?1:-1},M}();l.Triangulator=e})(N||(N={}));var N;(function(l){var e=function(){function h(){this.array=new Array}return h.prototype.add=function(s){var o=this.contains(s);return this.array[s|0]=s|0,!o},h.prototype.contains=function(s){return this.array[s|0]!=null},h.prototype.remove=function(s){this.array[s|0]=void 0},h.prototype.clear=function(){this.array.length=0},h}();l.IntSet=e;var M=function(){function h(s,o,u,p){s===void 0&&(s=0),o===void 0&&(o=0),u===void 0&&(u=0),p===void 0&&(p=0),this.r=s,this.g=o,this.b=u,this.a=p}return h.prototype.set=function(s,o,u,p){return this.r=s,this.g=o,this.b=u,this.a=p,this.clamp(),this},h.prototype.setFromColor=function(s){return this.r=s.r,this.g=s.g,this.b=s.b,this.a=s.a,this},h.prototype.setFromString=function(s){return s=s.charAt(0)=="#"?s.substr(1):s,this.r=parseInt(s.substr(0,2),16)/255,this.g=parseInt(s.substr(2,2),16)/255,this.b=parseInt(s.substr(4,2),16)/255,this.a=(s.length!=8?255:parseInt(s.substr(6,2),16))/255,this},h.prototype.add=function(s,o,u,p){return this.r+=s,this.g+=o,this.b+=u,this.a+=p,this.clamp(),this},h.prototype.clamp=function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this},h.WHITE=new h(1,1,1,1),h.RED=new h(1,0,0,1),h.GREEN=new h(0,1,0,1),h.BLUE=new h(0,0,1,1),h.MAGENTA=new h(1,0,1,1),h}();l.Color=M;var i=function(){function h(){}return h.clamp=function(s,o,u){return s<o?o:s>u?u:s},h.cosDeg=function(s){return Math.cos(s*h.degRad)},h.sinDeg=function(s){return Math.sin(s*h.degRad)},h.signum=function(s){return s>0?1:s<0?-1:0},h.toInt=function(s){return s>0?Math.floor(s):Math.ceil(s)},h.cbrt=function(s){var o=Math.pow(Math.abs(s),1/3);return s<0?-o:o},h.PI=3.1415927,h.PI2=h.PI*2,h.radiansToDegrees=180/h.PI,h.radDeg=h.radiansToDegrees,h.degreesToRadians=h.PI/180,h.degRad=h.degreesToRadians,h}();l.MathUtils=i;var t=function(){function h(){}return h.arrayCopy=function(s,o,u,p,v){for(var y=o,E=p;y<o+v;y++,E++)u[E]=s[y]},h.setArraySize=function(s,o,u){u===void 0&&(u=0);var p=s.length;if(p==o)return s;if(s.length=o,p<o)for(var v=p;v<o;v++)s[v]=u;return s},h.ensureArrayCapacity=function(s,o,u){return u===void 0&&(u=0),s.length>=o?s:h.setArraySize(s,o,u)},h.newArray=function(s,o){for(var u=new Array(s),p=0;p<s;p++)u[p]=o;return u},h.newFloatArray=function(s){if(h.SUPPORTS_TYPED_ARRAYS)return new Float32Array(s);for(var o=new Array(s),u=0;u<o.length;u++)o[u]=0;return o},h.newShortArray=function(s){if(h.SUPPORTS_TYPED_ARRAYS)return new Int16Array(s);for(var o=new Array(s),u=0;u<o.length;u++)o[u]=0;return o},h.toFloatArray=function(s){return h.SUPPORTS_TYPED_ARRAYS?new Float32Array(s):s},h.SUPPORTS_TYPED_ARRAYS=typeof Float32Array!="undefined",h}();l.Utils=t;var n=function(){function h(){}return h.logBones=function(s){for(var o=0;o<s.bones.length;o++){var u=s.bones[o];console.log(u.data.name+", "+u.a+", "+u.b+", "+u.c+", "+u.d+", "+u.worldX+", "+u.worldY)}},h}();l.DebugUtils=n;var r=function(){function h(s){this.items=new Array,this.instantiator=s}return h.prototype.obtain=function(){return this.items.length>0?this.items.pop():this.instantiator()},h.prototype.free=function(s){s.reset&&s.reset(),this.items.push(s)},h.prototype.freeAll=function(s){for(var o=0;o<s.length;o++)s[o].reset&&s[o].reset(),this.items[o]=s[o]},h.prototype.clear=function(){this.items.length=0},h}();l.Pool=r;var a=function(){function h(s,o){s===void 0&&(s=0),o===void 0&&(o=0),this.x=s,this.y=o}return h.prototype.set=function(s,o){return this.x=s,this.y=o,this},h.prototype.length=function(){var s=this.x,o=this.y;return Math.sqrt(s*s+o*o)},h.prototype.normalize=function(){var s=this.length();return s!=0&&(this.x/=s,this.y/=s),this},h}();l.Vector2=a;var f=function(){function h(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return h.prototype.update=function(){var s=Date.now()/1e3;this.delta=s-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=s,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},h}();l.TimeKeeper=f;var c=function(){function h(s){s===void 0&&(s=32),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(s)}return h.prototype.hasEnoughData=function(){return this.addedValues>=this.values.length},h.prototype.addValue=function(s){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=s,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0},h.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var s=0,o=0;o<this.values.length;o++)s+=this.values[o];this.mean=s/this.values.length,this.dirty=!1}return this.mean}else return 0},h}();l.WindowedMean=c})(N||(N={}));var N;(function(l){(function(e){var M=function(i){$(t,i);function t(n,r){r===void 0&&(r=""),i.call(this,function(a){return new l.webgl.GLTexture(n,a)},r)}return t}(l.AssetManager);e.AssetManager=M})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function i(t,n){this.position=new e.Vector3(0,0,0),this.direction=new e.Vector3(0,0,-1),this.up=new e.Vector3(0,1,0),this.near=0,this.far=100,this.zoom=1,this.viewportWidth=0,this.viewportHeight=0,this.projectionView=new e.Matrix4,this.inverseProjectionView=new e.Matrix4,this.projection=new e.Matrix4,this.view=new e.Matrix4,this.tmp=new e.Vector3,this.viewportWidth=t,this.viewportHeight=n,this.update()}return i.prototype.update=function(){var t=this.projection,n=this.view,r=this.projectionView,a=this.inverseProjectionView,f=this.zoom,c=this.viewportWidth,h=this.viewportHeight;t.ortho(f*(-c/2),f*(c/2),f*(-h/2),f*(h/2),this.near,this.far),n.lookAt(this.position,this.direction,this.up),r.set(t.values),r.multiply(n),a.set(r.values).invert()},i.prototype.screenToWorld=function(t,n,r){var a=t.x,f=r-t.y-1,c=this.tmp;return c.x=2*a/n-1,c.y=2*f/r-1,c.z=2*t.z-1,c.project(this.inverseProjectionView),t.set(c.x,c.y,c.z),t},i.prototype.setViewport=function(t,n){this.viewportWidth=t,this.viewportHeight=n},i}();e.OrthoCamera=M})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(i){$(t,i);function t(n,r,a){a===void 0&&(a=!1),i.call(this,r),this.texture=null,this.boundUnit=0,this.useMipMaps=!1,this.context=n instanceof e.ManagedWebGLRenderingContext?n:new e.ManagedWebGLRenderingContext(n),this.useMipMaps=a,this.restore(),this.context.addRestorable(this)}return t.prototype.setFilters=function(n,r){var a=this.context.gl;this.bind(),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,n),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,r)},t.prototype.setWraps=function(n,r){var a=this.context.gl;this.bind(),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,n),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,r)},t.prototype.update=function(n){var r=this.context.gl;this.texture||(this.texture=this.context.gl.createTexture()),this.bind(),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,this._image),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n?r.LINEAR_MIPMAP_LINEAR:r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),n&&r.generateMipmap(r.TEXTURE_2D)},t.prototype.restore=function(){this.texture=null,this.update(this.useMipMaps)},t.prototype.bind=function(n){n===void 0&&(n=0);var r=this.context.gl;this.boundUnit=n,r.activeTexture(r.TEXTURE0+n),r.bindTexture(r.TEXTURE_2D,this.texture)},t.prototype.unbind=function(){var n=this.context.gl;n.activeTexture(n.TEXTURE0+this.boundUnit),n.bindTexture(n.TEXTURE_2D,null)},t.prototype.dispose=function(){this.context.removeRestorable(this);var n=this.context.gl;n.deleteTexture(this.texture)},t}(l.Texture);e.GLTexture=M})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function t(n){this.lastX=0,this.lastY=0,this.buttonDown=!1,this.currTouch=null,this.touchesPool=new l.Pool(function(){return new l.webgl.Touch(0,0,0)}),this.listeners=new Array,this.element=n,this.setupCallbacks(n)}return t.prototype.setupCallbacks=function(n){var r=this;n.addEventListener("mousedown",function(a){if(a instanceof MouseEvent){for(var f=n.getBoundingClientRect(),c=a.clientX-f.left,h=a.clientY-f.top,s=r.listeners,o=0;o<s.length;o++)s[o].down(c,h);r.lastX=c,r.lastY=h,r.buttonDown=!0}},!0),n.addEventListener("mousemove",function(a){if(a instanceof MouseEvent){for(var f=n.getBoundingClientRect(),c=a.clientX-f.left,h=a.clientY-f.top,s=r.listeners,o=0;o<s.length;o++)r.buttonDown?s[o].dragged(c,h):s[o].moved(c,h);r.lastX=c,r.lastY=h}},!0),n.addEventListener("mouseup",function(a){if(a instanceof MouseEvent){for(var f=n.getBoundingClientRect(),c=a.clientX-f.left,h=a.clientY-f.top,s=r.listeners,o=0;o<s.length;o++)s[o].up(c,h);r.lastX=c,r.lastY=h,r.buttonDown=!1}},!0),n.addEventListener("touchstart",function(a){if(r.currTouch==null){for(var f=a.changedTouches,c=0;c<f.length;c++){var h=f[c],s=n.getBoundingClientRect(),o=h.clientX-s.left,u=h.clientY-s.top;r.currTouch=r.touchesPool.obtain(),r.currTouch.identifier=h.identifier,r.currTouch.x=o,r.currTouch.y=u;break}for(var p=r.listeners,v=0;v<p.length;v++)p[v].down(r.currTouch.x,r.currTouch.y);console.log("Start "+r.currTouch.x+", "+r.currTouch.y),r.lastX=r.currTouch.x,r.lastY=r.currTouch.y,r.buttonDown=!0,a.preventDefault()}},!1),n.addEventListener("touchend",function(a){for(var f=a.changedTouches,c=0;c<f.length;c++){var h=f[c];if(r.currTouch.identifier===h.identifier){var s=n.getBoundingClientRect(),o=r.currTouch.x=h.clientX-s.left,u=r.currTouch.y=h.clientY-s.top;r.touchesPool.free(r.currTouch);for(var p=r.listeners,v=0;v<p.length;v++)p[v].up(o,u);console.log("End "+o+", "+u),r.lastX=o,r.lastY=u,r.buttonDown=!1,r.currTouch=null;break}}a.preventDefault()},!1),n.addEventListener("touchcancel",function(a){for(var f=a.changedTouches,c=0;c<f.length;c++){var h=f[c];if(r.currTouch.identifier===h.identifier){var s=n.getBoundingClientRect(),o=r.currTouch.x=h.clientX-s.left,u=r.currTouch.y=h.clientY-s.top;r.touchesPool.free(r.currTouch);for(var p=r.listeners,v=0;v<p.length;v++)p[v].up(o,u);console.log("End "+o+", "+u),r.lastX=o,r.lastY=u,r.buttonDown=!1,r.currTouch=null;break}}a.preventDefault()},!1),n.addEventListener("touchmove",function(a){if(r.currTouch!=null){for(var f=a.changedTouches,c=0;c<f.length;c++){var h=f[c];if(r.currTouch.identifier===h.identifier){for(var s=n.getBoundingClientRect(),o=h.clientX-s.left,u=h.clientY-s.top,p=r.listeners,v=0;v<p.length;v++)p[v].dragged(o,u);console.log("Drag "+o+", "+u),r.lastX=r.currTouch.x=o,r.lastY=r.currTouch.y=u;break}}a.preventDefault()}},!1)},t.prototype.addListener=function(n){this.listeners.push(n)},t.prototype.removeListener=function(n){var r=this.listeners.indexOf(n);r>-1&&this.listeners.splice(r,1)},t}();e.Input=M;var i=function(){function t(n,r,a){this.identifier=n,this.x=r,this.y=a}return t}();e.Touch=i})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function i(t){if(this.logo=null,this.spinner=null,this.angle=0,this.fadeOut=0,this.timeKeeper=new l.TimeKeeper,this.backgroundColor=new l.Color(.135,.135,.135,1),this.tempColor=new l.Color,this.firstDraw=0,this.renderer=t,this.timeKeeper.maxDelta=9,i.logoImg===null){var n=navigator.userAgent.indexOf("Safari")>-1;i.logoImg=new Image,i.logoImg.src=i.SPINE_LOGO_DATA,n||(i.logoImg.crossOrigin="anonymous"),i.logoImg.onload=function(r){i.loaded++},i.spinnerImg=new Image,i.spinnerImg.src=i.SPINNER_DATA,n||(i.spinnerImg.crossOrigin="anonymous"),i.spinnerImg.onload=function(r){i.loaded++}}}return i.prototype.draw=function(t){if(t===void 0&&(t=!1),!(t&&this.fadeOut>i.FADE_SECONDS)){this.timeKeeper.update();var n=Math.abs(Math.sin(this.timeKeeper.totalTime+.75));this.angle-=this.timeKeeper.delta*360*(1+1.5*Math.pow(n,5));var r=this.renderer,a=r.canvas,f=r.context.gl,c=r.camera.position.x,h=r.camera.position.y;if(r.camera.position.set(a.width/2,a.height/2,0),r.camera.viewportWidth=a.width,r.camera.viewportHeight=a.height,r.resize(e.ResizeMode.Stretch),!t)f.clearColor(this.backgroundColor.r,this.backgroundColor.g,this.backgroundColor.b,this.backgroundColor.a),f.clear(f.COLOR_BUFFER_BIT),this.tempColor.a=1;else{if(this.fadeOut+=this.timeKeeper.delta*(this.timeKeeper.totalTime<1?2:1),this.fadeOut>i.FADE_SECONDS){r.camera.position.set(c,h,0);return}n=1-this.fadeOut/i.FADE_SECONDS,this.tempColor.setFromColor(this.backgroundColor),this.tempColor.a=1-(n-1)*(n-1),r.begin(),r.quad(!0,0,0,a.width,0,a.width,a.height,0,a.height,this.tempColor,this.tempColor,this.tempColor,this.tempColor),r.end()}if(this.tempColor.set(1,1,1,this.tempColor.a),i.loaded==2){this.logo===null&&(this.logo=new e.GLTexture(r.context,i.logoImg),this.spinner=new e.GLTexture(r.context,i.spinnerImg)),this.logo.update(!1),this.spinner.update(!1);var s=this.logo.getImage().width,o=this.logo.getImage().height,u=this.spinner.getImage().width,p=this.spinner.getImage().height;r.batcher.setBlendMode(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA),r.begin(),r.drawTexture(this.logo,(a.width-s)/2,(a.height-o)/2,s,o,this.tempColor),r.drawTextureRotated(this.spinner,(a.width-u)/2,(a.height-p)/2,u,p,u/2,p/2,this.angle,this.tempColor),r.end(),r.camera.position.set(c,h,0)}}},i.FADE_SECONDS=1,i.loaded=0,i.spinnerImg=null,i.logoImg=null,i.SPINNER_DATA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAChCAMAAAB3TUS6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAYNQTFRFAAAA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AA/0AAkTDRyAAAAIB0Uk5TAAABAgMEBQYHCAkKCwwODxAREhMUFRYXGBkaHB0eICEiIyQlJicoKSorLC0uLzAxMjM0Nzg5Ojs8PT4/QEFDRUlKS0xNTk9QUlRWWFlbXF1eYWJjZmhscHF0d3h5e3x+f4CIiYuMj5GSlJWXm56io6arr7rAxcjO0dXe6Onr8fmb5sOOAAADuElEQVQYGe3B+3vTVBwH4M/3nCRt13br2Lozhug2q25gYQubcxqVKYoMCYoKjEsUdSpeiBc0Kl7yp9t2za39pely7PF5zvuiQKc+/e2f8K+f9g2oyQ77Ag4VGX+HketQ0XYYe0JQ0CdhogwF+WFiBgr6JkxUoKCDMMGgoP0w9gdUtB3GfoCKVsPYAVQ0H8YuQUWVMHYGKuJhrAklPQkjJpT0bdj3O9S0FfZ9ADXxP8MjVSiqFfa8B2VVV8+df14QtB4iwn+BpuZEgyM38WMQHDYhnbkgukrIh5ygZ48glyn6KshlL+jbhVRcxCzk0ApiC5CI5kVsgTAy9jiI/WxBGmqIFBMjqwYphwRZaiLNwsjqQdoVSFISGRwjM4OMFUjBRcYCYWT0XZD2SwUS0LzIKCGH2SDja0LxKiJjCrm0gowVFI6aIs1CTouPg5QvUTgSKXMMuVUeBSmEopFITBPGwO8HCYbCTYtImTAWejuI3CMUjmZFT5NjbM/9GvQcMkhADdFRIxxD7aug4wGDFGSVTcLx0MzutQ2CpmmapmmapmmapmmapmmaphWBmGFV6rNNcaLC0GUuv3LROftUo8wJk0a10207sVED6IIf+9673LIwQeW2PaCEJX/A+xYmhTbtQUu46g96SJgQZg9Zwxf+EAMTwuwhm3jkD7EwIdweBn+YhQlh9pA2HvpDTEwIs4es4GN/CMekNOxBJ9D2B10nTAyfW7fT1hjYgZ/xYIUwUcycaiwuv2h3tOcZADr7ud/12c0ru2cWSwQ1UAcixIgImqZpmqZpmqZpmqZpmqZp2v8HMSIcF186t8oghbnlOJt1wnHwl7yOGxwSlHacrjWG8dVuej03OApn7jhHtiyMiZa9yD6haLYTebWOsbDXvQRHwchJWSTkV/rQS+EoWttJaTHkJe56KXcJRZt20jY48nnBy9hE4WjLSbvAkIfwMm5zFG/KyWgRRke3vYwGZDjpZHCMruJltCAFrTtpVYxu1ktzCHKwbSdlGqOreynXGGQpOylljI5uebFbBuSZc2IbhBxmvcj9GiSiZ52+HQO5nPb6TkIqajs9L5eQk7jnddxZgGT0jNOxYSI36+Kdj9oG5OPV6QpB6yJuGAYnqIrecLveYlDUKffIOtREl90+BiWV3cgMlNR0I09DSS030oaSttzILpT0phu5BBWRmyAoiLkJgoIMN8GgoJKb4FBQzU0YUFDdTRhQUNVNcCjIdBMEBdE7buQ8lFRz+97lUFN5fe+qu//aMkeB/gU2ae9y2HgbngAAAABJRU5ErkJggg==",i.SPINE_LOGO_DATA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFIAAAAZCAYAAACis3k0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAtNJREFUaN7tmT2I1EAUxwN+oWgRT0HFKo0WCkJ6ObmAWFwZbCxsXGysLNJaiCyIoDaSwk4ETzvhmnBaCRbBWoQ01ho4PwotjP8cE337mMy8TLK757mBH3fLTWbe/PbN53neNniqZW8FvAVvQAqugwvgDDgO9niLRyTyJagM/ACPF6bsIl9ZRDac/Cc6tLn5xQdRQ496QlKPLxD5QCDxO9jtGM8QfYoIgUlgCipGCRJL5VvlyOdCU09iEXkCfLSIfCrs7Fab6nOsiafu06iDwES9w/uU1QnDC+ekkVS9vEaDsgVeB0d+z1VDtOGxRaYPboP3Gokb4GgXkZp4chZPJKgvZ3U0XkriK/TIt9YUDllFgTAjGwoaoHqfBhMI58yD4BQ4V6/aHYdfxToftvw9F2SiVroawU2/Cv5C4Thv0KB9S5nxlOd4STxjwUjzSdYlgrYijw2BsEfgsaFcM09lhiys94xXQQwugcvgJrgFLjrEE7WUiTuWCQzt/ZXN7FfqGwuGClyVy2xZAFmfDQvNtwFFSspMDGsD+UTWqu1KoVmVooFEJgKRXw0if85RpISEzwsjzeqWzkjkC4PIJ3MUmQgITAHlQwTFhnZhELkEntfZRwR+AvfAgXmJHOqU02XligWT8ppg67NXbdCXeq7afUQ6L8C2DalEZNt2YyQ94Qy8/ekjMpBMbfyl5iTjG7YAI8cNecROAb4kJmTjaXAF3AGvwQewOiuRxEtlSaT4j2h2lMsUueQEoMlIKpTvAmKhxPMtC876jEX6rE8l8TNx/KVbn6xlWU9NWcSDUsO4NGWpQOTZFpHPOooMXcswmW2XFk3ixb2v0Nq+XVKP00QNaffBLyWwBI/AkTlfMYZDXMf12kc6yjwEjoFdO/5me5oi/6tnyhlZX6OtgmX1c2Uh0k3khmbB2b9TRfpd/jfTUeRDJvHdYg5wE7kPXAN3wQ1weDvH+xufEgpi5qIl3QAAAABJRU5ErkJggg==",i}();e.LoadingScreen=M})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){e.M00=0,e.M01=4,e.M02=8,e.M03=12,e.M10=1,e.M11=5,e.M12=9,e.M13=13,e.M20=2,e.M21=6,e.M22=10,e.M23=14,e.M30=3,e.M31=7,e.M32=11,e.M33=15;var M=function(){function i(){this.temp=new Float32Array(16),this.values=new Float32Array(16);var t=this.values;t[e.M00]=1,t[e.M11]=1,t[e.M22]=1,t[e.M33]=1}return i.prototype.set=function(t){return this.values.set(t),this},i.prototype.transpose=function(){var t=this.temp,n=this.values;return t[e.M00]=n[e.M00],t[e.M01]=n[e.M10],t[e.M02]=n[e.M20],t[e.M03]=n[e.M30],t[e.M10]=n[e.M01],t[e.M11]=n[e.M11],t[e.M12]=n[e.M21],t[e.M13]=n[e.M31],t[e.M20]=n[e.M02],t[e.M21]=n[e.M12],t[e.M22]=n[e.M22],t[e.M23]=n[e.M32],t[e.M30]=n[e.M03],t[e.M31]=n[e.M13],t[e.M32]=n[e.M23],t[e.M33]=n[e.M33],this.set(t)},i.prototype.identity=function(){var t=this.values;return t[e.M00]=1,t[e.M01]=0,t[e.M02]=0,t[e.M03]=0,t[e.M10]=0,t[e.M11]=1,t[e.M12]=0,t[e.M13]=0,t[e.M20]=0,t[e.M21]=0,t[e.M22]=1,t[e.M23]=0,t[e.M30]=0,t[e.M31]=0,t[e.M32]=0,t[e.M33]=1,this},i.prototype.invert=function(){var t=this.values,n=this.temp,r=t[e.M30]*t[e.M21]*t[e.M12]*t[e.M03]-t[e.M20]*t[e.M31]*t[e.M12]*t[e.M03]-t[e.M30]*t[e.M11]*t[e.M22]*t[e.M03]+t[e.M10]*t[e.M31]*t[e.M22]*t[e.M03]+t[e.M20]*t[e.M11]*t[e.M32]*t[e.M03]-t[e.M10]*t[e.M21]*t[e.M32]*t[e.M03]-t[e.M30]*t[e.M21]*t[e.M02]*t[e.M13]+t[e.M20]*t[e.M31]*t[e.M02]*t[e.M13]+t[e.M30]*t[e.M01]*t[e.M22]*t[e.M13]-t[e.M00]*t[e.M31]*t[e.M22]*t[e.M13]-t[e.M20]*t[e.M01]*t[e.M32]*t[e.M13]+t[e.M00]*t[e.M21]*t[e.M32]*t[e.M13]+t[e.M30]*t[e.M11]*t[e.M02]*t[e.M23]-t[e.M10]*t[e.M31]*t[e.M02]*t[e.M23]-t[e.M30]*t[e.M01]*t[e.M12]*t[e.M23]+t[e.M00]*t[e.M31]*t[e.M12]*t[e.M23]+t[e.M10]*t[e.M01]*t[e.M32]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M32]*t[e.M23]-t[e.M20]*t[e.M11]*t[e.M02]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M02]*t[e.M33]+t[e.M20]*t[e.M01]*t[e.M12]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M12]*t[e.M33]-t[e.M10]*t[e.M01]*t[e.M22]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M22]*t[e.M33];if(r==0)throw new Error("non-invertible matrix");var a=1/r;return n[e.M00]=t[e.M12]*t[e.M23]*t[e.M31]-t[e.M13]*t[e.M22]*t[e.M31]+t[e.M13]*t[e.M21]*t[e.M32]-t[e.M11]*t[e.M23]*t[e.M32]-t[e.M12]*t[e.M21]*t[e.M33]+t[e.M11]*t[e.M22]*t[e.M33],n[e.M01]=t[e.M03]*t[e.M22]*t[e.M31]-t[e.M02]*t[e.M23]*t[e.M31]-t[e.M03]*t[e.M21]*t[e.M32]+t[e.M01]*t[e.M23]*t[e.M32]+t[e.M02]*t[e.M21]*t[e.M33]-t[e.M01]*t[e.M22]*t[e.M33],n[e.M02]=t[e.M02]*t[e.M13]*t[e.M31]-t[e.M03]*t[e.M12]*t[e.M31]+t[e.M03]*t[e.M11]*t[e.M32]-t[e.M01]*t[e.M13]*t[e.M32]-t[e.M02]*t[e.M11]*t[e.M33]+t[e.M01]*t[e.M12]*t[e.M33],n[e.M03]=t[e.M03]*t[e.M12]*t[e.M21]-t[e.M02]*t[e.M13]*t[e.M21]-t[e.M03]*t[e.M11]*t[e.M22]+t[e.M01]*t[e.M13]*t[e.M22]+t[e.M02]*t[e.M11]*t[e.M23]-t[e.M01]*t[e.M12]*t[e.M23],n[e.M10]=t[e.M13]*t[e.M22]*t[e.M30]-t[e.M12]*t[e.M23]*t[e.M30]-t[e.M13]*t[e.M20]*t[e.M32]+t[e.M10]*t[e.M23]*t[e.M32]+t[e.M12]*t[e.M20]*t[e.M33]-t[e.M10]*t[e.M22]*t[e.M33],n[e.M11]=t[e.M02]*t[e.M23]*t[e.M30]-t[e.M03]*t[e.M22]*t[e.M30]+t[e.M03]*t[e.M20]*t[e.M32]-t[e.M00]*t[e.M23]*t[e.M32]-t[e.M02]*t[e.M20]*t[e.M33]+t[e.M00]*t[e.M22]*t[e.M33],n[e.M12]=t[e.M03]*t[e.M12]*t[e.M30]-t[e.M02]*t[e.M13]*t[e.M30]-t[e.M03]*t[e.M10]*t[e.M32]+t[e.M00]*t[e.M13]*t[e.M32]+t[e.M02]*t[e.M10]*t[e.M33]-t[e.M00]*t[e.M12]*t[e.M33],n[e.M13]=t[e.M02]*t[e.M13]*t[e.M20]-t[e.M03]*t[e.M12]*t[e.M20]+t[e.M03]*t[e.M10]*t[e.M22]-t[e.M00]*t[e.M13]*t[e.M22]-t[e.M02]*t[e.M10]*t[e.M23]+t[e.M00]*t[e.M12]*t[e.M23],n[e.M20]=t[e.M11]*t[e.M23]*t[e.M30]-t[e.M13]*t[e.M21]*t[e.M30]+t[e.M13]*t[e.M20]*t[e.M31]-t[e.M10]*t[e.M23]*t[e.M31]-t[e.M11]*t[e.M20]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M33],n[e.M21]=t[e.M03]*t[e.M21]*t[e.M30]-t[e.M01]*t[e.M23]*t[e.M30]-t[e.M03]*t[e.M20]*t[e.M31]+t[e.M00]*t[e.M23]*t[e.M31]+t[e.M01]*t[e.M20]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M33],n[e.M22]=t[e.M01]*t[e.M13]*t[e.M30]-t[e.M03]*t[e.M11]*t[e.M30]+t[e.M03]*t[e.M10]*t[e.M31]-t[e.M00]*t[e.M13]*t[e.M31]-t[e.M01]*t[e.M10]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M33],n[e.M23]=t[e.M03]*t[e.M11]*t[e.M20]-t[e.M01]*t[e.M13]*t[e.M20]-t[e.M03]*t[e.M10]*t[e.M21]+t[e.M00]*t[e.M13]*t[e.M21]+t[e.M01]*t[e.M10]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M23],n[e.M30]=t[e.M12]*t[e.M21]*t[e.M30]-t[e.M11]*t[e.M22]*t[e.M30]-t[e.M12]*t[e.M20]*t[e.M31]+t[e.M10]*t[e.M22]*t[e.M31]+t[e.M11]*t[e.M20]*t[e.M32]-t[e.M10]*t[e.M21]*t[e.M32],n[e.M31]=t[e.M01]*t[e.M22]*t[e.M30]-t[e.M02]*t[e.M21]*t[e.M30]+t[e.M02]*t[e.M20]*t[e.M31]-t[e.M00]*t[e.M22]*t[e.M31]-t[e.M01]*t[e.M20]*t[e.M32]+t[e.M00]*t[e.M21]*t[e.M32],n[e.M32]=t[e.M02]*t[e.M11]*t[e.M30]-t[e.M01]*t[e.M12]*t[e.M30]-t[e.M02]*t[e.M10]*t[e.M31]+t[e.M00]*t[e.M12]*t[e.M31]+t[e.M01]*t[e.M10]*t[e.M32]-t[e.M00]*t[e.M11]*t[e.M32],n[e.M33]=t[e.M01]*t[e.M12]*t[e.M20]-t[e.M02]*t[e.M11]*t[e.M20]+t[e.M02]*t[e.M10]*t[e.M21]-t[e.M00]*t[e.M12]*t[e.M21]-t[e.M01]*t[e.M10]*t[e.M22]+t[e.M00]*t[e.M11]*t[e.M22],t[e.M00]=n[e.M00]*a,t[e.M01]=n[e.M01]*a,t[e.M02]=n[e.M02]*a,t[e.M03]=n[e.M03]*a,t[e.M10]=n[e.M10]*a,t[e.M11]=n[e.M11]*a,t[e.M12]=n[e.M12]*a,t[e.M13]=n[e.M13]*a,t[e.M20]=n[e.M20]*a,t[e.M21]=n[e.M21]*a,t[e.M22]=n[e.M22]*a,t[e.M23]=n[e.M23]*a,t[e.M30]=n[e.M30]*a,t[e.M31]=n[e.M31]*a,t[e.M32]=n[e.M32]*a,t[e.M33]=n[e.M33]*a,this},i.prototype.determinant=function(){var t=this.values;return t[e.M30]*t[e.M21]*t[e.M12]*t[e.M03]-t[e.M20]*t[e.M31]*t[e.M12]*t[e.M03]-t[e.M30]*t[e.M11]*t[e.M22]*t[e.M03]+t[e.M10]*t[e.M31]*t[e.M22]*t[e.M03]+t[e.M20]*t[e.M11]*t[e.M32]*t[e.M03]-t[e.M10]*t[e.M21]*t[e.M32]*t[e.M03]-t[e.M30]*t[e.M21]*t[e.M02]*t[e.M13]+t[e.M20]*t[e.M31]*t[e.M02]*t[e.M13]+t[e.M30]*t[e.M01]*t[e.M22]*t[e.M13]-t[e.M00]*t[e.M31]*t[e.M22]*t[e.M13]-t[e.M20]*t[e.M01]*t[e.M32]*t[e.M13]+t[e.M00]*t[e.M21]*t[e.M32]*t[e.M13]+t[e.M30]*t[e.M11]*t[e.M02]*t[e.M23]-t[e.M10]*t[e.M31]*t[e.M02]*t[e.M23]-t[e.M30]*t[e.M01]*t[e.M12]*t[e.M23]+t[e.M00]*t[e.M31]*t[e.M12]*t[e.M23]+t[e.M10]*t[e.M01]*t[e.M32]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M32]*t[e.M23]-t[e.M20]*t[e.M11]*t[e.M02]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M02]*t[e.M33]+t[e.M20]*t[e.M01]*t[e.M12]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M12]*t[e.M33]-t[e.M10]*t[e.M01]*t[e.M22]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M22]*t[e.M33]},i.prototype.translate=function(t,n,r){var a=this.values;return a[e.M03]+=t,a[e.M13]+=n,a[e.M23]+=r,this},i.prototype.copy=function(){return new i().set(this.values)},i.prototype.projection=function(t,n,r,a){this.identity();var f=1/Math.tan(r*(Math.PI/180)/2),c=(n+t)/(t-n),h=2*n*t/(t-n),s=this.values;return s[e.M00]=f/a,s[e.M10]=0,s[e.M20]=0,s[e.M30]=0,s[e.M01]=0,s[e.M11]=f,s[e.M21]=0,s[e.M31]=0,s[e.M02]=0,s[e.M12]=0,s[e.M22]=c,s[e.M32]=-1,s[e.M03]=0,s[e.M13]=0,s[e.M23]=h,s[e.M33]=0,this},i.prototype.ortho2d=function(t,n,r,a){return this.ortho(t,t+r,n,n+a,0,1)},i.prototype.ortho=function(t,n,r,a,f,c){this.identity();var h=2/(n-t),s=2/(a-r),o=-2/(c-f),u=-(n+t)/(n-t),p=-(a+r)/(a-r),v=-(c+f)/(c-f),y=this.values;return y[e.M00]=h,y[e.M10]=0,y[e.M20]=0,y[e.M30]=0,y[e.M01]=0,y[e.M11]=s,y[e.M21]=0,y[e.M31]=0,y[e.M02]=0,y[e.M12]=0,y[e.M22]=o,y[e.M32]=0,y[e.M03]=u,y[e.M13]=p,y[e.M23]=v,y[e.M33]=1,this},i.prototype.multiply=function(t){var n=this.temp,r=this.values,a=t.values;return n[e.M00]=r[e.M00]*a[e.M00]+r[e.M01]*a[e.M10]+r[e.M02]*a[e.M20]+r[e.M03]*a[e.M30],n[e.M01]=r[e.M00]*a[e.M01]+r[e.M01]*a[e.M11]+r[e.M02]*a[e.M21]+r[e.M03]*a[e.M31],n[e.M02]=r[e.M00]*a[e.M02]+r[e.M01]*a[e.M12]+r[e.M02]*a[e.M22]+r[e.M03]*a[e.M32],n[e.M03]=r[e.M00]*a[e.M03]+r[e.M01]*a[e.M13]+r[e.M02]*a[e.M23]+r[e.M03]*a[e.M33],n[e.M10]=r[e.M10]*a[e.M00]+r[e.M11]*a[e.M10]+r[e.M12]*a[e.M20]+r[e.M13]*a[e.M30],n[e.M11]=r[e.M10]*a[e.M01]+r[e.M11]*a[e.M11]+r[e.M12]*a[e.M21]+r[e.M13]*a[e.M31],n[e.M12]=r[e.M10]*a[e.M02]+r[e.M11]*a[e.M12]+r[e.M12]*a[e.M22]+r[e.M13]*a[e.M32],n[e.M13]=r[e.M10]*a[e.M03]+r[e.M11]*a[e.M13]+r[e.M12]*a[e.M23]+r[e.M13]*a[e.M33],n[e.M20]=r[e.M20]*a[e.M00]+r[e.M21]*a[e.M10]+r[e.M22]*a[e.M20]+r[e.M23]*a[e.M30],n[e.M21]=r[e.M20]*a[e.M01]+r[e.M21]*a[e.M11]+r[e.M22]*a[e.M21]+r[e.M23]*a[e.M31],n[e.M22]=r[e.M20]*a[e.M02]+r[e.M21]*a[e.M12]+r[e.M22]*a[e.M22]+r[e.M23]*a[e.M32],n[e.M23]=r[e.M20]*a[e.M03]+r[e.M21]*a[e.M13]+r[e.M22]*a[e.M23]+r[e.M23]*a[e.M33],n[e.M30]=r[e.M30]*a[e.M00]+r[e.M31]*a[e.M10]+r[e.M32]*a[e.M20]+r[e.M33]*a[e.M30],n[e.M31]=r[e.M30]*a[e.M01]+r[e.M31]*a[e.M11]+r[e.M32]*a[e.M21]+r[e.M33]*a[e.M31],n[e.M32]=r[e.M30]*a[e.M02]+r[e.M31]*a[e.M12]+r[e.M32]*a[e.M22]+r[e.M33]*a[e.M32],n[e.M33]=r[e.M30]*a[e.M03]+r[e.M31]*a[e.M13]+r[e.M32]*a[e.M23]+r[e.M33]*a[e.M33],this.set(this.temp)},i.prototype.multiplyLeft=function(t){var n=this.temp,r=this.values,a=t.values;return n[e.M00]=a[e.M00]*r[e.M00]+a[e.M01]*r[e.M10]+a[e.M02]*r[e.M20]+a[e.M03]*r[e.M30],n[e.M01]=a[e.M00]*r[e.M01]+a[e.M01]*r[e.M11]+a[e.M02]*r[e.M21]+a[e.M03]*r[e.M31],n[e.M02]=a[e.M00]*r[e.M02]+a[e.M01]*r[e.M12]+a[e.M02]*r[e.M22]+a[e.M03]*r[e.M32],n[e.M03]=a[e.M00]*r[e.M03]+a[e.M01]*r[e.M13]+a[e.M02]*r[e.M23]+a[e.M03]*r[e.M33],n[e.M10]=a[e.M10]*r[e.M00]+a[e.M11]*r[e.M10]+a[e.M12]*r[e.M20]+a[e.M13]*r[e.M30],n[e.M11]=a[e.M10]*r[e.M01]+a[e.M11]*r[e.M11]+a[e.M12]*r[e.M21]+a[e.M13]*r[e.M31],n[e.M12]=a[e.M10]*r[e.M02]+a[e.M11]*r[e.M12]+a[e.M12]*r[e.M22]+a[e.M13]*r[e.M32],n[e.M13]=a[e.M10]*r[e.M03]+a[e.M11]*r[e.M13]+a[e.M12]*r[e.M23]+a[e.M13]*r[e.M33],n[e.M20]=a[e.M20]*r[e.M00]+a[e.M21]*r[e.M10]+a[e.M22]*r[e.M20]+a[e.M23]*r[e.M30],n[e.M21]=a[e.M20]*r[e.M01]+a[e.M21]*r[e.M11]+a[e.M22]*r[e.M21]+a[e.M23]*r[e.M31],n[e.M22]=a[e.M20]*r[e.M02]+a[e.M21]*r[e.M12]+a[e.M22]*r[e.M22]+a[e.M23]*r[e.M32],n[e.M23]=a[e.M20]*r[e.M03]+a[e.M21]*r[e.M13]+a[e.M22]*r[e.M23]+a[e.M23]*r[e.M33],n[e.M30]=a[e.M30]*r[e.M00]+a[e.M31]*r[e.M10]+a[e.M32]*r[e.M20]+a[e.M33]*r[e.M30],n[e.M31]=a[e.M30]*r[e.M01]+a[e.M31]*r[e.M11]+a[e.M32]*r[e.M21]+a[e.M33]*r[e.M31],n[e.M32]=a[e.M30]*r[e.M02]+a[e.M31]*r[e.M12]+a[e.M32]*r[e.M22]+a[e.M33]*r[e.M32],n[e.M33]=a[e.M30]*r[e.M03]+a[e.M31]*r[e.M13]+a[e.M32]*r[e.M23]+a[e.M33]*r[e.M33],this.set(this.temp)},i.prototype.lookAt=function(t,n,r){i.initTemps();var a=i.xAxis,f=i.yAxis,c=i.zAxis;c.setFrom(n).normalize(),a.setFrom(n).normalize(),a.cross(r).normalize(),f.setFrom(a).cross(c).normalize(),this.identity();var h=this.values;return h[e.M00]=a.x,h[e.M01]=a.y,h[e.M02]=a.z,h[e.M10]=f.x,h[e.M11]=f.y,h[e.M12]=f.z,h[e.M20]=-c.x,h[e.M21]=-c.y,h[e.M22]=-c.z,i.tmpMatrix.identity(),i.tmpMatrix.values[e.M03]=-t.x,i.tmpMatrix.values[e.M13]=-t.y,i.tmpMatrix.values[e.M23]=-t.z,this.multiply(i.tmpMatrix),this},i.initTemps=function(){i.xAxis===null&&(i.xAxis=new e.Vector3),i.yAxis===null&&(i.yAxis=new e.Vector3),i.zAxis===null&&(i.zAxis=new e.Vector3)},i.xAxis=null,i.yAxis=null,i.zAxis=null,i.tmpMatrix=new i,i}();e.Matrix4=M})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function h(s,o,u,p){this.attributes=o,this.verticesLength=0,this.dirtyVertices=!1,this.indicesLength=0,this.dirtyIndices=!1,this.elementsPerVertex=0,this.context=s instanceof e.ManagedWebGLRenderingContext?s:new e.ManagedWebGLRenderingContext(s),this.elementsPerVertex=0;for(var v=0;v<o.length;v++)this.elementsPerVertex+=o[v].numElements;this.vertices=new Float32Array(u*this.elementsPerVertex),this.indices=new Uint16Array(p),this.context.addRestorable(this)}return h.prototype.getAttributes=function(){return this.attributes},h.prototype.maxVertices=function(){return this.vertices.length/this.elementsPerVertex},h.prototype.numVertices=function(){return this.verticesLength/this.elementsPerVertex},h.prototype.setVerticesLength=function(s){this.dirtyVertices=!0,this.verticesLength=s},h.prototype.getVertices=function(){return this.vertices},h.prototype.maxIndices=function(){return this.indices.length},h.prototype.numIndices=function(){return this.indicesLength},h.prototype.setIndicesLength=function(s){this.dirtyIndices=!0,this.indicesLength=s},h.prototype.getIndices=function(){return this.indices},h.prototype.getVertexSizeInFloats=function(){for(var s=0,o=0;o<this.attributes.length;o++){var u=this.attributes[o];s+=u.numElements}return s},h.prototype.setVertices=function(s){if(this.dirtyVertices=!0,s.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(s,0),this.verticesLength=s.length},h.prototype.setIndices=function(s){if(this.dirtyIndices=!0,s.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(s,0),this.indicesLength=s.length},h.prototype.draw=function(s,o){this.drawWithOffset(s,o,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)},h.prototype.drawWithOffset=function(s,o,u,p){var v=this.context.gl;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(s),this.indicesLength>0?v.drawElements(o,p,v.UNSIGNED_SHORT,u*2):v.drawArrays(o,u,p),this.unbind(s)},h.prototype.bind=function(s){var o=this.context.gl;o.bindBuffer(o.ARRAY_BUFFER,this.verticesBuffer);for(var u=0,p=0;p<this.attributes.length;p++){var v=this.attributes[p],y=s.getAttributeLocation(v.name);o.enableVertexAttribArray(y),o.vertexAttribPointer(y,v.numElements,o.FLOAT,!1,this.elementsPerVertex*4,u*4),u+=v.numElements}this.indicesLength>0&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)},h.prototype.unbind=function(s){for(var o=this.context.gl,u=0;u<this.attributes.length;u++){var p=this.attributes[u],v=s.getAttributeLocation(p.name);o.disableVertexAttribArray(v)}o.bindBuffer(o.ARRAY_BUFFER,null),this.indicesLength>0&&o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,null)},h.prototype.update=function(){var s=this.context.gl;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=s.createBuffer()),s.bindBuffer(s.ARRAY_BUFFER,this.verticesBuffer),s.bufferData(s.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),s.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=s.createBuffer()),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),s.bufferData(s.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),s.DYNAMIC_DRAW),this.dirtyIndices=!1)},h.prototype.restore=function(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()},h.prototype.dispose=function(){this.context.removeRestorable(this);var s=this.context.gl;s.deleteBuffer(this.verticesBuffer),s.deleteBuffer(this.indicesBuffer)},h}();e.Mesh=M;var i=function(){function h(s,o,u){this.name=s,this.type=o,this.numElements=u}return h}();e.VertexAttribute=i;var t=function(h){$(s,h);function s(){h.call(this,e.Shader.POSITION,c.Float,2)}return s}(i);e.Position2Attribute=t;var n=function(h){$(s,h);function s(){h.call(this,e.Shader.POSITION,c.Float,3)}return s}(i);e.Position3Attribute=n;var r=function(h){$(s,h);function s(o){o===void 0&&(o=0),h.call(this,e.Shader.TEXCOORDS+(o==0?"":o),c.Float,2)}return s}(i);e.TexCoordAttribute=r;var a=function(h){$(s,h);function s(){h.call(this,e.Shader.COLOR,c.Float,4)}return s}(i);e.ColorAttribute=a;var f=function(h){$(s,h);function s(){h.call(this,e.Shader.COLOR2,c.Float,4)}return s}(i);e.Color2Attribute=f,function(h){h[h.Float=0]="Float"}(e.VertexAttributeType||(e.VertexAttributeType={}));var c=e.VertexAttributeType})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function i(t,n,r){if(n===void 0&&(n=!0),r===void 0&&(r=10920),this.isDrawing=!1,this.shader=null,this.lastTexture=null,this.verticesLength=0,this.indicesLength=0,r>10920)throw new Error("Can't have more than 10920 triangles per batch: "+r);this.context=t instanceof e.ManagedWebGLRenderingContext?t:new e.ManagedWebGLRenderingContext(t);var a=n?[new e.Position2Attribute,new e.ColorAttribute,new e.TexCoordAttribute,new e.Color2Attribute]:[new e.Position2Attribute,new e.ColorAttribute,new e.TexCoordAttribute];this.mesh=new e.Mesh(t,a,r,r*3),this.srcBlend=this.context.gl.SRC_ALPHA,this.dstBlend=this.context.gl.ONE_MINUS_SRC_ALPHA}return i.prototype.begin=function(t){var n=this.context.gl;if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0,this.shader=t,this.lastTexture=null,this.isDrawing=!0,n.enable(n.BLEND),n.blendFunc(this.srcBlend,this.dstBlend)},i.prototype.setBlendMode=function(t,n){var r=this.context.gl;this.srcBlend=t,this.dstBlend=n,this.isDrawing&&(this.flush(),r.blendFunc(this.srcBlend,this.dstBlend))},i.prototype.draw=function(t,n,r){t!=this.lastTexture?(this.flush(),this.lastTexture=t):(this.verticesLength+n.length>this.mesh.getVertices().length||this.indicesLength+r.length>this.mesh.getIndices().length)&&this.flush();var a=this.mesh.numVertices();this.mesh.getVertices().set(n,this.verticesLength),this.verticesLength+=n.length,this.mesh.setVerticesLength(this.verticesLength);for(var f=this.mesh.getIndices(),c=this.indicesLength,h=0;h<r.length;c++,h++)f[c]=r[h]+a;this.indicesLength+=r.length,this.mesh.setIndicesLength(this.indicesLength)},i.prototype.flush=function(){var t=this.context.gl;this.verticesLength!=0&&(this.lastTexture.bind(),this.mesh.draw(this.shader,t.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++)},i.prototype.end=function(){var t=this.context.gl;if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader=null,this.lastTexture=null,this.isDrawing=!1,t.disable(t.BLEND)},i.prototype.getDrawCalls=function(){return this.drawCalls},i.prototype.dispose=function(){this.mesh.dispose()},i}();e.PolygonBatcher=M})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function t(n,r,a){a===void 0&&(a=!0),this.twoColorTint=!1,this.activeRenderer=null,this.QUAD=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],this.QUAD_TRIANGLES=[0,1,2,2,3,0],this.WHITE=new l.Color(1,1,1,1),this.canvas=n,this.context=r instanceof e.ManagedWebGLRenderingContext?r:new e.ManagedWebGLRenderingContext(r),this.twoColorTint=a,this.camera=new e.OrthoCamera(n.width,n.height),this.batcherShader=a?e.Shader.newTwoColoredTextured(this.context):e.Shader.newColoredTextured(this.context),this.batcher=new e.PolygonBatcher(this.context,a),this.shapesShader=e.Shader.newColored(this.context),this.shapes=new e.ShapeRenderer(this.context),this.skeletonRenderer=new e.SkeletonRenderer(this.context,a),this.skeletonDebugRenderer=new e.SkeletonDebugRenderer(this.context)}return t.prototype.begin=function(){this.camera.update(),this.enableRenderer(this.batcher)},t.prototype.drawSkeleton=function(n,r){r===void 0&&(r=!1),this.enableRenderer(this.batcher),this.skeletonRenderer.premultipliedAlpha=r,this.skeletonRenderer.draw(this.batcher,n)},t.prototype.drawSkeletonDebug=function(n,r,a){r===void 0&&(r=!1),a===void 0&&(a=null),this.enableRenderer(this.shapes),this.skeletonDebugRenderer.premultipliedAlpha=r,this.skeletonDebugRenderer.draw(this.shapes,n,a)},t.prototype.drawTexture=function(n,r,a,f,c,h){h===void 0&&(h=null),this.enableRenderer(this.batcher),h===null&&(h=this.WHITE);var s=this.QUAD,o=0;s[o++]=r,s[o++]=a,s[o++]=h.r,s[o++]=h.g,s[o++]=h.b,s[o++]=h.a,s[o++]=0,s[o++]=1,this.twoColorTint&&(s[o++]=0,s[o++]=0,s[o++]=0,s[o++]=0),s[o++]=r+f,s[o++]=a,s[o++]=h.r,s[o++]=h.g,s[o++]=h.b,s[o++]=h.a,s[o++]=1,s[o++]=1,this.twoColorTint&&(s[o++]=0,s[o++]=0,s[o++]=0,s[o++]=0),s[o++]=r+f,s[o++]=a+c,s[o++]=h.r,s[o++]=h.g,s[o++]=h.b,s[o++]=h.a,s[o++]=1,s[o++]=0,this.twoColorTint&&(s[o++]=0,s[o++]=0,s[o++]=0,s[o++]=0),s[o++]=r,s[o++]=a+c,s[o++]=h.r,s[o++]=h.g,s[o++]=h.b,s[o++]=h.a,s[o++]=0,s[o++]=0,this.twoColorTint&&(s[o++]=0,s[o++]=0,s[o++]=0,s[o++]=0),this.batcher.draw(n,s,this.QUAD_TRIANGLES)},t.prototype.drawTextureRotated=function(n,r,a,f,c,h,s,o,u,p){u===void 0&&(u=null),this.enableRenderer(this.batcher),u===null&&(u=this.WHITE);var v=this.QUAD,y=r+h,E=a+s,S=-h,V=-s,F=f-h,m=c-s,d=S,x=V,I=S,g=m,D=F,T=m,R=F,k=V,C=0,A=0,L=0,P=0,B=0,_=0,W=0,U=0;if(o!=0){var Y=l.MathUtils.cosDeg(o),G=l.MathUtils.sinDeg(o);C=Y*d-G*x,A=G*d+Y*x,W=Y*I-G*g,U=G*I+Y*g,B=Y*D-G*T,_=G*D+Y*T,L=B+(C-W),P=_+(A-U)}else C=d,A=x,W=I,U=g,B=D,_=T,L=R,P=k;C+=y,A+=E,L+=y,P+=E,B+=y,_+=E,W+=y,U+=E;var X=0;v[X++]=C,v[X++]=A,v[X++]=u.r,v[X++]=u.g,v[X++]=u.b,v[X++]=u.a,v[X++]=0,v[X++]=1,this.twoColorTint&&(v[X++]=0,v[X++]=0,v[X++]=0,v[X++]=0),v[X++]=L,v[X++]=P,v[X++]=u.r,v[X++]=u.g,v[X++]=u.b,v[X++]=u.a,v[X++]=1,v[X++]=1,this.twoColorTint&&(v[X++]=0,v[X++]=0,v[X++]=0,v[X++]=0),v[X++]=B,v[X++]=_,v[X++]=u.r,v[X++]=u.g,v[X++]=u.b,v[X++]=u.a,v[X++]=1,v[X++]=0,this.twoColorTint&&(v[X++]=0,v[X++]=0,v[X++]=0,v[X++]=0),v[X++]=W,v[X++]=U,v[X++]=u.r,v[X++]=u.g,v[X++]=u.b,v[X++]=u.a,v[X++]=0,v[X++]=0,this.twoColorTint&&(v[X++]=0,v[X++]=0,v[X++]=0,v[X++]=0),this.batcher.draw(n,v,this.QUAD_TRIANGLES)},t.prototype.drawRegion=function(n,r,a,f,c,h,s){h===void 0&&(h=null),this.enableRenderer(this.batcher),h===null&&(h=this.WHITE);var o=this.QUAD,u=0;o[u++]=r,o[u++]=a,o[u++]=h.r,o[u++]=h.g,o[u++]=h.b,o[u++]=h.a,o[u++]=n.u,o[u++]=n.v2,this.twoColorTint&&(o[u++]=0,o[u++]=0,o[u++]=0,o[u++]=0),o[u++]=r+f,o[u++]=a,o[u++]=h.r,o[u++]=h.g,o[u++]=h.b,o[u++]=h.a,o[u++]=n.u2,o[u++]=n.v2,this.twoColorTint&&(o[u++]=0,o[u++]=0,o[u++]=0,o[u++]=0),o[u++]=r+f,o[u++]=a+c,o[u++]=h.r,o[u++]=h.g,o[u++]=h.b,o[u++]=h.a,o[u++]=n.u2,o[u++]=n.v,this.twoColorTint&&(o[u++]=0,o[u++]=0,o[u++]=0,o[u++]=0),o[u++]=r,o[u++]=a+c,o[u++]=h.r,o[u++]=h.g,o[u++]=h.b,o[u++]=h.a,o[u++]=n.u,o[u++]=n.v,this.twoColorTint&&(o[u++]=0,o[u++]=0,o[u++]=0,o[u++]=0),this.batcher.draw(n.texture,o,this.QUAD_TRIANGLES)},t.prototype.line=function(n,r,a,f,c,h){c===void 0&&(c=null),this.enableRenderer(this.shapes),this.shapes.line(n,r,a,f,c)},t.prototype.triangle=function(n,r,a,f,c,h,s,o,u,p){o===void 0&&(o=null),u===void 0&&(u=null),p===void 0&&(p=null),this.enableRenderer(this.shapes),this.shapes.triangle(n,r,a,f,c,h,s,o,u,p)},t.prototype.quad=function(n,r,a,f,c,h,s,o,u,p,v,y,E){p===void 0&&(p=null),v===void 0&&(v=null),y===void 0&&(y=null),E===void 0&&(E=null),this.enableRenderer(this.shapes),this.shapes.quad(n,r,a,f,c,h,s,o,u,p,v,y,E)},t.prototype.rect=function(n,r,a,f,c,h){h===void 0&&(h=null),this.enableRenderer(this.shapes),this.shapes.rect(n,r,a,f,c,h)},t.prototype.rectLine=function(n,r,a,f,c,h,s){s===void 0&&(s=null),this.enableRenderer(this.shapes),this.shapes.rectLine(n,r,a,f,c,h,s)},t.prototype.polygon=function(n,r,a,f){f===void 0&&(f=null),this.enableRenderer(this.shapes),this.shapes.polygon(n,r,a,f)},t.prototype.circle=function(n,r,a,f,c,h){c===void 0&&(c=null),h===void 0&&(h=0),this.enableRenderer(this.shapes),this.shapes.circle(n,r,a,f,c,h)},t.prototype.curve=function(n,r,a,f,c,h,s,o,u,p){p===void 0&&(p=null),this.enableRenderer(this.shapes),this.shapes.curve(n,r,a,f,c,h,s,o,u,p)},t.prototype.end=function(){this.activeRenderer===this.batcher?this.batcher.end():this.activeRenderer===this.shapes&&this.shapes.end(),this.activeRenderer=null},t.prototype.resize=function(n){var r=this.canvas,a=r.clientWidth,f=r.clientHeight;if((r.width!=a||r.height!=f)&&(r.width=a,r.height=f),this.context.gl.viewport(0,0,r.width,r.height),n!==i.Stretch){if(n===i.Expand)this.camera.setViewport(a,f);else if(n===i.Fit){var c=r.width,h=r.height,s=this.camera.viewportWidth,o=this.camera.viewportHeight,u=o/s,p=h/c,v=u<p?s/c:o/h;this.camera.viewportWidth=c*v,this.camera.viewportHeight=h*v}}this.camera.update()},t.prototype.enableRenderer=function(n){this.activeRenderer!==n&&(this.end(),n instanceof e.PolygonBatcher?(this.batcherShader.bind(),this.batcherShader.setUniform4x4f(e.Shader.MVP_MATRIX,this.camera.projectionView.values),this.batcherShader.setUniformi("u_texture",0),this.batcher.begin(this.batcherShader),this.activeRenderer=this.batcher):n instanceof e.ShapeRenderer?(this.shapesShader.bind(),this.shapesShader.setUniform4x4f(e.Shader.MVP_MATRIX,this.camera.projectionView.values),this.shapes.begin(this.shapesShader),this.activeRenderer=this.shapes):this.activeRenderer=this.skeletonDebugRenderer)},t.prototype.dispose=function(){this.batcher.dispose(),this.batcherShader.dispose(),this.shapes.dispose(),this.shapesShader.dispose(),this.skeletonDebugRenderer.dispose()},t}();e.SceneRenderer=M,function(t){t[t.Stretch=0]="Stretch",t[t.Expand=1]="Expand",t[t.Fit=2]="Fit"}(e.ResizeMode||(e.ResizeMode={}));var i=e.ResizeMode})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function i(t,n,r){this.vertexShader=n,this.fragmentShader=r,this.vs=null,this.fs=null,this.program=null,this.tmp2x2=new Float32Array(2*2),this.tmp3x3=new Float32Array(3*3),this.tmp4x4=new Float32Array(4*4),this.context=t instanceof e.ManagedWebGLRenderingContext?t:new e.ManagedWebGLRenderingContext(t),this.context.addRestorable(this),this.compile()}return i.prototype.getProgram=function(){return this.program},i.prototype.getVertexShader=function(){return this.vertexShader},i.prototype.getFragmentShader=function(){return this.fragmentShader},i.prototype.compile=function(){var t=this.context.gl;try{this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),this.program=this.compileProgram(this.vs,this.fs)}catch(n){throw this.dispose(),n}},i.prototype.compileShader=function(t,n){var r=this.context.gl,a=r.createShader(t);if(r.shaderSource(a,n),r.compileShader(a),!r.getShaderParameter(a,r.COMPILE_STATUS)){var f="Couldn't compile shader: "+r.getShaderInfoLog(a);if(r.deleteShader(a),!r.isContextLost())throw new Error(f)}return a},i.prototype.compileProgram=function(t,n){var r=this.context.gl,a=r.createProgram();if(r.attachShader(a,t),r.attachShader(a,n),r.linkProgram(a),!r.getProgramParameter(a,r.LINK_STATUS)){var f="Couldn't compile shader program: "+r.getProgramInfoLog(a);if(r.deleteProgram(a),!r.isContextLost())throw new Error(f)}return a},i.prototype.restore=function(){this.compile()},i.prototype.bind=function(){this.context.gl.useProgram(this.program)},i.prototype.unbind=function(){this.context.gl.useProgram(null)},i.prototype.setUniformi=function(t,n){this.context.gl.uniform1i(this.getUniformLocation(t),n)},i.prototype.setUniformf=function(t,n){this.context.gl.uniform1f(this.getUniformLocation(t),n)},i.prototype.setUniform2f=function(t,n,r){this.context.gl.uniform2f(this.getUniformLocation(t),n,r)},i.prototype.setUniform3f=function(t,n,r,a){this.context.gl.uniform3f(this.getUniformLocation(t),n,r,a)},i.prototype.setUniform4f=function(t,n,r,a,f){this.context.gl.uniform4f(this.getUniformLocation(t),n,r,a,f)},i.prototype.setUniform2x2f=function(t,n){var r=this.context.gl;this.tmp2x2.set(n),r.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)},i.prototype.setUniform3x3f=function(t,n){var r=this.context.gl;this.tmp3x3.set(n),r.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)},i.prototype.setUniform4x4f=function(t,n){var r=this.context.gl;this.tmp4x4.set(n),r.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)},i.prototype.getUniformLocation=function(t){var n=this.context.gl,r=n.getUniformLocation(this.program,t);if(!r&&!n.isContextLost())throw new Error("Couldn't find location for uniform "+t);return r},i.prototype.getAttributeLocation=function(t){var n=this.context.gl,r=n.getAttribLocation(this.program,t);if(r==-1&&!n.isContextLost())throw new Error("Couldn't find location for attribute "+t);return r},i.prototype.dispose=function(){this.context.removeRestorable(this);var t=this.context.gl;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)},i.newColoredTextured=function(t){var n=`
				attribute vec4 `+i.POSITION+`;
				attribute vec4 `+i.COLOR+`;
				attribute vec2 `+i.TEXCOORDS+`;
				uniform mat4 `+i.MVP_MATRIX+`;
				varying vec4 v_color;
				varying vec2 v_texCoords;

				void main () {
					v_color = `+i.COLOR+`;
					v_texCoords = `+i.TEXCOORDS+`;
					gl_Position = `+i.MVP_MATRIX+" * "+i.POSITION+`;
				}
			`,r=`
				#ifdef GL_ES
					#define LOWP lowp
					precision mediump float;
				#else
					#define LOWP
				#endif
				varying LOWP vec4 v_color;
				varying vec2 v_texCoords;
				uniform sampler2D u_texture;

				void main () {
					gl_FragColor = v_color * texture2D(u_texture, v_texCoords);
				}
			`;return new i(t,n,r)},i.newTwoColoredTextured=function(t){var n=`
				attribute vec4 `+i.POSITION+`;
				attribute vec4 `+i.COLOR+`;
				attribute vec4 `+i.COLOR2+`;
				attribute vec2 `+i.TEXCOORDS+`;
				uniform mat4 `+i.MVP_MATRIX+`;
				varying vec4 v_light;
				varying vec4 v_dark;
				varying vec2 v_texCoords;

				void main () {
					v_light = `+i.COLOR+`;
					v_dark = `+i.COLOR2+`;
					v_texCoords = `+i.TEXCOORDS+`;
					gl_Position = `+i.MVP_MATRIX+" * "+i.POSITION+`;
				}
			`,r=`
				#ifdef GL_ES
					#define LOWP lowp
					precision mediump float;
				#else
					#define LOWP
				#endif
				varying LOWP vec4 v_light;
				varying LOWP vec4 v_dark;
				varying vec2 v_texCoords;
				uniform sampler2D u_texture;

				void main () {
					vec4 texColor = texture2D(u_texture, v_texCoords);
					float alpha = texColor.a * v_light.a;
					gl_FragColor.a = alpha;
					gl_FragColor.rgb = (1.0 - texColor.rgb) * v_dark.rgb * alpha + texColor.rgb * v_light.rgb;
				}
			`;return new i(t,n,r)},i.newColored=function(t){var n=`
				attribute vec4 `+i.POSITION+`;
				attribute vec4 `+i.COLOR+`;
				uniform mat4 `+i.MVP_MATRIX+`;
				varying vec4 v_color;

				void main () {
					v_color = `+i.COLOR+`;
					gl_Position = `+i.MVP_MATRIX+" * "+i.POSITION+`;
				}
			`,r=`
				#ifdef GL_ES
					#define LOWP lowp
					precision mediump float;
				#else
					#define LOWP
				#endif
				varying LOWP vec4 v_color;

				void main () {
					gl_FragColor = v_color;
				}
			`;return new i(t,n,r)},i.MVP_MATRIX="u_projTrans",i.POSITION="a_position",i.COLOR="a_color",i.COLOR2="a_color2",i.TEXCOORDS="a_texCoords",i.SAMPLER="u_texture",i}();e.Shader=M})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function t(n,r){if(r===void 0&&(r=10920),this.isDrawing=!1,this.shapeType=i.Filled,this.color=new l.Color(1,1,1,1),this.vertexIndex=0,this.tmp=new l.Vector2,r>10920)throw new Error("Can't have more than 10920 triangles per batch: "+r);this.context=n instanceof e.ManagedWebGLRenderingContext?n:new e.ManagedWebGLRenderingContext(n),this.mesh=new e.Mesh(n,[new e.Position2Attribute,new e.ColorAttribute],r,0),this.srcBlend=this.context.gl.SRC_ALPHA,this.dstBlend=this.context.gl.ONE_MINUS_SRC_ALPHA}return t.prototype.begin=function(n){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.shader=n,this.vertexIndex=0,this.isDrawing=!0;var r=this.context.gl;r.enable(r.BLEND),r.blendFunc(this.srcBlend,this.dstBlend)},t.prototype.setBlendMode=function(n,r){var a=this.context.gl;this.srcBlend=n,this.dstBlend=r,this.isDrawing&&(this.flush(),a.blendFunc(this.srcBlend,this.dstBlend))},t.prototype.setColor=function(n){this.color.setFromColor(n)},t.prototype.setColorWith=function(n,r,a,f){this.color.set(n,r,a,f)},t.prototype.point=function(n,r,a){a===void 0&&(a=null),this.check(i.Point,1),a===null&&(a=this.color),this.vertex(n,r,a)},t.prototype.line=function(n,r,a,f,c){c===void 0&&(c=null),this.check(i.Line,2),this.mesh.getVertices(),this.vertexIndex,c===null&&(c=this.color),this.vertex(n,r,c),this.vertex(a,f,c)},t.prototype.triangle=function(n,r,a,f,c,h,s,o,u,p){o===void 0&&(o=null),u===void 0&&(u=null),p===void 0&&(p=null),this.check(n?i.Filled:i.Line,3),this.mesh.getVertices(),this.vertexIndex,o===null&&(o=this.color),u===null&&(u=this.color),p===null&&(p=this.color),n?(this.vertex(r,a,o),this.vertex(f,c,u),this.vertex(h,s,p)):(this.vertex(r,a,o),this.vertex(f,c,u),this.vertex(f,c,o),this.vertex(h,s,u),this.vertex(h,s,o),this.vertex(r,a,u))},t.prototype.quad=function(n,r,a,f,c,h,s,o,u,p,v,y,E){p===void 0&&(p=null),v===void 0&&(v=null),y===void 0&&(y=null),E===void 0&&(E=null),this.check(n?i.Filled:i.Line,3),this.mesh.getVertices(),this.vertexIndex,p===null&&(p=this.color),v===null&&(v=this.color),y===null&&(y=this.color),E===null&&(E=this.color),n?(this.vertex(r,a,p),this.vertex(f,c,v),this.vertex(h,s,y),this.vertex(h,s,y),this.vertex(o,u,E),this.vertex(r,a,p)):(this.vertex(r,a,p),this.vertex(f,c,v),this.vertex(f,c,v),this.vertex(h,s,y),this.vertex(h,s,y),this.vertex(o,u,E),this.vertex(o,u,E),this.vertex(r,a,p))},t.prototype.rect=function(n,r,a,f,c,h){h===void 0&&(h=null),this.quad(n,r,a,r+f,a,r+f,a+c,r,a+c,h,h,h,h)},t.prototype.rectLine=function(n,r,a,f,c,h,s){s===void 0&&(s=null),this.check(n?i.Filled:i.Line,8),s===null&&(s=this.color);var o=this.tmp.set(c-a,r-f);o.normalize(),h*=.5;var u=o.x*h,p=o.y*h;n?(this.vertex(r+u,a+p,s),this.vertex(r-u,a-p,s),this.vertex(f+u,c+p,s),this.vertex(f-u,c-p,s),this.vertex(f+u,c+p,s),this.vertex(r-u,a-p,s)):(this.vertex(r+u,a+p,s),this.vertex(r-u,a-p,s),this.vertex(f+u,c+p,s),this.vertex(f-u,c-p,s),this.vertex(f+u,c+p,s),this.vertex(r+u,a+p,s),this.vertex(f-u,c-p,s),this.vertex(r-u,a-p,s))},t.prototype.x=function(n,r,a){this.line(n-a,r-a,n+a,r+a),this.line(n-a,r+a,n+a,r-a)},t.prototype.polygon=function(n,r,a,f){if(f===void 0&&(f=null),a<3)throw new Error("Polygon must contain at least 3 vertices");this.check(i.Line,a*2),f===null&&(f=this.color),this.mesh.getVertices(),this.vertexIndex,r<<=1,a<<=1;for(var c=n[r],h=n[r+1],s=r+a,o=r,u=r+a-2;o<u;o+=2){var p=n[o],v=n[o+1],y=0,E=0;o+2>=s?(y=c,E=h):(y=n[o+2],E=n[o+3]),this.vertex(p,v,f),this.vertex(y,E,f)}},t.prototype.circle=function(n,r,a,f,c,h){if(c===void 0&&(c=null),h===void 0&&(h=0),h===0&&(h=Math.max(1,6*l.MathUtils.cbrt(f)|0)),h<=0)throw new Error("segments must be > 0.");c===null&&(c=this.color);var s=2*l.MathUtils.PI/h,o=Math.cos(s),u=Math.sin(s),p=f,v=0;if(n){this.check(i.Filled,h*3+3),h--;for(var y=0;y<h;y++){this.vertex(r,a,c),this.vertex(r+p,a+v,c);var S=p;p=o*p-u*v,v=u*S+o*v,this.vertex(r+p,a+v,c)}this.vertex(r,a,c),this.vertex(r+p,a+v,c)}else{this.check(i.Line,h*2+2);for(var y=0;y<h;y++){this.vertex(r+p,a+v,c);var E=p;p=o*p-u*v,v=u*E+o*v,this.vertex(r+p,a+v,c)}this.vertex(r+p,a+v,c)}p=f,v=0,this.vertex(r+p,a+v,c)},t.prototype.curve=function(n,r,a,f,c,h,s,o,u,p){p===void 0&&(p=null),this.check(i.Line,u*2+2),p===null&&(p=this.color);for(var v=1/u,y=v*v,E=v*v*v,S=3*v,V=3*y,F=6*y,m=6*E,d=n-a*2+c,x=r-f*2+h,I=(a-c)*3-n+s,g=(f-h)*3-r+o,D=n,T=r,R=(a-n)*S+d*V+I*E,k=(f-r)*S+x*V+g*E,C=d*F+I*m,A=x*F+g*m,L=I*m,P=g*m;u-- >0;)this.vertex(D,T,p),D+=R,T+=k,R+=C,k+=A,C+=L,A+=P,this.vertex(D,T,p);this.vertex(D,T,p),this.vertex(s,o,p)},t.prototype.vertex=function(n,r,a){var f=this.vertexIndex,c=this.mesh.getVertices();c[f++]=n,c[f++]=r,c[f++]=a.r,c[f++]=a.g,c[f++]=a.b,c[f++]=a.a,this.vertexIndex=f},t.prototype.end=function(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush(),this.context.gl.disable(this.context.gl.BLEND),this.isDrawing=!1},t.prototype.flush=function(){this.vertexIndex!=0&&(this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0)},t.prototype.check=function(n,r){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType==n)if(this.mesh.maxVertices()-this.mesh.numVertices()<r)this.flush();else return;else this.flush(),this.shapeType=n},t.prototype.dispose=function(){this.mesh.dispose()},t}();e.ShapeRenderer=M,function(t){t[t.Point=0]="Point",t[t.Line=1]="Line",t[t.Filled=4]="Filled"}(e.ShapeType||(e.ShapeType={}));var i=e.ShapeType})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function i(t){this.boneLineColor=new l.Color(1,0,0,1),this.boneOriginColor=new l.Color(0,1,0,1),this.attachmentLineColor=new l.Color(0,0,1,.5),this.triangleLineColor=new l.Color(1,.64,0,.5),this.pathColor=new l.Color().setFromString("FF7F00"),this.clipColor=new l.Color(.8,0,0,2),this.aabbColor=new l.Color(0,1,0,.5),this.drawBones=!0,this.drawRegionAttachments=!0,this.drawBoundingBoxes=!0,this.drawMeshHull=!0,this.drawMeshTriangles=!0,this.drawPaths=!0,this.drawSkeletonXY=!1,this.drawClipping=!0,this.premultipliedAlpha=!1,this.scale=1,this.boneWidth=2,this.bounds=new l.SkeletonBounds,this.temp=new Array,this.vertices=l.Utils.newFloatArray(2*1024),this.context=t instanceof e.ManagedWebGLRenderingContext?t:new e.ManagedWebGLRenderingContext(t)}return i.prototype.draw=function(t,n,r){r===void 0&&(r=null);var a=n.x,f=n.y,c=this.context.gl,h=this.premultipliedAlpha?c.ONE:c.SRC_ALPHA;t.setBlendMode(h,c.ONE_MINUS_SRC_ALPHA);var s=n.bones;if(this.drawBones){t.setColor(this.boneLineColor);for(var o=0,u=s.length;o<u;o++){var p=s[o];if(!(r&&r.indexOf(p.data.name)>-1)&&p.parent!=null){var v=a+p.data.length*p.a+p.worldX,y=f+p.data.length*p.c+p.worldY;t.rectLine(!0,a+p.worldX,f+p.worldY,v,y,this.boneWidth*this.scale)}}this.drawSkeletonXY&&t.x(a,f,4*this.scale)}if(this.drawRegionAttachments){t.setColor(this.attachmentLineColor);for(var E=n.slots,o=0,u=E.length;o<u;o++){var S=E[o],V=S.getAttachment();if(V instanceof l.RegionAttachment){var F=V,m=this.vertices;F.computeWorldVertices(S.bone,m,0,2),t.line(m[0],m[1],m[2],m[3]),t.line(m[2],m[3],m[4],m[5]),t.line(m[4],m[5],m[6],m[7]),t.line(m[6],m[7],m[0],m[1])}}}if(this.drawMeshHull||this.drawMeshTriangles)for(var E=n.slots,o=0,u=E.length;o<u;o++){var S=E[o],V=S.getAttachment();if(V instanceof l.MeshAttachment){var d=V,m=this.vertices;d.computeWorldVertices(S,0,d.worldVerticesLength,m,0,2);var x=d.triangles,I=d.hullLength;if(this.drawMeshTriangles){t.setColor(this.triangleLineColor);for(var g=0,D=x.length;g<D;g+=3){var T=x[g]*2,R=x[g+1]*2,k=x[g+2]*2;t.triangle(!1,m[T],m[T+1],m[R],m[R+1],m[k],m[k+1])}}if(this.drawMeshHull&&I>0){t.setColor(this.attachmentLineColor),I=(I>>1)*2;for(var C=m[I-2],A=m[I-1],g=0,D=I;g<D;g+=2){var v=m[g],y=m[g+1];t.line(v,y,C,A),C=v,A=y}}}}if(this.drawBoundingBoxes){var L=this.bounds;L.update(n,!0),t.setColor(this.aabbColor),t.rect(!1,L.minX,L.minY,L.getWidth(),L.getHeight());for(var P=L.polygons,B=L.boundingBoxes,o=0,u=P.length;o<u;o++){var _=P[o];t.setColor(B[o].color),t.polygon(_,0,_.length)}}if(this.drawPaths)for(var E=n.slots,o=0,u=E.length;o<u;o++){var S=E[o],V=S.getAttachment();if(V instanceof l.PathAttachment){var W=V,D=W.worldVerticesLength,U=this.temp=l.Utils.setArraySize(this.temp,D,0);W.computeWorldVertices(S,0,D,U,0,2);var Y=this.pathColor,G=U[2],X=U[3],H=0,O=0;if(W.closed){t.setColor(Y);var q=U[0],z=U[1],J=U[D-2],Q=U[D-1];H=U[D-4],O=U[D-3],t.curve(G,X,q,z,J,Q,H,O,32),t.setColor(i.LIGHT_GRAY),t.line(G,X,q,z),t.line(H,O,J,Q)}D-=4;for(var g=4;g<D;g+=6){var q=U[g],z=U[g+1],J=U[g+2],Q=U[g+3];H=U[g+4],O=U[g+5],t.setColor(Y),t.curve(G,X,q,z,J,Q,H,O,32),t.setColor(i.LIGHT_GRAY),t.line(G,X,q,z),t.line(H,O,J,Q),G=H,X=O}}}if(this.drawBones){t.setColor(this.boneOriginColor);for(var o=0,u=s.length;o<u;o++){var p=s[o];r&&r.indexOf(p.data.name)>-1||t.circle(!0,a+p.worldX,f+p.worldY,3*this.scale,i.GREEN,8)}}if(this.drawClipping){var E=n.slots;t.setColor(this.clipColor);for(var o=0,u=E.length;o<u;o++){var S=E[o],V=S.getAttachment();if(V instanceof l.ClippingAttachment){var K=V,D=K.worldVerticesLength,U=this.temp=l.Utils.setArraySize(this.temp,D,0);K.computeWorldVertices(S,0,D,U,0,2);for(var w=0,b=U.length;w<b;w+=2){var v=U[w],y=U[w+1],H=U[(w+2)%U.length],O=U[(w+3)%U.length];t.line(v,y,H,O)}}}}},i.prototype.dispose=function(){},i.LIGHT_GRAY=new l.Color(192/255,192/255,192/255,1),i.GREEN=new l.Color(0,1,0,1),i}();e.SkeletonDebugRenderer=M})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function t(n,r,a){this.vertices=n,this.numVertices=r,this.numFloats=a}return t}(),i=function(){function t(n,r){r===void 0&&(r=!0),this.premultipliedAlpha=!1,this.tempColor=new l.Color,this.tempColor2=new l.Color,this.vertexSize=2+2+4,this.twoColorTint=!1,this.renderable=new M(null,0,0),this.clipper=new l.SkeletonClipping,this.twoColorTint=r,r&&(this.vertexSize+=4),this.vertices=l.Utils.newFloatArray(this.vertexSize*1024)}return t.prototype.draw=function(n,r){for(var a=this.clipper,f=this.premultipliedAlpha,c=this.twoColorTint,h=null,s=this.renderable,o=null,u=null,p=r.drawOrder,v=null,y=r.color,E=c?12:8,S=0,V=p.length;S<V;S++){var F=a.isClipping()?2:E,m=p[S],d=m.getAttachment(),x=null;if(d instanceof l.RegionAttachment){var I=d;s.vertices=this.vertices,s.numVertices=4,s.numFloats=F<<2,I.computeWorldVertices(m.bone,s.vertices,0,F),u=t.QUAD_TRIANGLES,o=I.uvs,x=I.region.renderObject.texture,v=I.color}else if(d instanceof l.MeshAttachment){var g=d;s.vertices=this.vertices,s.numVertices=g.worldVerticesLength>>1,s.numFloats=s.numVertices*F,s.numFloats>s.vertices.length&&(s.vertices=this.vertices=l.Utils.newFloatArray(s.numFloats)),g.computeWorldVertices(m,0,g.worldVerticesLength,s.vertices,0,F),u=g.triangles,x=g.region.renderObject.texture,o=g.uvs,v=g.color}else if(d instanceof l.ClippingAttachment){var D=d;a.clipStart(m,D);continue}else continue;if(x!=null){var T=m.color,R=this.tempColor;R.r=y.r*T.r*v.r,R.g=y.g*T.g*v.g,R.b=y.b*T.b*v.b,R.a=y.a*T.a*v.a,f&&(R.r*=R.a,R.g*=R.a,R.b*=R.a);var k=this.tempColor2;m.darkColor==null?k.set(0,0,0,1):k.setFromColor(m.darkColor);var C=m.data.blendMode;if(C!=h&&(h=C,n.setBlendMode(e.WebGLBlendModeConverter.getSourceGLBlendMode(h,f),e.WebGLBlendModeConverter.getDestGLBlendMode(h))),a.isClipping()){a.clipTriangles(s.vertices,s.numFloats,u,u.length,o,R,k,c);var A=new Float32Array(a.clippedVertices),L=a.clippedTriangles;n.draw(x,A,L)}else{var P=s.vertices;if(c)for(var B=2,_=0,U=s.numFloats;B<U;B+=E,_+=2)P[B]=R.r,P[B+1]=R.g,P[B+2]=R.b,P[B+3]=R.a,P[B+4]=o[_],P[B+5]=o[_+1],P[B+6]=k.r,P[B+7]=k.g,P[B+8]=k.b,P[B+9]=k.a;else for(var B=2,_=0,W=s.numFloats;B<W;B+=E,_+=2)P[B]=R.r,P[B+1]=R.g,P[B+2]=R.b,P[B+3]=R.a,P[B+4]=o[_],P[B+5]=o[_+1];var Y=s.vertices.subarray(0,s.numFloats);n.draw(x,Y,u)}}a.clipEndWithSlot(m)}a.clipEnd()},t.QUAD_TRIANGLES=[0,1,2,2,3,0],t}();e.SkeletonRenderer=i})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function i(t,n,r){t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),this.x=0,this.y=0,this.z=0,this.x=t,this.y=n,this.z=r}return i.prototype.setFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},i.prototype.set=function(t,n,r){return this.x=t,this.y=n,this.z=r,this},i.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},i.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},i.prototype.scale=function(t){return this.x*=t,this.y*=t,this.z*=t,this},i.prototype.normalize=function(){var t=this.length();return t==0?this:(t=1/t,this.x*=t,this.y*=t,this.z*=t,this)},i.prototype.cross=function(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},i.prototype.multiply=function(t){var n=t.values;return this.set(this.x*n[e.M00]+this.y*n[e.M01]+this.z*n[e.M02]+n[e.M03],this.x*n[e.M10]+this.y*n[e.M11]+this.z*n[e.M12]+n[e.M13],this.x*n[e.M20]+this.y*n[e.M21]+this.z*n[e.M22]+n[e.M23])},i.prototype.project=function(t){var n=t.values,r=1/(this.x*n[e.M30]+this.y*n[e.M31]+this.z*n[e.M32]+n[e.M33]);return this.set((this.x*n[e.M00]+this.y*n[e.M01]+this.z*n[e.M02]+n[e.M03])*r,(this.x*n[e.M10]+this.y*n[e.M11]+this.z*n[e.M12]+n[e.M13])*r,(this.x*n[e.M20]+this.y*n[e.M21]+this.z*n[e.M22]+n[e.M23])*r)},i.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},i.prototype.distance=function(t){var n=t.x-this.x,r=t.y-this.y,a=t.z-this.z;return Math.sqrt(n*n+r*r+a*a)},i}();e.Vector3=M})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){(function(e){var M=function(){function t(n,r){var a=this;if(r===void 0&&(r={alpha:"true"}),this.restorables=new Array,n instanceof HTMLCanvasElement){var f=n;this.gl=f.getContext("webgl",r)||f.getContext("experimental-webgl",r),this.canvas=f,f.addEventListener("webglcontextlost",function(c){c&&c.preventDefault()}),f.addEventListener("webglcontextrestored",function(c){for(var h=0,s=a.restorables.length;h<s;h++)a.restorables[h].restore()})}else this.gl=n,this.canvas=this.gl.canvas}return t.prototype.addRestorable=function(n){this.restorables.push(n)},t.prototype.removeRestorable=function(n){var r=this.restorables.indexOf(n);r>-1&&this.restorables.splice(r,1)},t}();e.ManagedWebGLRenderingContext=M;var i=function(){function t(){}return t.getDestGLBlendMode=function(n){switch(n){case l.BlendMode.Normal:return t.ONE_MINUS_SRC_ALPHA;case l.BlendMode.Additive:return t.ONE;case l.BlendMode.Multiply:return t.ONE_MINUS_SRC_ALPHA;case l.BlendMode.Screen:return t.ONE_MINUS_SRC_ALPHA;default:throw new Error("Unknown blend mode: "+n)}},t.getSourceGLBlendMode=function(n,r){switch(r===void 0&&(r=!1),n){case l.BlendMode.Normal:return r?t.ONE:t.SRC_ALPHA;case l.BlendMode.Additive:return r?t.ONE:t.SRC_ALPHA;case l.BlendMode.Multiply:return t.DST_COLOR;case l.BlendMode.Screen:return t.ONE;default:throw new Error("Unknown blend mode: "+n)}},t.ZERO=0,t.ONE=1,t.SRC_COLOR=768,t.ONE_MINUS_SRC_COLOR=769,t.SRC_ALPHA=770,t.ONE_MINUS_SRC_ALPHA=771,t.DST_ALPHA=772,t.ONE_MINUS_DST_ALPHA=773,t.DST_COLOR=774,t}();e.WebGLBlendModeConverter=i})(l.webgl||(l.webgl={}))})(N||(N={}));var N;(function(l){var e=function(){function i(t,n){var r=this;if(this.mvp=new l.webgl.Matrix4,this.paused=!1,this.lastFrameTime=Date.now()/1e3,this.backgroundColor=new l.Color,this.loaded=!1,this.bounds={offset:new l.Vector2,size:new l.Vector2},!t)throw new Error("Please provide a DOM element, e.g. document.getElementById('myelement')");if(!n)throw new Error("Please provide a configuration, specifying at least the json file, atlas file and animation name");var a=t;if(typeof t=="string"&&(t=document.getElementById(t)),t==null)throw new Error("Element "+a+" does not exist");this.validateConfig(n);var f=t.children[0],c=this.canvas=f||document.createElement("canvas");c.style.width="100%",c.style.height="100%",f||t.appendChild(c),c.width=t.clientWidth,c.height=t.clientHeight;var h={alpha:n.alpha};this.context=new l.webgl.ManagedWebGLRenderingContext(c,h),this.shader=l.webgl.Shader.newTwoColoredTextured(this.context),this.batcher=new l.webgl.PolygonBatcher(this.context),this.mvp.ortho2d(0,0,c.width-1,c.height-1),this.skeletonRenderer=new l.webgl.SkeletonRenderer(this.context),this.debugShader=l.webgl.Shader.newColored(this.context),this.debugRenderer=new l.webgl.SkeletonDebugRenderer(this.context),this.shapes=new l.webgl.ShapeRenderer(this.context);var s=this.assetManager=new l.webgl.AssetManager(this.context,n.imagesPath?n.imagesPath:"");if(n.atlasContent||s.loadText(n.atlas),n.jsonContent||s.loadText(n.json),n.atlasPages==null)if(n.atlas){var o=n.atlas.replace(".atlas",".png");o.lastIndexOf(n.imagesPath)==0&&(o=o.substr(n.imagesPath.length)),s.loadTexture(o)}else{var u=n.atlasContent.trim().split(`
`)[0];s.loadTexture(u)}else for(var p=0;p<n.atlasPages.length;p++)n.atlasPagesContent&&n.atlasPagesContent[p]?s.loadTextureData(n.atlasPages[p],n.atlasPagesContent[0]):s.loadTexture(n.atlasPages[p]);requestAnimationFrame(function(){r.load()})}return i.prototype.validateConfig=function(t){if(!t.atlas&&!t.atlasContent)throw new Error("Please specify config.atlas or config.atlasContent");if(!t.json&&!t.jsonContent)throw new Error("Please specify config.json or config.jsonContent");if(!t.animation)throw new Error("Please specify config.animationName");if(t.scale||(t.scale=1),t.skin||(t.skin="default"),t.loop===void 0&&(t.loop=!0),t.x||(t.x=0),t.y||(t.y=0),t.fitToCanvas===void 0&&(t.fitToCanvas=!0),t.backgroundColor||(t.backgroundColor="#555555"),!t.imagesPath)if(t.atlas){var n=t.atlas.lastIndexOf("/");n!=-1?t.imagesPath=t.atlas.substr(0,n)+"/":t.imagesPath=""}else t.imagesPath="";t.json&&t.json.lastIndexOf(t.imagesPath)==0&&(t.json=t.json.substr(t.imagesPath.length)),t.atlas&&t.atlas.lastIndexOf(t.imagesPath)==0&&(t.atlas=t.atlas.substr(t.imagesPath.length)),!t.premultipliedAlpha===void 0&&(t.premultipliedAlpha=!1),!t.debug===void 0&&(t.debug=!1),!t.alpha===void 0&&(t.alpha=!0),this.backgroundColor.setFromString(t.backgroundColor),this.config=t},i.prototype.load=function(){var t=this,n=this.assetManager;this.config.imagesPath;var r=this.config;if(n.isLoadingComplete()){if(n.hasErrors())if(r.error)r.error(this,"Failed to load assets: "+JSON.stringify(n.getErrors()));else throw new Error("Failed to load assets: "+JSON.stringify(n.getErrors()));var a=r.atlasContent===void 0?this.assetManager.get(this.config.atlas):r.atlasContent,f=new l.TextureAtlas(a,function(y){var E=n.get(y);return E}),c=new l.AtlasAttachmentLoader(f),h=new l.SkeletonJson(c);h.scale=r.scale;var s=r.jsonContent===void 0?n.get(r.json):r.jsonContent,o=h.readSkeletonData(s),u=this.skeleton=new l.Skeleton(o),p=this.bounds;u.setSkinByName(r.skin),u.setToSetupPose(),u.updateWorldTransform(),u.getBounds(p.offset,p.size,[]),r.fitToCanvas||(u.x=r.x,u.y=r.y);var v=this.state=new l.AnimationState(new l.AnimationStateData(u.data));v.setAnimation(0,r.animation,r.loop),this.loaded=!0,r.success&&r.success(this),requestAnimationFrame(function(){t.render()})}else requestAnimationFrame(function(){t.load()})},i.prototype.render=function(){var t=this,n=Date.now()/1e3,r=n-this.lastFrameTime;r>.1&&(r=0),this.lastFrameTime=n;var a=this.context.gl,f=this.backgroundColor;this.resize(),a.clearColor(f.r,f.g,f.b,f.a),a.clear(a.COLOR_BUFFER_BIT);var c=this.state,h=this.skeleton,s=this.config.premultipliedAlpha;c.update(r),c.apply(h),h.updateWorldTransform();var o=this.shader,u=this.batcher,p=this.skeletonRenderer;if(o.bind(),o.setUniformi(l.webgl.Shader.SAMPLER,0),o.setUniform4x4f(l.webgl.Shader.MVP_MATRIX,this.mvp.values),u.begin(o),p.premultipliedAlpha=s,p.draw(u,h),u.end(),o.unbind(),this.config.debug){var v=this.debugShader,y=this.shapes,E=this.debugRenderer;v.bind(),v.setUniform4x4f(l.webgl.Shader.MVP_MATRIX,this.mvp.values),E.premultipliedAlpha=s,y.begin(v),E.draw(y,h),y.end(),v.unbind()}this.paused||requestAnimationFrame(function(){t.render()})},i.prototype.resize=function(){var t=this.canvas,n=t.clientWidth,r=t.clientHeight,a=this.bounds,f=window.devicePixelRatio||1;if((t.width!=Math.floor(n*f)||t.height!=Math.floor(r*f))&&(t.width=Math.floor(n*f),t.height=Math.floor(r*f)),this.config.fitToCanvas){var c=a.offset.x+a.size.x/2,h=a.offset.y+a.size.y/2,s=a.size.x/n,o=a.size.y/r,u=Math.max(s,o)*1.2;u<1&&(u=1);var p=n*u,v=r*u;this.skeleton.x=this.skeleton.y=0,this.mvp.ortho2d(c-p/2,h-v/2,p,v)}else this.mvp.ortho2d(0,0,n-1,r-1);this.context.gl.viewport(0,0,t.width,t.height)},i.prototype.pause=function(){this.paused=!0},i.prototype.play=function(){var t=this;this.paused=!1,requestAnimationFrame(function(){t.render()})},i.prototype.isPlaying=function(){return!this.paused},i.prototype.setAnimation=function(t,n){if(n===void 0&&(n=null),!this.loaded)throw new Error("Widget isn't loaded yet");this.skeleton.setToSetupPose();var r=this.state.setAnimation(0,t,this.config.loop);r.listener=n},i.loadWidgets=function(){for(var t=document.getElementsByClassName("spine-widget"),n=0;n<t.length;n++)i.loadWidget(t[n])},i.loadWidget=function(t){var n=new M;n.atlas=t.getAttribute("data-atlas"),n.json=t.getAttribute("data-json"),n.animation=t.getAttribute("data-animation"),t.getAttribute("data-images-path")&&(n.imagesPath=t.getAttribute("data-images-path")),t.getAttribute("data-atlas-pages")&&(n.atlasPages=t.getAttribute("data-atlas-pages").split(",")),t.getAttribute("data-skin")&&(n.skin=t.getAttribute("data-skin")),t.getAttribute("data-loop")&&(n.loop=t.getAttribute("data-loop")==="true"),t.getAttribute("data-scale")&&(n.scale=parseFloat(t.getAttribute("data-scale"))),t.getAttribute("data-x")&&(n.x=parseFloat(t.getAttribute("data-x"))),t.getAttribute("data-y")&&(n.y=parseFloat(t.getAttribute("data-y"))),t.getAttribute("data-fit-to-canvas")&&(n.fitToCanvas=t.getAttribute("data-fit-to-canvas")==="true"),t.getAttribute("data-background-color")&&(n.backgroundColor=t.getAttribute("data-background-color")),t.getAttribute("data-premultiplied-alpha")&&(n.premultipliedAlpha=t.getAttribute("data-premultiplied-alpha")==="true"),t.getAttribute("data-debug")&&(n.debug=t.getAttribute("data-debug")==="true"),t.getAttribute("data-alpha")&&(n.alpha=t.getAttribute("data-alpha")==="true"),new l.SpineWidget(t,n)},i.ready=function(){i.pageLoaded||(i.pageLoaded=!0,i.loadWidgets())},i.setupDOMListener=function(){document.addEventListener?(document.addEventListener("DOMContentLoaded",i.ready,!1),window.addEventListener("load",i.ready,!1)):(document.attachEvent("onreadystatechange",function(){document.readyState==="complete"&&i.ready()}),window.attachEvent("onload",i.ready))},i.pageLoaded=!1,i}();l.SpineWidget=e;var M=function(){function i(){this.skin="default",this.loop=!0,this.scale=1,this.x=0,this.y=0,this.alpha=!0,this.fitToCanvas=!0,this.backgroundColor="#555555",this.premultipliedAlpha=!1,this.debug=!1}return i}();l.SpineWidgetConfig=M})(N||(N={}));N.SpineWidget.setupDOMListener();var ge=N;const Ie=Z.exports.forwardRef(({json:l,ani:e,atlas:M,color:i,transparent:t,loop:n,skin:r,speed:a,isBig:f,onSuccess:c,onRecFinish:h},s)=>{const o=Z.exports.useRef(null),u=Z.exports.useRef(),p=Z.exports.useRef(1),v=Z.exports.useRef(""),y=Z.exports.useRef(!1),E=Z.exports.useRef(),S=Z.exports.useRef(),V=Z.exports.useRef(!1),F=Z.exports.useRef([]),m=Z.exports.useRef(),d=Z.exports.useRef(),x=Z.exports.useRef(""),I=Z.exports.useRef(!1),[g,D]=Z.exports.useState(1);return Z.exports.useEffect(()=>{m.current=h},[h]),Z.exports.useEffect(()=>{I.current=f},[f]),Z.exports.useImperativeHandle(s,()=>({reset:()=>{const T=u.current;T&&(T.skeleton.x=500,T.skeleton.y=200),D(1)},rec:T=>{if(V.current)return;x.current=T,V.current=!0;const R=u.current;!R||R.state.setAnimation(0,v.current,!1)}})),Z.exports.useEffect(()=>{if(!o.current)return;const T=new Nt(o.current);T.get("pinch").set({enable:!0}),T.on("panstart",()=>{u.current&&(E.current={x:u.current.skeleton.x,y:u.current.skeleton.y})}),T.on("panmove",k=>{u.current&&E.current&&(u.current.skeleton.x=E.current.x+k.deltaX/(I.current?1:.3),u.current.skeleton.y=E.current.y-k.deltaY/(I.current?1:.3))}),T.on("panend",k=>{u.current&&E.current&&(u.current.skeleton.x=E.current.x+k.deltaX/(I.current?1:.3),u.current.skeleton.y=E.current.y-k.deltaY/(I.current?1:.3),E.current=void 0)}),T.on("pinchin",()=>{!u.current||D(C=>C-.1<=0?C:C-.1)}),T.on("pinchout",()=>{!u.current||D(C=>C+.1)}),S.current=T;const R=k=>{if(k.preventDefault(),!u.current)return;const A=Re()?k.deltaY/-480:k.deltaY*-.001;D(L=>L+A<=0?L:L+A)};return o.current.addEventListener("wheel",R),()=>{var k,C;(k=S.current)==null||k.destroy(),(C=o.current)==null||C.removeEventListener("wheel",R)}},[]),Z.exports.useEffect(()=>{u.current&&l.length!==0&&(u.current=void 0)},[l,g]),Z.exports.useEffect(()=>{if(v.current=e,e.length===0)return;const T=u.current;!T||T.state.setAnimation(0,e,y.current)},[e]),Z.exports.useEffect(()=>{y.current=n;const T=u.current;!T||T.state.setAnimation(0,T.state.tracks[0].animation.name,n)},[n]),Z.exports.useEffect(()=>{p.current=a;const T=u.current;!T||(T.state.timeScale=a)},[a]),Z.exports.useEffect(()=>{l.length!==0&&(!o.current||new ge.SpineWidget(o.current,{jsonContent:l,atlas:M,animation:v.current,backgroundColor:t?"#00000000":"#"+i,debug:!1,loop:y.current,skin:r,scale:g,x:500,y:200,fitToCanvas:!1,premultipliedAlpha:!0,success:T=>{console.log(T),u.current=T,T.state.addListener({start:()=>{if(V.current){const R=T.canvas.captureStream(60),k=new MediaRecorder(R,{mimeType:"video/webm"});k.ondataavailable=C=>{F.current.push(C.data)},k.onstop=()=>{const C=new Blob(F.current,{type:"video/webm"});Se(C,x.current||"output"),F.current=[],m.current&&m.current()},k.start(),d.current=k}},complete:()=>{var R;V.current&&(V.current=!1,(R=d.current)==null||R.stop())},interrupt:()=>{},end:()=>{},dispose:()=>{},event:()=>{}}),T.state.timeScale=p.current,c(T.skeleton.data.animations.map(R=>({duration:R.duration,name:R.name})))}}))},[M,l,c,g,r,t,i]),j.createElement("div",{style:{backgroundImage:`
        linear-gradient(45deg, #ccc 25%, transparent 25%), 
        linear-gradient(135deg, #ccc 25%, transparent 25%),
        linear-gradient(45deg, transparent 75%, #ccc 75%),
        linear-gradient(135deg, transparent 75%, #ccc 75%)`,backgroundSize:"24px 24px",backgroundPosition:"0 0, 12px 0, 12px -12px, 0px 12px"}},j.createElement("div",{style:{width:1e3,height:1e3,transform:f?"":"scale(0.3,0.3)",transformOrigin:"top left"},ref:o}))});var Ft;(function(l){l[l.changeSkin=0]="changeSkin",l[l.changeModel=1]="changeModel",l[l.changeAni=2]="changeAni",l[l.update=3]="update"})(Ft||(Ft={}));const Pe=Ut({productionPrefix:"spineViewer"}),Fe=Tt({control:{width:"100%",margin:"0.3rem 0"},select:{height:"auto"},card:{display:"flex",flexWrap:"wrap",width:"fit-content"}});function Le({prefix:l,skin:e,name:M}){const i=R=>Me[R]||R;Ot(()=>({i18n:{language:"zhCN"},t:i}));const t=Fe(),n=Object.keys(e),[r,a]=Z.exports.useState([]),[f,c]=Z.exports.useState(!0),[h,s]=Z.exports.useState(!1),[o,u]=Z.exports.useState(!1),[p,v]=Z.exports.useState("ffffff"),[y,E]=Z.exports.useState(1),[S,V]=Z.exports.useState(!1),F=Z.exports.useRef(null),[m,d]=Z.exports.useReducer((R,k)=>{switch(k.action){case 0:return{json:"",skin:k.skin,modelList:Object.keys(e[k.skin]),model:Object.keys(e[k.skin])[0],animations:[],animation:""};case 1:return ft(ht({},R),{json:"",model:k.model,animations:[],animation:""});case 3:return ft(ht({},R),{animation:k.animations[0],animations:k.animations,json:k.json});case 2:return ft(ht({},R),{animation:k.ani})}return R},{skin:n[0],modelList:Object.keys(e[n[0]]),model:Object.keys(e[n[0]])[0],animations:[],animation:"",json:""}),[x,I]=Z.exports.useState(!1),g=window.MediaRecorder&&MediaRecorder.isTypeSupported("video/webm")&&!at();Z.exports.useEffect(()=>{Te(l+e[m.skin][m.model].file+".skel").then(R=>{const k=Object.keys(R.animations);d({action:3,animations:k,json:R})})},[l,e,m.model,m.skin]);const[D,T]=Z.exports.useState(!1);return j.createElement(_t,{generateClassName:Pe},j.createElement("div",{style:{width:"fit-content",position:"relative"}},j.createElement(Rt,{className:t.card},j.createElement(vt,{style:{width:330}},j.createElement(Mt,{variant:"outlined",className:t.control,size:"small"},j.createElement(mt,{id:"skin-select-label"},"\u76AE\u80A4"),j.createElement(pt,{classes:{root:t.select},labelId:"skin-select-label",native:at(),value:m.skin,onChange:R=>{d({action:0,skin:R.target.value})}},n.map(R=>at()?j.createElement("option",{value:R,key:R},R):j.createElement(At,{value:R,key:R},R)))),j.createElement(Mt,{variant:"outlined",size:"small",className:t.control},j.createElement(mt,{id:"model-select-label"},"\u6A21\u578B"),j.createElement(pt,{classes:{root:t.select},labelId:"model-select-label",value:m.model,native:at(),onChange:R=>{d({action:1,model:R.target.value})}},m.modelList.map(R=>at()?j.createElement("option",{value:R,key:R},R):j.createElement(At,{value:R,key:R},R)))),j.createElement(Mt,{variant:"outlined",size:"small",className:t.control},j.createElement(mt,{id:"ani-select-label"}),j.createElement(pt,{classes:{root:t.select},labelId:"ani-select-label",native:at(),value:m.animation,onChange:R=>{d({action:2,ani:R.target.value})}},m.animations.map(R=>at()?j.createElement("option",{value:R,key:R},R):j.createElement(At,{value:R,key:R},R)))),j.createElement(St,{container:!0,justify:"space-around"},j.createElement(xt,{control:j.createElement(Xt,{value:h,onChange:R=>{s(R.target.checked)}}),label:"\u5FAA\u73AF\u64AD\u653E",labelPlacement:"bottom"}),j.createElement(xt,{control:j.createElement(Yt,{value:o,onChange:R=>{u(R.target.checked)}}),label:"\u900F\u660E\u80CC\u666F",labelPlacement:"bottom"}),j.createElement(xt,{control:j.createElement(Wt,{hideTextfield:!0,disableAlpha:!0,deferred:!0,value:"#"+p,onChange:R=>{o||v(R.hex)}}),disabled:o,label:"\u80CC\u666F\u989C\u8272",labelPlacement:"bottom"})),j.createElement(jt,{component:"div",style:{margin:"4px 0"}},j.createElement(Gt,{textAlign:"left"},"\u64AD\u653E\u901F\u5EA6")),j.createElement(qt,{"aria-labelledby":"continuous-slider",step:.1,min:.1,max:2,defaultValue:1,value:y,valueLabelDisplay:"auto",onChange:(R,k)=>{E(k)}}),j.createElement(St,{container:!0,justify:"center"},j.createElement(ct,{title:g?"\u5B9E\u9A8C\u6027WEBM\u5BFC\u51FA":"\u5F53\u524D\u6D4F\u89C8\u5668/\u8BBE\u5907\u4E0D\u652F\u6301webm\u5BFC\u51FA \u9700\u8981edge >=79\u6216firefox >=29\u6216chrome >=49\u6216safari >=14.1\u548C\u684C\u9762CPU","aria-label":"WEBM\u5BFC\u51FA"},j.createElement(Ht,{color:"primary",badgeContent:"webm"},j.createElement(dt,{disabled:!g,onClick:()=>{var R;T(!0),(R=F.current)==null||R.rec(`${M}-${m.skin}-${m.model}-${m.animation}-x${y}`)}},j.createElement(zt,null)))),j.createElement(ct,{title:"\u91CD\u7F6E\u4F4D\u7F6E","aria-label":"\u91CD\u7F6E\u4F4D\u7F6E"},j.createElement(dt,{onClick:()=>{var R;(R=F.current)==null||R.reset()}},j.createElement(Qt,null))),at()?null:j.createElement(ct,{title:S?"\u7F29\u5C0F":"\u653E\u5927","aria-label":S?"\u7F29\u5C0F":"\u653E\u5927"},j.createElement(dt,{onClick:()=>{V(!S)}},S?j.createElement(Zt,null):j.createElement(Jt,null))),j.createElement(ct,{title:"\u52A8\u753B\u957F\u5EA6","aria-label":"\u52A8\u753B\u957F\u5EA6"},j.createElement(dt,{onClick:()=>{I(!0)}},j.createElement(Kt,null))))),j.createElement(vt,null,j.createElement("div",{style:{width:S?1e3:300,height:S?1e3:300,overflow:"hidden"}},j.createElement(gt,{open:f,style:{position:"absolute",width:300,height:300,zIndex:1,top:"inherit",left:"inherit",right:"inherit",bottom:"inherit"}},j.createElement(wt,null)),j.createElement(Ie,{atlas:l+e[m.skin][m.model].file+".atlas",skin:e[m.skin][m.model].skin||"default",json:m.json,ani:m.animation,loop:h,speed:y,isBig:S,color:p,transparent:o,onSuccess:Z.exports.useCallback(R=>{a(R),c(!1)},[]),onRecFinish:()=>{T(!1)},ref:F})))),j.createElement(gt,{open:D,style:{zIndex:2,right:"inherit",bottom:"inherit",position:"absolute",width:"100%",height:"100%"}},j.createElement(Rt,{style:{width:"50%"}},j.createElement(vt,null,j.createElement("div",{style:{marginBottom:16}},"\u6B63\u5728\u5BFC\u51FA ",M,"-",m.skin,"-",m.model,"-",m.animation,"-x",y,".webm"),j.createElement($t,{color:"secondary"})))),j.createElement(bt,{open:x,onClose:()=>{I(!1)}},j.createElement(te,null,M," - ",m.skin," - ",m.model),j.createElement(ee,null,j.createElement(re,null,j.createElement(ne,null,j.createElement(ae,null,j.createElement(It,null,j.createElement(ut,null,"\u52A8\u753B"),j.createElement(ut,null,"\u6301\u7EED\u65F6\u95F4(s)"),j.createElement(ut,null,"\u5E27\u6570(30/s)"))),j.createElement(ie,null,r.map(R=>j.createElement(It,{key:R.name},j.createElement(ut,null,R.name),j.createElement(ut,null,R.duration),j.createElement(ut,null,Math.round(R.duration*30)))))))))))}const Ve=Tt({baseline:{width:"fit-content"}});function ke(l){const e=se({overrides:{MuiPopover:{root:{boxSizing:"border-box","& *":{boxSizing:"border-box"}}}}}),M=Ve(),[i,t]=Z.exports.useState(!1);return j.createElement(oe,{className:M.baseline},j.createElement(he,{theme:e},i?j.createElement(Le,ht({},l)):j.createElement(ue,{variant:"contained",color:"primary",onClick:()=>{t(!0)}},"\u70B9\u51FB\u52A0\u8F7D")))}const De=JSON.parse(document.getElementById("SPINEDATA").innerHTML);le.render(j.createElement(j.StrictMode,null,j.createElement(ke,ht({},De))),document.getElementById("root"));
//# sourceMappingURL=main.b5d72690.js.map
